(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function e(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=e(r);fetch(r.href,s)}})();const Jr=!1;var yr=Array.isArray,Nl=Array.prototype.indexOf,br=Array.from,Ga=Object.defineProperty,Zn=Object.getOwnPropertyDescriptor,Fa=Object.getOwnPropertyDescriptors,Bl=Object.prototype,Hl=Array.prototype,us=Object.getPrototypeOf,Us=Object.isExtensible;const Ie=()=>{};function Yl(n){return n()}function Zr(n){for(var t=0;t<n.length;t++)n[t]()}function Na(){var n,t,e=new Promise((i,r)=>{n=i,t=r});return{promise:e,resolve:n,reject:t}}const Xt=2,ds=4,wr=8,Ba=1<<24,Qe=16,$e=32,Dn=64,Cr=128,xe=512,Bt=1024,ee=2048,Fe=4096,oe=8192,Ke=16384,gs=32768,An=65536,zs=1<<17,Ha=1<<18,ii=1<<19,Ya=1<<20,qe=1<<25,Tn=32768,Qr=1<<21,ps=1<<22,hn=1<<23,Je=Symbol("$state"),Xl=Symbol("legacy props"),Wl=Symbol(""),qn=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function Sr(n){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Vl(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Ul(n){throw new Error("https://svelte.dev/e/effect_in_teardown")}function zl(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function jl(n){throw new Error("https://svelte.dev/e/effect_orphan")}function ql(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Kl(n){throw new Error("https://svelte.dev/e/props_invalid_value")}function Jl(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Zl(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Ql(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function $l(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const tc=1,ec=2,Xa=4,nc=8,ic=16,rc=1,sc=2,ac=4,oc=8,lc=16,cc=1,hc=2,Gt=Symbol(),fc="http://www.w3.org/1999/xhtml",uc="@attach";function dc(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function gc(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function Wa(n){return n===this.v}function Va(n,t){return n!=n?t==t:n!==t||n!==null&&typeof n=="object"||typeof n=="function"}function Ua(n){return!Va(n,this.v)}let ri=!1,pc=!1;function vc(){ri=!0}let ot=null;function Qn(n){ot=n}function za(n){return ja().get(n)}function js(n,t){return ja().set(n,t),t}function ne(n,t=!1,e){ot={p:ot,i:!1,c:null,e:null,s:n,x:null,l:ri&&!t?{s:null,u:null,$:[]}:null}}function ie(n){var t=ot,e=t.e;if(e!==null){t.e=null;for(var i of e)fo(i)}return n!==void 0&&(t.x=n),t.i=!0,ot=t.p,n??{}}function Ni(){return!ri||ot!==null&&ot.l===null}function ja(n){return ot===null&&Sr(),ot.c??=new Map(_c(ot)||void 0)}function _c(n){let t=n.p;for(;t!==null;){const e=t.c;if(e!==null)return e;t=t.p}return null}let Cn=[];function qa(){var n=Cn;Cn=[],Zr(n)}function On(n){if(Cn.length===0&&!Ai){var t=Cn;queueMicrotask(()=>{t===Cn&&qa()})}Cn.push(n)}function mc(){for(;Cn.length>0;)qa()}function Ka(n){var t=nt;if(t===null)return Q.f|=hn,n;if((t.f&gs)===0){if((t.f&Cr)===0)throw n;t.b.error(n)}else $n(n,t)}function $n(n,t){for(;t!==null;){if((t.f&Cr)!==0)try{t.b.error(n);return}catch(e){n=e}t=t.parent}throw n}const Ki=new Set;let rt=null,cr=null,me=null,pe=[],xr=null,$r=!1,Ai=!1;class Le{committed=!1;current=new Map;previous=new Map;#t=new Set;#e=new Set;#i=0;#n=0;#l=null;#r=[];#s=[];skipped_effects=new Set;is_fork=!1;is_deferred(){return this.is_fork||this.#n>0}process(t){pe=[],cr=null,this.apply();var e={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const i of t)this.#a(i,e);this.is_fork||this.#h(),this.is_deferred()?(this.#o(e.effects),this.#o(e.render_effects),this.#o(e.block_effects)):(cr=this,rt=null,qs(e.render_effects),qs(e.effects),cr=null,this.#l?.resolve()),me=null}#a(t,e){t.f^=Bt;for(var i=t.first;i!==null;){var r=i.f,s=(r&($e|Dn))!==0,a=s&&(r&Bt)!==0,o=a||(r&oe)!==0||this.skipped_effects.has(i);if((i.f&Cr)!==0&&i.b?.is_pending()&&(e={parent:e,effect:i,effects:[],render_effects:[],block_effects:[]}),!o&&i.fn!==null){s?i.f^=Bt:(r&ds)!==0?e.effects.push(i):si(i)&&((i.f&Qe)!==0&&e.block_effects.push(i),ei(i));var l=i.first;if(l!==null){i=l;continue}}var c=i.parent;for(i=i.next;i===null&&c!==null;)c===e.effect&&(this.#o(e.effects),this.#o(e.render_effects),this.#o(e.block_effects),e=e.parent),i=c.next,c=c.parent}}#o(t){for(const e of t)((e.f&ee)!==0?this.#r:this.#s).push(e),this.#c(e.deps),Yt(e,Bt)}#c(t){if(t!==null)for(const e of t)(e.f&Xt)===0||(e.f&Tn)===0||(e.f^=Tn,this.#c(e.deps))}capture(t,e){this.previous.has(t)||this.previous.set(t,e),(t.f&hn)===0&&(this.current.set(t,t.v),me?.set(t,t.v))}activate(){rt=this,this.apply()}deactivate(){rt===this&&(rt=null,me=null)}flush(){if(this.activate(),pe.length>0){if(Ja(),rt!==null&&rt!==this)return}else this.#i===0&&this.process([]);this.deactivate()}discard(){for(const t of this.#e)t(this);this.#e.clear()}#h(){if(this.#n===0){for(const t of this.#t)t();this.#t.clear()}this.#i===0&&this.#f()}#f(){if(Ki.size>1){this.previous.clear();var t=me,e=!0,i={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const s of Ki){if(s===this){e=!1;continue}const a=[];for(const[l,c]of this.current){if(s.current.has(l))if(e&&c!==s.current.get(l))s.current.set(l,c);else continue;a.push(l)}if(a.length===0)continue;const o=[...s.current.keys()].filter(l=>!this.current.has(l));if(o.length>0){var r=pe;pe=[];const l=new Set,c=new Map;for(const f of a)Za(f,o,l,c);if(pe.length>0){rt=s,s.apply();for(const f of pe)s.#a(f,i);s.deactivate()}pe=r}}rt=null,me=t}this.committed=!0,Ki.delete(this)}increment(t){this.#i+=1,t&&(this.#n+=1)}decrement(t){this.#i-=1,t&&(this.#n-=1),this.revive()}revive(){for(const t of this.#r)Yt(t,ee),Rn(t);for(const t of this.#s)Yt(t,Fe),Rn(t);this.#r=[],this.#s=[],this.flush()}oncommit(t){this.#t.add(t)}ondiscard(t){this.#e.add(t)}settled(){return(this.#l??=Na()).promise}static ensure(){if(rt===null){const t=rt=new Le;Ki.add(rt),Ai||Le.enqueue(()=>{rt===t&&t.flush()})}return rt}static enqueue(t){On(t)}apply(){}}function yc(n){var t=Ai;Ai=!0;try{for(var e;;){if(mc(),pe.length===0&&(rt?.flush(),pe.length===0))return xr=null,e;Ja()}}finally{Ai=t}}function Ja(){var n=En;$r=!0;var t=null;try{var e=0;for(gr(!0);pe.length>0;){var i=Le.ensure();if(e++>1e3){var r,s;bc()}i.process(pe),fn.clear()}}finally{$r=!1,gr(n),xr=null}}function bc(){try{ql()}catch(n){$n(n,xr)}}let ze=null;function qs(n){var t=n.length;if(t!==0){for(var e=0;e<t;){var i=n[e++];if((i.f&(Ke|oe))===0&&si(i)&&(ze=new Set,ei(i),i.deps===null&&i.first===null&&i.nodes===null&&(i.teardown===null&&i.ac===null?mo(i):i.fn=null),ze?.size>0)){fn.clear();for(const r of ze){if((r.f&(Ke|oe))!==0)continue;const s=[r];let a=r.parent;for(;a!==null;)ze.has(a)&&(ze.delete(a),s.push(a)),a=a.parent;for(let o=s.length-1;o>=0;o--){const l=s[o];(l.f&(Ke|oe))===0&&ei(l)}}ze.clear()}}ze=null}}function Za(n,t,e,i){if(!e.has(n)&&(e.add(n),n.reactions!==null))for(const r of n.reactions){const s=r.f;(s&Xt)!==0?Za(r,t,e,i):(s&(ps|Qe))!==0&&(s&ee)===0&&Qa(r,t,i)&&(Yt(r,ee),Rn(r))}}function Qa(n,t,e){const i=e.get(n);if(i!==void 0)return i;if(n.deps!==null)for(const r of n.deps){if(t.includes(r))return!0;if((r.f&Xt)!==0&&Qa(r,t,e))return e.set(r,!0),!0}return e.set(n,!1),!1}function Rn(n){for(var t=xr=n;t.parent!==null;){t=t.parent;var e=t.f;if($r&&t===nt&&(e&Qe)!==0&&(e&Ha)===0)return;if((e&(Dn|$e))!==0){if((e&Bt)===0)return;t.f^=Bt}}pe.push(t)}function $a(n){let t=0,e=Ln(0),i;return()=>{Mi()&&(v(e),Yi(()=>(t===0&&(i=$(()=>n(()=>Ti(e)))),t+=1,()=>{On(()=>{t-=1,t===0&&(i?.(),i=void 0,Ti(e))})})))}}var wc=An|ii|Cr;function Cc(n,t,e){new Sc(n,t,e)}class Sc{parent;#t=!1;#e;#i=null;#n;#l;#r;#s=null;#a=null;#o=null;#c=null;#h=null;#f=0;#u=0;#g=!1;#d=null;#y=$a(()=>(this.#d=Ln(this.#f),()=>{this.#d=null}));constructor(t,e,i){this.#e=t,this.#n=e,this.#l=i,this.parent=nt.b,this.#t=!!this.#n.pending,this.#r=Pr(()=>{nt.b=this;{var r=this.#_();try{this.#s=$t(()=>i(r))}catch(s){this.error(s)}this.#u>0?this.#v():this.#t=!1}return()=>{this.#h?.remove()}},wc)}#b(){try{this.#s=$t(()=>this.#l(this.#e))}catch(t){this.error(t)}this.#t=!1}#w(){const t=this.#n.pending;t&&(this.#a=$t(()=>t(this.#e)),Le.enqueue(()=>{var e=this.#_();this.#s=this.#p(()=>(Le.ensure(),$t(()=>this.#l(e)))),this.#u>0?this.#v():(kn(this.#a,()=>{this.#a=null}),this.#t=!1)}))}#_(){var t=this.#e;return this.#t&&(this.#h=un(),this.#e.before(this.#h),t=this.#h),t}is_pending(){return this.#t||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#n.pending}#p(t){var e=nt,i=Q,r=ot;Ge(this.#r),te(this.#r),Qn(this.#r.ctx);try{return t()}catch(s){return Ka(s),null}finally{Ge(e),te(i),Qn(r)}}#v(){const t=this.#n.pending;this.#s!==null&&(this.#c=document.createDocumentFragment(),this.#c.append(this.#h),wo(this.#s,this.#c)),this.#a===null&&(this.#a=$t(()=>t(this.#e)))}#m(t){if(!this.has_pending_snippet()){this.parent&&this.parent.#m(t);return}this.#u+=t,this.#u===0&&(this.#t=!1,this.#a&&kn(this.#a,()=>{this.#a=null}),this.#c&&(this.#e.before(this.#c),this.#c=null))}update_pending_count(t){this.#m(t),this.#f+=t,this.#d&&ti(this.#d,this.#f)}get_effect_pending(){return this.#y(),v(this.#d)}error(t){var e=this.#n.onerror;let i=this.#n.failed;if(this.#g||!e&&!i)throw t;this.#s&&(Ht(this.#s),this.#s=null),this.#a&&(Ht(this.#a),this.#a=null),this.#o&&(Ht(this.#o),this.#o=null);var r=!1,s=!1;const a=()=>{if(r){gc();return}r=!0,s&&$l(),Le.ensure(),this.#f=0,this.#o!==null&&kn(this.#o,()=>{this.#o=null}),this.#t=this.has_pending_snippet(),this.#s=this.#p(()=>(this.#g=!1,$t(()=>this.#l(this.#e)))),this.#u>0?this.#v():this.#t=!1};var o=Q;try{te(null),s=!0,e?.(t,a),s=!1}catch(l){$n(l,this.#r&&this.#r.parent)}finally{te(o)}i&&On(()=>{this.#o=this.#p(()=>{Le.ensure(),this.#g=!0;try{return $t(()=>{i(this.#e,()=>t,()=>a)})}catch(l){return $n(l,this.#r.parent),null}finally{this.#g=!1}})})}}function to(n,t,e,i){const r=Ni()?Bi:qt;if(e.length===0&&n.length===0){i(t.map(r));return}var s=rt,a=nt,o=xc();function l(){Promise.all(e.map(c=>kc(c))).then(c=>{o();try{i([...t.map(r),...c])}catch(f){(a.f&Ke)===0&&$n(f,a)}s?.deactivate(),dr()}).catch(c=>{$n(c,a)})}n.length>0?Promise.all(n).then(()=>{o();try{return l()}finally{s?.deactivate(),dr()}}):l()}function xc(){var n=nt,t=Q,e=ot,i=rt;return function(s=!0){Ge(n),te(t),Qn(e),s&&i?.activate()}}function dr(){Ge(null),te(null),Qn(null)}function Bi(n){var t=Xt|ee,e=Q!==null&&(Q.f&Xt)!==0?Q:null;return nt!==null&&(nt.f|=ii),{ctx:ot,deps:null,effects:null,equals:Wa,f:t,fn:n,reactions:null,rv:0,v:Gt,wv:0,parent:e??nt,ac:null}}function kc(n,t){let e=nt;e===null&&Vl();var i=e.b,r=void 0,s=Ln(Gt),a=!Q,o=new Map;return Gc(()=>{var l=Na();r=l.promise;try{Promise.resolve(n()).then(l.resolve,l.reject).then(()=>{c===rt&&c.committed&&c.deactivate(),dr()})}catch(h){l.reject(h),dr()}var c=rt;if(a){var f=!i.is_pending();i.update_pending_count(1),c.increment(f),o.get(c)?.reject(qn),o.delete(c),o.set(c,l)}const u=(h,p=void 0)=>{if(c.activate(),p)p!==qn&&(s.f|=hn,ti(s,p));else{(s.f&hn)!==0&&(s.f^=hn),ti(s,h);for(const[d,w]of o){if(o.delete(d),d===c)break;w.reject(qn)}}a&&(i.update_pending_count(-1),c.decrement(f))};l.promise.then(u,h=>u(null,h||"unknown"))}),Er(()=>{for(const l of o.values())l.reject(qn)}),new Promise(l=>{function c(f){function u(){f===r?l(s):c(r)}f.then(u,u)}c(r)})}function lt(n){const t=Bi(n);return Co(t),t}function qt(n){const t=Bi(n);return t.equals=Ua,t}function eo(n){var t=n.effects;if(t!==null){n.effects=null;for(var e=0;e<t.length;e+=1)Ht(t[e])}}function Ec(n){for(var t=n.parent;t!==null;){if((t.f&Xt)===0)return(t.f&Ke)===0?t:null;t=t.parent}return null}function vs(n){var t,e=nt;Ge(Ec(n));try{n.f&=~Tn,eo(n),t=Eo(n)}finally{Ge(e)}return t}function no(n){var t=vs(n);if(n.equals(t)||(rt?.is_fork||(n.v=t),n.wv=xo()),!Mn)if(me!==null)(Mi()||rt?.is_fork)&&me.set(n,t);else{var e=(n.f&xe)===0?Fe:Bt;Yt(n,e)}}let ts=new Set;const fn=new Map;let io=!1;function Ln(n,t){var e={f:0,v:n,reactions:null,equals:Wa,rv:0,wv:0};return e}function Ot(n,t){const e=Ln(n);return Co(e),e}function Ft(n,t=!1,e=!0){const i=Ln(n);return t||(i.equals=Ua),ri&&e&&ot!==null&&ot.l!==null&&(ot.l.s??=[]).push(i),i}function Ks(n,t){return O(n,$(()=>v(n))),t}function O(n,t,e=!1){Q!==null&&(!Me||(Q.f&zs)!==0)&&Ni()&&(Q.f&(Xt|Qe|ps|zs))!==0&&!Ze?.includes(n)&&Ql();let i=e?De(t):t;return ti(n,i)}function ti(n,t){if(!n.equals(t)){var e=n.v;Mn?fn.set(n,t):fn.set(n,e),n.v=t;var i=Le.ensure();i.capture(n,e),(n.f&Xt)!==0&&((n.f&ee)!==0&&vs(n),Yt(n,(n.f&xe)!==0?Bt:Fe)),n.wv=xo(),ro(n,ee),Ni()&&nt!==null&&(nt.f&Bt)!==0&&(nt.f&($e|Dn))===0&&(ge===null?Nc([n]):ge.push(n)),!i.is_fork&&ts.size>0&&!io&&Pc()}return t}function Pc(){io=!1;var n=En;gr(!0);const t=Array.from(ts);try{for(const e of t)(e.f&Bt)!==0&&Yt(e,Fe),si(e)&&ei(e)}finally{gr(n)}ts.clear()}function Ti(n){O(n,n.v+1)}function ro(n,t){var e=n.reactions;if(e!==null)for(var i=Ni(),r=e.length,s=0;s<r;s++){var a=e[s],o=a.f;if(!(!i&&a===nt)){var l=(o&ee)===0;if(l&&Yt(a,t),(o&Xt)!==0){var c=a;me?.delete(c),(o&Tn)===0&&(o&xe&&(a.f|=Tn),ro(c,Fe))}else l&&((o&Qe)!==0&&ze!==null&&ze.add(a),Rn(a))}}}function De(n){if(typeof n!="object"||n===null||Je in n)return n;const t=us(n);if(t!==Bl&&t!==Hl)return n;var e=new Map,i=yr(n),r=Ot(0),s=Pn,a=o=>{if(Pn===s)return o();var l=Q,c=Pn;te(null),$s(s);var f=o();return te(l),$s(c),f};return i&&e.set("length",Ot(n.length)),new Proxy(n,{defineProperty(o,l,c){(!("value"in c)||c.configurable===!1||c.enumerable===!1||c.writable===!1)&&Jl();var f=e.get(l);return f===void 0?f=a(()=>{var u=Ot(c.value);return e.set(l,u),u}):O(f,c.value,!0),!0},deleteProperty(o,l){var c=e.get(l);if(c===void 0){if(l in o){const f=a(()=>Ot(Gt));e.set(l,f),Ti(r)}}else O(c,Gt),Ti(r);return!0},get(o,l,c){if(l===Je)return n;var f=e.get(l),u=l in o;if(f===void 0&&(!u||Zn(o,l)?.writable)&&(f=a(()=>{var p=De(u?o[l]:Gt),d=Ot(p);return d}),e.set(l,f)),f!==void 0){var h=v(f);return h===Gt?void 0:h}return Reflect.get(o,l,c)},getOwnPropertyDescriptor(o,l){var c=Reflect.getOwnPropertyDescriptor(o,l);if(c&&"value"in c){var f=e.get(l);f&&(c.value=v(f))}else if(c===void 0){var u=e.get(l),h=u?.v;if(u!==void 0&&h!==Gt)return{enumerable:!0,configurable:!0,value:h,writable:!0}}return c},has(o,l){if(l===Je)return!0;var c=e.get(l),f=c!==void 0&&c.v!==Gt||Reflect.has(o,l);if(c!==void 0||nt!==null&&(!f||Zn(o,l)?.writable)){c===void 0&&(c=a(()=>{var h=f?De(o[l]):Gt,p=Ot(h);return p}),e.set(l,c));var u=v(c);if(u===Gt)return!1}return f},set(o,l,c,f){var u=e.get(l),h=l in o;if(i&&l==="length")for(var p=c;p<u.v;p+=1){var d=e.get(p+"");d!==void 0?O(d,Gt):p in o&&(d=a(()=>Ot(Gt)),e.set(p+"",d))}if(u===void 0)(!h||Zn(o,l)?.writable)&&(u=a(()=>Ot(void 0)),O(u,De(c)),e.set(l,u));else{h=u.v!==Gt;var w=a(()=>De(c));O(u,w)}var g=Reflect.getOwnPropertyDescriptor(o,l);if(g?.set&&g.set.call(f,c),!h){if(i&&typeof l=="string"){var y=e.get("length"),L=Number(l);Number.isInteger(L)&&L>=y.v&&O(y,L+1)}Ti(r)}return!0},ownKeys(o){v(r);var l=Reflect.ownKeys(o).filter(u=>{var h=e.get(u);return h===void 0||h.v!==Gt});for(var[c,f]of e)f.v!==Gt&&!(c in o)&&l.push(c);return l},setPrototypeOf(){Zl()}})}function Js(n){try{if(n!==null&&typeof n=="object"&&Je in n)return n[Je]}catch{}return n}function Ac(n,t){return Object.is(Js(n),Js(t))}var je,so,ao,oo;function Tc(){if(je===void 0){je=window,so=/Firefox/.test(navigator.userAgent);var n=Element.prototype,t=Node.prototype,e=Text.prototype;ao=Zn(t,"firstChild").get,oo=Zn(t,"nextSibling").get,Us(n)&&(n.__click=void 0,n.__className=void 0,n.__attributes=null,n.__style=void 0,n.__e=void 0),Us(e)&&(e.__t=void 0)}}function un(n=""){return document.createTextNode(n)}function Oe(n){return ao.call(n)}function Hi(n){return oo.call(n)}function F(n,t){return Oe(n)}function _e(n,t=!1){{var e=Oe(n);return e instanceof Comment&&e.data===""?Hi(e):e}}function G(n,t=1,e=!1){let i=n;for(;t--;)i=Hi(i);return i}function Rc(n){n.textContent=""}function lo(){return!1}function co(n,t){if(t){const e=document.body;n.autofocus=!0,On(()=>{document.activeElement===e&&n.focus()})}}let Zs=!1;function Lc(){Zs||(Zs=!0,document.addEventListener("reset",n=>{Promise.resolve().then(()=>{if(!n.defaultPrevented)for(const t of n.target.elements)t.__on_r?.()})},{capture:!0}))}function kr(n){var t=Q,e=nt;te(null),Ge(null);try{return n()}finally{te(t),Ge(e)}}function Dc(n,t,e,i=e){n.addEventListener(t,()=>kr(e));const r=n.__on_r;r?n.__on_r=()=>{r(),i(!0)}:n.__on_r=()=>i(!0),Lc()}function ho(n){nt===null&&(Q===null&&jl(),zl()),Mn&&Ul()}function Oc(n,t){var e=t.last;e===null?t.last=t.first=n:(e.next=n,n.prev=e,t.last=n)}function ke(n,t,e){var i=nt;i!==null&&(i.f&oe)!==0&&(n|=oe);var r={ctx:ot,deps:null,nodes:null,f:n|ee|xe,first:null,fn:t,last:null,next:null,parent:i,b:i&&i.b,prev:null,teardown:null,wv:0,ac:null};if(e)try{ei(r),r.f|=gs}catch(o){throw Ht(r),o}else t!==null&&Rn(r);var s=r;if(e&&s.deps===null&&s.teardown===null&&s.nodes===null&&s.first===s.last&&(s.f&ii)===0&&(s=s.first,(n&Qe)!==0&&(n&An)!==0&&s!==null&&(s.f|=An)),s!==null&&(s.parent=i,i!==null&&Oc(s,i),Q!==null&&(Q.f&Xt)!==0&&(n&Dn)===0)){var a=Q;(a.effects??=[]).push(s)}return r}function Mi(){return Q!==null&&!Me}function Er(n){const t=ke(wr,null,!1);return Yt(t,Bt),t.teardown=n,t}function M(n){ho();var t=nt.f,e=!Q&&(t&$e)!==0&&(t&gs)===0;if(e){var i=ot;(i.e??=[]).push(n)}else return fo(n)}function fo(n){return ke(ds|Ya,n,!1)}function Mc(n){return ho(),ke(wr|Ya,n,!0)}function Ic(n){Le.ensure();const t=ke(Dn|ii,n,!0);return(e={})=>new Promise(i=>{e.outro?kn(t,()=>{Ht(t),i(void 0)}):(Ht(t),i(void 0))})}function _s(n){return ke(ds,n,!1)}function Dt(n,t){var e=ot,i={effect:null,ran:!1,deps:n};e.l.$.push(i),i.effect=Yi(()=>{n(),!i.ran&&(i.ran=!0,$(t))})}function uo(){var n=ot;Yi(()=>{for(var t of n.l.$){t.deps();var e=t.effect;(e.f&Bt)!==0&&Yt(e,Fe),si(e)&&ei(e),t.ran=!1}})}function Gc(n){return ke(ps|ii,n,!0)}function Yi(n,t=0){return ke(wr|t,n,!0)}function yt(n,t=[],e=[],i=[]){to(i,t,e,r=>{ke(wr,()=>n(...r.map(v)),!0)})}function Pr(n,t=0){var e=ke(Qe|t,n,!0);return e}function go(n,t=0){var e=ke(Ba|t,n,!0);return e}function $t(n){return ke($e|ii,n,!0)}function po(n){var t=n.teardown;if(t!==null){const e=Mn,i=Q;Qs(!0),te(null);try{t.call(null)}finally{Qs(e),te(i)}}}function vo(n,t=!1){var e=n.first;for(n.first=n.last=null;e!==null;){const r=e.ac;r!==null&&kr(()=>{r.abort(qn)});var i=e.next;(e.f&Dn)!==0?e.parent=null:Ht(e,t),e=i}}function Fc(n){for(var t=n.first;t!==null;){var e=t.next;(t.f&$e)===0&&Ht(t),t=e}}function Ht(n,t=!0){var e=!1;(t||(n.f&Ha)!==0)&&n.nodes!==null&&n.nodes.end!==null&&(_o(n.nodes.start,n.nodes.end),e=!0),vo(n,t&&!e),pr(n,0),Yt(n,Ke);var i=n.nodes&&n.nodes.t;if(i!==null)for(const s of i)s.stop();po(n);var r=n.parent;r!==null&&r.first!==null&&mo(n),n.next=n.prev=n.teardown=n.ctx=n.deps=n.fn=n.nodes=n.ac=null}function _o(n,t){for(;n!==null;){var e=n===t?null:Hi(n);n.remove(),n=e}}function mo(n){var t=n.parent,e=n.prev,i=n.next;e!==null&&(e.next=i),i!==null&&(i.prev=e),t!==null&&(t.first===n&&(t.first=i),t.last===n&&(t.last=e))}function kn(n,t,e=!0){var i=[];yo(n,i,!0);var r=()=>{e&&Ht(n),t&&t()},s=i.length;if(s>0){var a=()=>--s||r();for(var o of i)o.out(a)}else r()}function yo(n,t,e){if((n.f&oe)===0){n.f^=oe;var i=n.nodes&&n.nodes.t;if(i!==null)for(const o of i)(o.is_global||e)&&t.push(o);for(var r=n.first;r!==null;){var s=r.next,a=(r.f&An)!==0||(r.f&$e)!==0&&(n.f&Qe)!==0;yo(r,t,a?e:!1),r=s}}}function ms(n){bo(n,!0)}function bo(n,t){if((n.f&oe)!==0){n.f^=oe,(n.f&Bt)===0&&(Yt(n,ee),Rn(n));for(var e=n.first;e!==null;){var i=e.next,r=(e.f&An)!==0||(e.f&$e)!==0;bo(e,r?t:!1),e=i}var s=n.nodes&&n.nodes.t;if(s!==null)for(const a of s)(a.is_global||t)&&a.in()}}function wo(n,t){if(n.nodes)for(var e=n.nodes.start,i=n.nodes.end;e!==null;){var r=e===i?null:Hi(e);t.append(e),e=r}}let En=!1;function gr(n){En=n}let Mn=!1;function Qs(n){Mn=n}let Q=null,Me=!1;function te(n){Q=n}let nt=null;function Ge(n){nt=n}let Ze=null;function Co(n){Q!==null&&(Ze===null?Ze=[n]:Ze.push(n))}let Kt=null,se=0,ge=null;function Nc(n){ge=n}let So=1,Ii=0,Pn=Ii;function $s(n){Pn=n}function xo(){return++So}function si(n){var t=n.f;if((t&ee)!==0)return!0;if(t&Xt&&(n.f&=~Tn),(t&Fe)!==0){var e=n.deps;if(e!==null)for(var i=e.length,r=0;r<i;r++){var s=e[r];if(si(s)&&no(s),s.wv>n.wv)return!0}(t&xe)!==0&&me===null&&Yt(n,Bt)}return!1}function ko(n,t,e=!0){var i=n.reactions;if(i!==null&&!Ze?.includes(n))for(var r=0;r<i.length;r++){var s=i[r];(s.f&Xt)!==0?ko(s,t,!1):t===s&&(e?Yt(s,ee):(s.f&Bt)!==0&&Yt(s,Fe),Rn(s))}}function Eo(n){var t=Kt,e=se,i=ge,r=Q,s=Ze,a=ot,o=Me,l=Pn,c=n.f;Kt=null,se=0,ge=null,Q=(c&($e|Dn))===0?n:null,Ze=null,Qn(n.ctx),Me=!1,Pn=++Ii,n.ac!==null&&(kr(()=>{n.ac.abort(qn)}),n.ac=null);try{n.f|=Qr;var f=n.fn,u=f(),h=n.deps;if(Kt!==null){var p;if(pr(n,se),h!==null&&se>0)for(h.length=se+Kt.length,p=0;p<Kt.length;p++)h[se+p]=Kt[p];else n.deps=h=Kt;if(Mi()&&(n.f&xe)!==0)for(p=se;p<h.length;p++)(h[p].reactions??=[]).push(n)}else h!==null&&se<h.length&&(pr(n,se),h.length=se);if(Ni()&&ge!==null&&!Me&&h!==null&&(n.f&(Xt|Fe|ee))===0)for(p=0;p<ge.length;p++)ko(ge[p],n);return r!==null&&r!==n&&(Ii++,ge!==null&&(i===null?i=ge:i.push(...ge))),(n.f&hn)!==0&&(n.f^=hn),u}catch(d){return Ka(d)}finally{n.f^=Qr,Kt=t,se=e,ge=i,Q=r,Ze=s,Qn(a),Me=o,Pn=l}}function Bc(n,t){let e=t.reactions;if(e!==null){var i=Nl.call(e,n);if(i!==-1){var r=e.length-1;r===0?e=t.reactions=null:(e[i]=e[r],e.pop())}}e===null&&(t.f&Xt)!==0&&(Kt===null||!Kt.includes(t))&&(Yt(t,Fe),(t.f&xe)!==0&&(t.f^=xe,t.f&=~Tn),eo(t),pr(t,0))}function pr(n,t){var e=n.deps;if(e!==null)for(var i=t;i<e.length;i++)Bc(n,e[i])}function ei(n){var t=n.f;if((t&Ke)===0){Yt(n,Bt);var e=nt,i=En;nt=n,En=!0;try{(t&(Qe|Ba))!==0?Fc(n):vo(n),po(n);var r=Eo(n);n.teardown=typeof r=="function"?r:null,n.wv=So;var s;Jr&&pc&&(n.f&ee)!==0&&n.deps}finally{En=i,nt=e}}}async function Hc(){await Promise.resolve(),yc()}function v(n){var t=n.f,e=(t&Xt)!==0;if(Q!==null&&!Me){var i=nt!==null&&(nt.f&Ke)!==0;if(!i&&!Ze?.includes(n)){var r=Q.deps;if((Q.f&Qr)!==0)n.rv<Ii&&(n.rv=Ii,Kt===null&&r!==null&&r[se]===n?se++:Kt===null?Kt=[n]:Kt.includes(n)||Kt.push(n));else{(Q.deps??=[]).push(n);var s=n.reactions;s===null?n.reactions=[Q]:s.includes(Q)||s.push(Q)}}}if(Mn){if(fn.has(n))return fn.get(n);if(e){var a=n,o=a.v;return((a.f&Bt)===0&&a.reactions!==null||Ao(a))&&(o=vs(a)),fn.set(a,o),o}}else e&&(!me?.has(n)||rt?.is_fork&&!Mi())&&(a=n,si(a)&&no(a),En&&Mi()&&(a.f&xe)===0&&Po(a));if(me?.has(n))return me.get(n);if((n.f&hn)!==0)throw n.v;return n.v}function Po(n){if(n.deps!==null){n.f^=xe;for(const t of n.deps)(t.reactions??=[]).push(n),(t.f&Xt)!==0&&(t.f&xe)===0&&Po(t)}}function Ao(n){if(n.v===Gt)return!0;if(n.deps===null)return!1;for(const t of n.deps)if(fn.has(t)||(t.f&Xt)!==0&&Ao(t))return!0;return!1}function $(n){var t=Me;try{return Me=!0,n()}finally{Me=t}}const Yc=-7169;function Yt(n,t){n.f=n.f&Yc|t}function S(n){if(!(typeof n!="object"||!n||n instanceof EventTarget)){if(Je in n)es(n);else if(!Array.isArray(n))for(let t in n){const e=n[t];typeof e=="object"&&e&&Je in e&&es(e)}}}function es(n,t=new Set){if(typeof n=="object"&&n!==null&&!(n instanceof EventTarget)&&!t.has(n)){t.add(n),n instanceof Date&&n.getTime();for(let i in n)try{es(n[i],t)}catch{}const e=us(n);if(e!==Object.prototype&&e!==Array.prototype&&e!==Map.prototype&&e!==Set.prototype&&e!==Date.prototype){const i=Fa(e);for(let r in i){const s=i[r].get;if(s)try{s.call(n)}catch{}}}}}function Xc(n){return n.endsWith("capture")&&n!=="gotpointercapture"&&n!=="lostpointercapture"}const Wc=["beforeinput","click","change","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"];function Vc(n){return Wc.includes(n)}const Uc={formnovalidate:"formNoValidate",ismap:"isMap",nomodule:"noModule",playsinline:"playsInline",readonly:"readOnly",defaultvalue:"defaultValue",defaultchecked:"defaultChecked",srcobject:"srcObject",novalidate:"noValidate",allowfullscreen:"allowFullscreen",disablepictureinpicture:"disablePictureInPicture",disableremoteplayback:"disableRemotePlayback"};function zc(n){return n=n.toLowerCase(),Uc[n]??n}const jc=["touchstart","touchmove"];function qc(n){return jc.includes(n)}const To=new Set,ns=new Set;function ys(n,t,e,i={}){function r(s){if(i.capture||bi.call(t,s),!s.cancelBubble)return kr(()=>e?.call(this,s))}return n.startsWith("pointer")||n.startsWith("touch")||n==="wheel"?On(()=>{t.addEventListener(n,r,i)}):t.addEventListener(n,r,i),r}function Ro(n,t,e,i={}){var r=ys(t,n,e,i);return()=>{n.removeEventListener(t,r,i)}}function pt(n,t,e,i,r){var s={capture:i,passive:r},a=ys(n,t,e,s);(t===document.body||t===window||t===document||t instanceof HTMLMediaElement)&&Er(()=>{t.removeEventListener(n,a,s)})}function Xi(n){for(var t=0;t<n.length;t++)To.add(n[t]);for(var e of ns)e(n)}let ta=null;function bi(n){var t=this,e=t.ownerDocument,i=n.type,r=n.composedPath?.()||[],s=r[0]||n.target;ta=n;var a=0,o=ta===n&&n.__root;if(o){var l=r.indexOf(o);if(l!==-1&&(t===document||t===window)){n.__root=t;return}var c=r.indexOf(t);if(c===-1)return;l<=c&&(a=l)}if(s=r[a]||n.target,s!==t){Ga(n,"currentTarget",{configurable:!0,get(){return s||e}});var f=Q,u=nt;te(null),Ge(null);try{for(var h,p=[];s!==null;){var d=s.assignedSlot||s.parentNode||s.host||null;try{var w=s["__"+i];w!=null&&(!s.disabled||n.target===s)&&w.call(s,n)}catch(g){h?p.push(g):h=g}if(n.cancelBubble||d===t||d===null)break;s=d}if(h){for(let g of p)queueMicrotask(()=>{throw g});throw h}}finally{n.__root=t,delete n.currentTarget,te(f),Ge(u)}}}function bs(n){var t=document.createElement("template");return t.innerHTML=n.replaceAll("<!>","<!---->"),t.content}function Gi(n,t){var e=nt;e.nodes===null&&(e.nodes={start:n,end:t,a:null,t:null})}function J(n,t){var e=(t&cc)!==0,i=(t&hc)!==0,r,s=!n.startsWith("<!>");return()=>{r===void 0&&(r=bs(s?n:"<!>"+n),e||(r=Oe(r)));var a=i||so?document.importNode(r,!0):r.cloneNode(!0);if(e){var o=Oe(a),l=a.lastChild;Gi(o,l)}else Gi(a,a);return a}}function Kc(n,t,e="svg"){var i=!n.startsWith("<!>"),r=`<${e}>${i?n:"<!>"+n}</${e}>`,s;return()=>{if(!s){var a=bs(r),o=Oe(a);s=Oe(o)}var l=s.cloneNode(!0);return Gi(l,l),l}}function Ne(n,t){return Kc(n,t,"svg")}function dn(){var n=document.createDocumentFragment(),t=document.createComment(""),e=un();return n.append(t,e),Gi(t,e),n}function H(n,t){n!==null&&n.before(t)}function ae(n,t){var e=t==null?"":typeof t=="object"?t+"":t;e!==(n.__t??=n.nodeValue)&&(n.__t=e,n.nodeValue=e+"")}function Jc(n,t){return Zc(n,t)}const Vn=new Map;function Zc(n,{target:t,anchor:e,props:i={},events:r,context:s,intro:a=!0}){Tc();var o=new Set,l=u=>{for(var h=0;h<u.length;h++){var p=u[h];if(!o.has(p)){o.add(p);var d=qc(p);t.addEventListener(p,bi,{passive:d});var w=Vn.get(p);w===void 0?(document.addEventListener(p,bi,{passive:d}),Vn.set(p,1)):Vn.set(p,w+1)}}};l(br(To)),ns.add(l);var c=void 0,f=Ic(()=>{var u=e??t.appendChild(un());return Cc(u,{pending:()=>{}},h=>{if(s){ne({});var p=ot;p.c=s}r&&(i.$$events=r),c=n(h,i)||{},s&&ie()}),()=>{for(var h of o){t.removeEventListener(h,bi);var p=Vn.get(h);--p===0?(document.removeEventListener(h,bi),Vn.delete(h)):Vn.set(h,p)}ns.delete(l),u!==e&&u.parentNode?.removeChild(u)}});return Qc.set(c,f),c}let Qc=new WeakMap;class Lo{anchor;#t=new Map;#e=new Map;#i=new Map;#n=new Set;#l=!0;constructor(t,e=!0){this.anchor=t,this.#l=e}#r=()=>{var t=rt;if(this.#t.has(t)){var e=this.#t.get(t),i=this.#e.get(e);if(i)ms(i),this.#n.delete(e);else{var r=this.#i.get(e);r&&(this.#e.set(e,r.effect),this.#i.delete(e),r.fragment.lastChild.remove(),this.anchor.before(r.fragment),i=r.effect)}for(const[s,a]of this.#t){if(this.#t.delete(s),s===t)break;const o=this.#i.get(a);o&&(Ht(o.effect),this.#i.delete(a))}for(const[s,a]of this.#e){if(s===e||this.#n.has(s))continue;const o=()=>{if(Array.from(this.#t.values()).includes(s)){var c=document.createDocumentFragment();wo(a,c),c.append(un()),this.#i.set(s,{effect:a,fragment:c})}else Ht(a);this.#n.delete(s),this.#e.delete(s)};this.#l||!i?(this.#n.add(s),kn(a,o,!1)):o()}}};#s=t=>{this.#t.delete(t);const e=Array.from(this.#t.values());for(const[i,r]of this.#i)e.includes(i)||(Ht(r.effect),this.#i.delete(i))};ensure(t,e){var i=rt,r=lo();if(e&&!this.#e.has(t)&&!this.#i.has(t))if(r){var s=document.createDocumentFragment(),a=un();s.append(a),this.#i.set(t,{effect:$t(()=>e(a)),fragment:s})}else this.#e.set(t,$t(()=>e(this.anchor)));if(this.#t.set(i,t),r){for(const[o,l]of this.#e)o===t?i.skipped_effects.delete(l):i.skipped_effects.add(l);for(const[o,l]of this.#i)o===t?i.skipped_effects.delete(l.effect):i.skipped_effects.add(l.effect);i.oncommit(this.#r),i.ondiscard(this.#s)}else this.#r()}}function st(n,t,e=!1){var i=new Lo(n),r=e?An:0;function s(a,o){i.ensure(a,o)}Pr(()=>{var a=!1;t((o,l=!0)=>{a=!0,s(l,o)}),a||s(!1,null)},r)}function vr(n,t){return t}function $c(n,t,e){for(var i=[],r=t.length,s,a=t.length,o=0;o<r;o++){let u=t[o];kn(u,()=>{if(s){if(s.pending.delete(u),s.done.add(u),s.pending.size===0){var h=n.outrogroups;is(br(s.done)),h.delete(s),h.size===0&&(n.outrogroups=null)}}else a-=1},!1)}if(a===0){var l=i.length===0&&e!==null;if(l){var c=e,f=c.parentNode;Rc(f),f.append(c),n.items.clear()}is(t,!l)}else s={pending:new Set(t),done:new Set},(n.outrogroups??=new Set).add(s)}function is(n,t=!0){for(var e=0;e<n.length;e++)Ht(n[e],t)}var ea;function _r(n,t,e,i,r,s=null){var a=n,o=new Map,l=(t&Xa)!==0;if(l){var c=n;a=c.appendChild(un())}var f=null,u=qt(()=>{var y=e();return yr(y)?y:y==null?[]:br(y)}),h,p=!0;function d(){g.fallback=f,th(g,h,a,t,i),f!==null&&(h.length===0?(f.f&qe)===0?ms(f):(f.f^=qe,wi(f,null,a)):kn(f,()=>{f=null}))}var w=Pr(()=>{h=v(u);for(var y=h.length,L=new Set,I=rt,E=lo(),A=0;A<y;A+=1){var Y=h[A],T=i(Y,A),R=p?null:o.get(T);R?(R.v&&ti(R.v,Y),R.i&&ti(R.i,A),E&&I.skipped_effects.delete(R.e)):(R=eh(o,p?a:ea??=un(),Y,T,A,r,t,e),p||(R.e.f|=qe),o.set(T,R)),L.add(T)}if(y===0&&s&&!f&&(p?f=$t(()=>s(a)):(f=$t(()=>s(ea??=un())),f.f|=qe)),!p)if(E){for(const[W,z]of o)L.has(W)||I.skipped_effects.add(z.e);I.oncommit(d),I.ondiscard(()=>{})}else d();v(u)}),g={effect:w,items:o,outrogroups:null,fallback:f};p=!1}function th(n,t,e,i,r){var s=(i&nc)!==0,a=t.length,o=n.items,l=n.effect.first,c,f=null,u,h=[],p=[],d,w,g,y;if(s)for(y=0;y<a;y+=1)d=t[y],w=r(d,y),g=o.get(w).e,(g.f&qe)===0&&(g.nodes?.a?.measure(),(u??=new Set).add(g));for(y=0;y<a;y+=1){if(d=t[y],w=r(d,y),g=o.get(w).e,n.outrogroups!==null)for(const z of n.outrogroups)z.pending.delete(g),z.done.delete(g);if((g.f&qe)!==0)if(g.f^=qe,g===l)wi(g,null,e);else{var L=f?f.next:l;g===n.effect.last&&(n.effect.last=g.prev),g.prev&&(g.prev.next=g.next),g.next&&(g.next.prev=g.prev),sn(n,f,g),sn(n,g,L),wi(g,L,e),f=g,h=[],p=[],l=f.next;continue}if((g.f&oe)!==0&&(ms(g),s&&(g.nodes?.a?.unfix(),(u??=new Set).delete(g))),g!==l){if(c!==void 0&&c.has(g)){if(h.length<p.length){var I=p[0],E;f=I.prev;var A=h[0],Y=h[h.length-1];for(E=0;E<h.length;E+=1)wi(h[E],I,e);for(E=0;E<p.length;E+=1)c.delete(p[E]);sn(n,A.prev,Y.next),sn(n,f,A),sn(n,Y,I),l=I,f=Y,y-=1,h=[],p=[]}else c.delete(g),wi(g,l,e),sn(n,g.prev,g.next),sn(n,g,f===null?n.effect.first:f.next),sn(n,f,g),f=g;continue}for(h=[],p=[];l!==null&&l!==g;)(c??=new Set).add(l),p.push(l),l=l.next;if(l===null)continue}(g.f&qe)===0&&h.push(g),f=g,l=g.next}if(n.outrogroups!==null){for(const z of n.outrogroups)z.pending.size===0&&(is(br(z.done)),n.outrogroups?.delete(z));n.outrogroups.size===0&&(n.outrogroups=null)}if(l!==null||c!==void 0){var T=[];if(c!==void 0)for(g of c)(g.f&oe)===0&&T.push(g);for(;l!==null;)(l.f&oe)===0&&l!==n.fallback&&T.push(l),l=l.next;var R=T.length;if(R>0){var W=(i&Xa)!==0&&a===0?e:null;if(s){for(y=0;y<R;y+=1)T[y].nodes?.a?.measure();for(y=0;y<R;y+=1)T[y].nodes?.a?.fix()}$c(n,T,W)}}s&&On(()=>{if(u!==void 0)for(g of u)g.nodes?.a?.apply()})}function eh(n,t,e,i,r,s,a,o){var l=(a&tc)!==0?(a&ic)===0?Ft(e,!1,!1):Ln(e):null,c=(a&ec)!==0?Ln(r):null;return{v:l,i:c,e:$t(()=>(s(t,l??e,c??r,o),()=>{n.delete(i)}))}}function wi(n,t,e){if(n.nodes)for(var i=n.nodes.start,r=n.nodes.end,s=t&&(t.f&qe)===0?t.nodes.start:e;i!==null;){var a=Hi(i);if(s.before(i),i===r)return;i=a}}function sn(n,t,e){t===null?n.effect.first=e:t.next=e,e===null?n.effect.last=t:e.prev=t}function Sn(n,t,e=!1,i=!1,r=!1){var s=n,a="";yt(()=>{var o=nt;if(a!==(a=t()??"")&&(o.nodes!==null&&(_o(o.nodes.start,o.nodes.end),o.nodes=null),a!=="")){var l=a+"";e?l=`<svg>${l}</svg>`:i&&(l=`<math>${l}</math>`);var c=bs(l);if((e||i)&&(c=Oe(c)),Gi(Oe(c),c.lastChild),e||i)for(;Oe(c);)s.before(Oe(c));else s.before(c)}})}function ws(n,t,...e){var i=new Lo(n);Pr(()=>{const r=t()??null;i.ensure(r,r&&(s=>r(s,...e)))},An)}const nh=()=>performance.now(),we={tick:n=>requestAnimationFrame(n),now:()=>nh(),tasks:new Set};function Do(){const n=we.now();we.tasks.forEach(t=>{t.c(n)||(we.tasks.delete(t),t.f())}),we.tasks.size!==0&&we.tick(Do)}function ih(n){let t;return we.tasks.size===0&&we.tick(Do),{promise:new Promise(e=>{we.tasks.add(t={c:n,f:e})}),abort(){we.tasks.delete(t)}}}function rh(n,t){var e=void 0,i;go(()=>{e!==(e=t())&&(i&&(Ht(i),i=null),e&&(i=$t(()=>{_s(()=>e(n))})))})}function Oo(n){var t,e,i="";if(typeof n=="string"||typeof n=="number")i+=n;else if(typeof n=="object")if(Array.isArray(n)){var r=n.length;for(t=0;t<r;t++)n[t]&&(e=Oo(n[t]))&&(i&&(i+=" "),i+=e)}else for(e in n)n[e]&&(i&&(i+=" "),i+=e);return i}function sh(){for(var n,t,e=0,i="",r=arguments.length;e<r;e++)(n=arguments[e])&&(t=Oo(n))&&(i&&(i+=" "),i+=t);return i}function hr(n){return typeof n=="object"?sh(n):n??""}const na=[...` 	
\r\fÂ \v\uFEFF`];function ah(n,t,e){var i=n==null?"":""+n;if(t&&(i=i?i+" "+t:t),e){for(var r in e)if(e[r])i=i?i+" "+r:r;else if(i.length)for(var s=r.length,a=0;(a=i.indexOf(r,a))>=0;){var o=a+s;(a===0||na.includes(i[a-1]))&&(o===i.length||na.includes(i[o]))?i=(a===0?"":i.substring(0,a))+i.substring(o+1):a=o}}return i===""?null:i}function ia(n,t=!1){var e=t?" !important;":";",i="";for(var r in n){var s=n[r];s!=null&&s!==""&&(i+=" "+r+": "+s+e)}return i}function Gr(n){return n[0]!=="-"||n[1]!=="-"?n.toLowerCase():n}function oh(n,t){if(t){var e="",i,r;if(Array.isArray(t)?(i=t[0],r=t[1]):i=t,n){n=String(n).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var s=!1,a=0,o=!1,l=[];i&&l.push(...Object.keys(i).map(Gr)),r&&l.push(...Object.keys(r).map(Gr));var c=0,f=-1;const w=n.length;for(var u=0;u<w;u++){var h=n[u];if(o?h==="/"&&n[u-1]==="*"&&(o=!1):s?s===h&&(s=!1):h==="/"&&n[u+1]==="*"?o=!0:h==='"'||h==="'"?s=h:h==="("?a++:h===")"&&a--,!o&&s===!1&&a===0){if(h===":"&&f===-1)f=u;else if(h===";"||u===w-1){if(f!==-1){var p=Gr(n.substring(c,f).trim());if(!l.includes(p)){h!==";"&&u++;var d=n.substring(c,u).trim();e+=" "+d+";"}}c=u+1,f=-1}}}}return i&&(e+=ia(i)),r&&(e+=ia(r,!0)),e=e.trim(),e===""?null:e}return n==null?null:String(n)}function Se(n,t,e,i,r,s){var a=n.__className;if(a!==e||a===void 0){var o=ah(e,i,s);o==null?n.removeAttribute("class"):t?n.className=o:n.setAttribute("class",o),n.__className=e}else if(s&&r!==s)for(var l in s){var c=!!s[l];(r==null||c!==!!r[l])&&n.classList.toggle(l,c)}return s}function Fr(n,t={},e,i){for(var r in e){var s=e[r];t[r]!==s&&(e[r]==null?n.style.removeProperty(r):n.style.setProperty(r,s,i))}}function ln(n,t,e,i){var r=n.__style;if(r!==t){var s=oh(t,i);s==null?n.removeAttribute("style"):n.style.cssText=s,n.__style=t}else i&&(Array.isArray(i)?(Fr(n,e?.[0],i[0]),Fr(n,e?.[1],i[1],"important")):Fr(n,e,i));return i}function rs(n,t,e=!1){if(n.multiple){if(t==null)return;if(!yr(t))return dc();for(var i of n.options)i.selected=t.includes(ra(i));return}for(i of n.options){var r=ra(i);if(Ac(r,t)){i.selected=!0;return}}(!e||t!==void 0)&&(n.selectedIndex=-1)}function lh(n){var t=new MutationObserver(()=>{rs(n,n.__value)});t.observe(n,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Er(()=>{t.disconnect()})}function ra(n){return"__value"in n?n.__value:n.value}const di=Symbol("class"),gi=Symbol("style"),Mo=Symbol("is custom element"),Io=Symbol("is html");function ch(n,t){t?n.hasAttribute("selected")||n.setAttribute("selected",""):n.removeAttribute("selected")}function ct(n,t,e,i){var r=Go(n);r[t]!==(r[t]=e)&&(t==="loading"&&(n[Wl]=e),e==null?n.removeAttribute(t):typeof e!="string"&&Fo(n).includes(t)?n[t]=e:n.setAttribute(t,e))}function hh(n,t,e,i,r=!1,s=!1){var a=Go(n),o=a[Mo],l=!a[Io],c=t||{},f=n.tagName==="OPTION";for(var u in t)u in e||(e[u]=null);e.class?e.class=hr(e.class):e[di]&&(e.class=null),e[gi]&&(e.style??=null);var h=Fo(n);for(const E in e){let A=e[E];if(f&&E==="value"&&A==null){n.value=n.__value="",c[E]=A;continue}if(E==="class"){var p=n.namespaceURI==="http://www.w3.org/1999/xhtml";Se(n,p,A,i,t?.[di],e[di]),c[E]=A,c[di]=e[di];continue}if(E==="style"){ln(n,A,t?.[gi],e[gi]),c[E]=A,c[gi]=e[gi];continue}var d=c[E];if(!(A===d&&!(A===void 0&&n.hasAttribute(E)))){c[E]=A;var w=E[0]+E[1];if(w!=="$$")if(w==="on"){const Y={},T="$$"+E;let R=E.slice(2);var g=Vc(R);if(Xc(R)&&(R=R.slice(0,-7),Y.capture=!0),!g&&d){if(A!=null)continue;n.removeEventListener(R,c[T],Y),c[T]=null}if(A!=null)if(g)n[`__${R}`]=A,Xi([R]);else{let W=function(z){c[E].call(this,z)};var I=W;c[T]=ys(R,n,W,Y)}else g&&(n[`__${R}`]=void 0)}else if(E==="style")ct(n,E,A);else if(E==="autofocus")co(n,!!A);else if(!o&&(E==="__value"||E==="value"&&A!=null))n.value=n.__value=A;else if(E==="selected"&&f)ch(n,A);else{var y=E;l||(y=zc(y));var L=y==="defaultValue"||y==="defaultChecked";if(A==null&&!o&&!L)if(a[E]=null,y==="value"||y==="checked"){let Y=n;const T=t===void 0;if(y==="value"){let R=Y.defaultValue;Y.removeAttribute(y),Y.defaultValue=R,Y.value=Y.__value=T?R:null}else{let R=Y.defaultChecked;Y.removeAttribute(y),Y.defaultChecked=R,Y.checked=T?R:!1}}else n.removeAttribute(E);else L||h.includes(y)&&(o||typeof A!="string")?(n[y]=A,y in a&&(a[y]=Gt)):typeof A!="function"&&ct(n,y,A)}}}return c}function Ee(n,t,e=[],i=[],r=[],s,a=!1,o=!1){to(r,e,i,l=>{var c=void 0,f={},u=n.nodeName==="SELECT",h=!1;if(go(()=>{var d=t(...l.map(v)),w=hh(n,c,d,s,a,o);h&&u&&"value"in d&&rs(n,d.value);for(let y of Object.getOwnPropertySymbols(f))d[y]||Ht(f[y]);for(let y of Object.getOwnPropertySymbols(d)){var g=d[y];y.description===uc&&(!c||g!==c[y])&&(f[y]&&Ht(f[y]),f[y]=$t(()=>rh(n,()=>g))),w[y]=g}c=w}),u){var p=n;_s(()=>{rs(p,c.value,!0),lh(p)})}h=!0})}function Go(n){return n.__attributes??={[Mo]:n.nodeName.includes("-"),[Io]:n.namespaceURI===fc}}var sa=new Map;function Fo(n){var t=n.getAttribute("is")||n.nodeName,e=sa.get(t);if(e)return e;sa.set(t,e=[]);for(var i,r=n,s=Element.prototype;s!==r;){i=Fa(r);for(var a in i)i[a].set&&e.push(a);r=us(r)}return e}function Ve(n,t,e=t){var i=new WeakSet;Dc(n,"input",async r=>{var s=r?n.defaultValue:n.value;if(s=Nr(n)?Br(s):s,e(s),rt!==null&&i.add(rt),await Hc(),s!==(s=t())){var a=n.selectionStart,o=n.selectionEnd,l=n.value.length;if(n.value=s??"",o!==null){var c=n.value.length;a===o&&o===l&&c>l?(n.selectionStart=c,n.selectionEnd=c):(n.selectionStart=a,n.selectionEnd=Math.min(o,c))}}}),$(t)==null&&n.value&&(e(Nr(n)?Br(n.value):n.value),rt!==null&&i.add(rt)),Yi(()=>{var r=t();if(n===document.activeElement){var s=cr??rt;if(i.has(s))return}Nr(n)&&r===Br(n.value)||n.type==="date"&&!r&&!n.value||r!==n.value&&(n.value=r??"")})}function Nr(n){var t=n.type;return t==="number"||t==="range"}function Br(n){return n===""?null:+n}function aa(n,t){return n===t||n?.[Je]===t}function Cs(n={},t,e,i){return _s(()=>{var r,s;return Yi(()=>{r=s,s=[],$(()=>{n!==e(...s)&&(t(n,...s),r&&aa(e(...r),n)&&t(null,...r))})}),()=>{On(()=>{s&&aa(e(...s),n)&&t(null,...s)})}}),n}function oa(n){return function(...t){var e=t[0];return e.preventDefault(),n?.apply(this,t)}}function No(n=!1){const t=ot,e=t.l.u;if(!e)return;let i=()=>S(t.s);if(n){let r=0,s={};const a=Bi(()=>{let o=!1;const l=t.s;for(const c in l)l[c]!==s[c]&&(s[c]=l[c],o=!0);return o&&r++,r});i=()=>v(a)}e.b.length&&Mc(()=>{la(t,i),Zr(e.b)}),M(()=>{const r=$(()=>e.m.map(Yl));return()=>{for(const s of r)typeof s=="function"&&s()}}),e.a.length&&M(()=>{la(t,i),Zr(e.a)})}function la(n,t){if(n.l.s)for(const e of n.l.s)v(e);t()}function Bo(n,t,e){if(n==null)return t(void 0),Ie;const i=$(()=>n.subscribe(t,e));return i.unsubscribe?()=>i.unsubscribe():i}const Un=[];function fh(n,t=Ie){let e=null;const i=new Set;function r(o){if(Va(n,o)&&(n=o,e)){const l=!Un.length;for(const c of i)c[1](),Un.push(c,n);if(l){for(let c=0;c<Un.length;c+=2)Un[c][0](Un[c+1]);Un.length=0}}}function s(o){r(o(n))}function a(o,l=Ie){const c=[o,l];return i.add(c),i.size===1&&(e=t(r,s)||Ie),o(n),()=>{i.delete(c),i.size===0&&e&&(e(),e=null)}}return{set:r,update:s,subscribe:a}}function uh(n){let t;return Bo(n,e=>t=e)(),t}let Ji=!1,ss=Symbol();function dh(n,t,e){const i=e[t]??={store:null,source:Ft(void 0),unsubscribe:Ie};if(i.store!==n&&!(ss in e))if(i.unsubscribe(),i.store=n??null,n==null)i.source.v=void 0,i.unsubscribe=Ie;else{var r=!0;i.unsubscribe=Bo(n,s=>{r?i.source.v=s:O(i.source,s)}),r=!1}return n&&ss in e?uh(n):v(i.source)}function gh(n,t,e){let i=e[t];return i&&i.store!==n&&(i.unsubscribe(),i.unsubscribe=Ie),n}function ph(){const n={};function t(){Er(()=>{for(var e in n)n[e].unsubscribe();Ga(n,ss,{enumerable:!1,value:!0})})}return[n,t]}function vh(n){var t=Ji;try{return Ji=!1,[n(),Ji]}finally{Ji=t}}const _h={get(n,t){if(!n.exclude.includes(t))return n.props[t]},set(n,t){return!1},getOwnPropertyDescriptor(n,t){if(!n.exclude.includes(t)&&t in n.props)return{enumerable:!0,configurable:!0,value:n.props[t]}},has(n,t){return n.exclude.includes(t)?!1:t in n.props},ownKeys(n){return Reflect.ownKeys(n.props).filter(t=>!n.exclude.includes(t))}};function Wt(n,t,e){return new Proxy({props:n,exclude:t},_h)}function b(n,t,e,i){var r=!ri||(e&sc)!==0,s=(e&oc)!==0,a=(e&lc)!==0,o=i,l=!0,c=()=>(l&&(l=!1,o=a?$(i):i),o),f;if(s){var u=Je in n||Xl in n;f=Zn(n,t)?.set??(u&&t in n?I=>n[t]=I:void 0)}var h,p=!1;s?[h,p]=vh(()=>n[t]):h=n[t],h===void 0&&i!==void 0&&(h=c(),f&&(r&&Kl(),f(h)));var d;if(r?d=()=>{var I=n[t];return I===void 0?c():(l=!0,I)}:d=()=>{var I=n[t];return I!==void 0&&(o=void 0),I===void 0?o:I},r&&(e&ac)===0)return d;if(f){var w=n.$$legacy;return(function(I,E){return arguments.length>0?((!r||!E||w||p)&&f(E?d():I),I):d()})}var g=!1,y=((e&rc)!==0?Bi:qt)(()=>(g=!1,d()));s&&v(y);var L=nt;return(function(I,E){if(arguments.length>0){const A=E?v(y):r&&s?De(I):I;return O(y,A),g=!0,o!==void 0&&(o=A),I}return Mn&&g||(L.f&Ke)!==0?y.v:v(y)})}function Ss(n){ot===null&&Sr(),ri&&ot.l!==null?bh(ot).m.push(n):M(()=>{const t=$(n);if(typeof t=="function")return t})}function In(n){ot===null&&Sr(),Ss(()=>()=>$(n))}function mh(n,t,{bubbles:e=!1,cancelable:i=!1}={}){return new CustomEvent(n,{detail:t,bubbles:e,cancelable:i})}function yh(){const n=ot;return n===null&&Sr(),(t,e,i)=>{const r=n.s.$$events?.[t];if(r){const s=yr(r)?r.slice():[r],a=mh(t,e,i);for(const o of s)o.call(n.x,a);return!a.defaultPrevented}return!0}}function bh(n){var t=n.l;return t.u??={a:[],b:[],m:[]}}const wh="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(wh);const Ch=Math.PI/180;function Sh(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}const xn=typeof global<"u"?global:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},D={_global:xn,version:"10.0.12",isBrowser:Sh(),isUnminified:/param/.test((function(n){}).toString()),dblClickWindow:400,getAngle(n){return D.angleDeg?n*Ch:n},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_renderBackend:"web",legacyTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return D.DD.isDragging},isTransforming(){var n,t;return(t=(n=D.Transformer)===null||n===void 0?void 0:n.isTransforming())!==null&&t!==void 0?t:!1},isDragReady(){return!!D.DD.node},releaseCanvasOnDestroy:!0,document:xn.document,_injectGlobal(n){typeof xn.Konva<"u"&&console.error("Several Konva instances detected. It is not recommended to use multiple Konva instances in the same environment."),xn.Konva=n}},tn=n=>{D[n.prototype.getClassName()]=n};D._injectGlobal(D);const xh=`Konva.js unsupported environment.

Looks like you are trying to use Konva.js in Node.js environment. because "document" object is undefined.

To use Konva.js in Node.js environment, you need to use the "canvas-backend" or "skia-backend" module.

bash: npm install canvas
js: import "konva/canvas-backend";

or

bash: npm install skia-canvas
js: import "konva/skia-backend";
`,ca=()=>{if(typeof document>"u")throw new Error(xh)};class cn{constructor(t=[1,0,0,1,0,0]){this.dirty=!1,this.m=t&&t.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new cn(this.m)}copyInto(t){t.m[0]=this.m[0],t.m[1]=this.m[1],t.m[2]=this.m[2],t.m[3]=this.m[3],t.m[4]=this.m[4],t.m[5]=this.m[5]}point(t){const e=this.m;return{x:e[0]*t.x+e[2]*t.y+e[4],y:e[1]*t.x+e[3]*t.y+e[5]}}translate(t,e){return this.m[4]+=this.m[0]*t+this.m[2]*e,this.m[5]+=this.m[1]*t+this.m[3]*e,this}scale(t,e){return this.m[0]*=t,this.m[1]*=t,this.m[2]*=e,this.m[3]*=e,this}rotate(t){const e=Math.cos(t),i=Math.sin(t),r=this.m[0]*e+this.m[2]*i,s=this.m[1]*e+this.m[3]*i,a=this.m[0]*-i+this.m[2]*e,o=this.m[1]*-i+this.m[3]*e;return this.m[0]=r,this.m[1]=s,this.m[2]=a,this.m[3]=o,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(t,e){const i=this.m[0]+this.m[2]*e,r=this.m[1]+this.m[3]*e,s=this.m[2]+this.m[0]*t,a=this.m[3]+this.m[1]*t;return this.m[0]=i,this.m[1]=r,this.m[2]=s,this.m[3]=a,this}multiply(t){const e=this.m[0]*t.m[0]+this.m[2]*t.m[1],i=this.m[1]*t.m[0]+this.m[3]*t.m[1],r=this.m[0]*t.m[2]+this.m[2]*t.m[3],s=this.m[1]*t.m[2]+this.m[3]*t.m[3],a=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],o=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5];return this.m[0]=e,this.m[1]=i,this.m[2]=r,this.m[3]=s,this.m[4]=a,this.m[5]=o,this}invert(){const t=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),e=this.m[3]*t,i=-this.m[1]*t,r=-this.m[2]*t,s=this.m[0]*t,a=t*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),o=t*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=e,this.m[1]=i,this.m[2]=r,this.m[3]=s,this.m[4]=a,this.m[5]=o,this}getMatrix(){return this.m}decompose(){const t=this.m[0],e=this.m[1],i=this.m[2],r=this.m[3],s=this.m[4],a=this.m[5],o=t*r-e*i,l={x:s,y:a,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(t!=0||e!=0){const c=Math.sqrt(t*t+e*e);l.rotation=e>0?Math.acos(t/c):-Math.acos(t/c),l.scaleX=c,l.scaleY=o/c,l.skewX=(t*i+e*r)/o,l.skewY=0}else if(i!=0||r!=0){const c=Math.sqrt(i*i+r*r);l.rotation=Math.PI/2-(r>0?Math.acos(-i/c):-Math.acos(i/c)),l.scaleX=o/c,l.scaleY=c,l.skewX=0,l.skewY=(t*i+e*r)/o}return l.rotation=_._getRotation(l.rotation),l}}const kh="[object Array]",Eh="[object Number]",Ph="[object String]",Ah="[object Boolean]",Th=Math.PI/180,Rh=180/Math.PI,pi="#",Lh="",Dh="0",Oh="Konva warning: ",ha="Konva error: ",Mh="rgb(",Hr={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},Ih=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let Zi=[],vi=null;const Gh=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(n){setTimeout(n,60)},_={_isElement(n){return!!(n&&n.nodeType==1)},_isFunction(n){return!!(n&&n.constructor&&n.call&&n.apply)},_isPlainObject(n){return!!n&&n.constructor===Object},_isArray(n){return Object.prototype.toString.call(n)===kh},_isNumber(n){return Object.prototype.toString.call(n)===Eh&&!isNaN(n)&&isFinite(n)},_isString(n){return Object.prototype.toString.call(n)===Ph},_isBoolean(n){return Object.prototype.toString.call(n)===Ah},isObject(n){return n instanceof Object},isValidSelector(n){if(typeof n!="string")return!1;const t=n[0];return t==="#"||t==="."||t===t.toUpperCase()},_sign(n){return n===0||n>0?1:-1},requestAnimFrame(n){Zi.push(n),Zi.length===1&&Gh(function(){const t=Zi;Zi=[],t.forEach(function(e){e()})})},createCanvasElement(){ca();const n=document.createElement("canvas");try{n.style=n.style||{}}catch{}return n},createImageElement(){return ca(),document.createElement("img")},_isInDocument(n){for(;n=n.parentNode;)if(n==document)return!0;return!1},_urlToImage(n,t){const e=_.createImageElement();e.onload=function(){t(e)},e.src=n},_rgbToHex(n,t,e){return((1<<24)+(n<<16)+(t<<8)+e).toString(16).slice(1)},_hexToRgb(n){n=n.replace(pi,Lh);const t=parseInt(n,16);return{r:t>>16&255,g:t>>8&255,b:t&255}},getRandomColor(){let n=(Math.random()*16777215<<0).toString(16);for(;n.length<6;)n=Dh+n;return pi+n},isCanvasFarblingActive(){if(vi!==null)return vi;if(typeof document>"u")return vi=!1,!1;const n=this.createCanvasElement();n.width=10,n.height=10;const t=n.getContext("2d",{willReadFrequently:!0});t.clearRect(0,0,10,10),t.fillStyle="#282828",t.fillRect(0,0,10,10);const e=t.getImageData(0,0,10,10).data;let i=!1;for(let r=0;r<100;r++)if(e[r*4]!==40||e[r*4+1]!==40||e[r*4+2]!==40||e[r*4+3]!==255){i=!0;break}return vi=i,this.releaseCanvas(n),vi},getHitColor(){const n=this.getRandomColor();return this.isCanvasFarblingActive()?this.getSnappedHexColor(n):n},getHitColorKey(n,t,e){return this.isCanvasFarblingActive()&&(n=Math.round(n/5)*5,t=Math.round(t/5)*5,e=Math.round(e/5)*5),pi+this._rgbToHex(n,t,e)},getSnappedHexColor(n){const t=this._hexToRgb(n);return pi+this._rgbToHex(Math.round(t.r/5)*5,Math.round(t.g/5)*5,Math.round(t.b/5)*5)},getRGB(n){let t;return n in Hr?(t=Hr[n],{r:t[0],g:t[1],b:t[2]}):n[0]===pi?this._hexToRgb(n.substring(1)):n.substr(0,4)===Mh?(t=Ih.exec(n.replace(/ /g,"")),{r:parseInt(t[1],10),g:parseInt(t[2],10),b:parseInt(t[3],10)}):{r:0,g:0,b:0}},colorToRGBA(n){return n=n||"black",_._namedColorToRBA(n)||_._hex3ColorToRGBA(n)||_._hex4ColorToRGBA(n)||_._hex6ColorToRGBA(n)||_._hex8ColorToRGBA(n)||_._rgbColorToRGBA(n)||_._rgbaColorToRGBA(n)||_._hslColorToRGBA(n)},_namedColorToRBA(n){const t=Hr[n.toLowerCase()];return t?{r:t[0],g:t[1],b:t[2],a:1}:null},_rgbColorToRGBA(n){if(n.indexOf("rgb(")===0){n=n.match(/rgb\(([^)]+)\)/)[1];const t=n.split(/ *, */).map(Number);return{r:t[0],g:t[1],b:t[2],a:1}}},_rgbaColorToRGBA(n){if(n.indexOf("rgba(")===0){n=n.match(/rgba\(([^)]+)\)/)[1];const t=n.split(/ *, */).map((e,i)=>e.slice(-1)==="%"?i===3?parseInt(e)/100:parseInt(e)/100*255:Number(e));return{r:t[0],g:t[1],b:t[2],a:t[3]}}},_hex8ColorToRGBA(n){if(n[0]==="#"&&n.length===9)return{r:parseInt(n.slice(1,3),16),g:parseInt(n.slice(3,5),16),b:parseInt(n.slice(5,7),16),a:parseInt(n.slice(7,9),16)/255}},_hex6ColorToRGBA(n){if(n[0]==="#"&&n.length===7)return{r:parseInt(n.slice(1,3),16),g:parseInt(n.slice(3,5),16),b:parseInt(n.slice(5,7),16),a:1}},_hex4ColorToRGBA(n){if(n[0]==="#"&&n.length===5)return{r:parseInt(n[1]+n[1],16),g:parseInt(n[2]+n[2],16),b:parseInt(n[3]+n[3],16),a:parseInt(n[4]+n[4],16)/255}},_hex3ColorToRGBA(n){if(n[0]==="#"&&n.length===4)return{r:parseInt(n[1]+n[1],16),g:parseInt(n[2]+n[2],16),b:parseInt(n[3]+n[3],16),a:1}},_hslColorToRGBA(n){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(n)){const[t,...e]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(n),i=Number(e[0])/360,r=Number(e[1])/100,s=Number(e[2])/100;let a,o,l;if(r===0)return l=s*255,{r:Math.round(l),g:Math.round(l),b:Math.round(l),a:1};s<.5?a=s*(1+r):a=s+r-s*r;const c=2*s-a,f=[0,0,0];for(let u=0;u<3;u++)o=i+1/3*-(u-1),o<0&&o++,o>1&&o--,6*o<1?l=c+(a-c)*6*o:2*o<1?l=a:3*o<2?l=c+(a-c)*(2/3-o)*6:l=c,f[u]=l*255;return{r:Math.round(f[0]),g:Math.round(f[1]),b:Math.round(f[2]),a:1}}},haveIntersection(n,t){return!(t.x>n.x+n.width||t.x+t.width<n.x||t.y>n.y+n.height||t.y+t.height<n.y)},cloneObject(n){const t={};for(const e in n)this._isPlainObject(n[e])?t[e]=this.cloneObject(n[e]):this._isArray(n[e])?t[e]=this.cloneArray(n[e]):t[e]=n[e];return t},cloneArray(n){return n.slice(0)},degToRad(n){return n*Th},radToDeg(n){return n*Rh},_degToRad(n){return _.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),_.degToRad(n)},_radToDeg(n){return _.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),_.radToDeg(n)},_getRotation(n){return D.angleDeg?_.radToDeg(n):n},_capitalize(n){return n.charAt(0).toUpperCase()+n.slice(1)},throw(n){throw new Error(ha+n)},error(n){console.error(ha+n)},warn(n){D.showWarnings&&console.warn(Oh+n)},each(n,t){for(const e in n)t(e,n[e])},_inRange(n,t,e){return t<=n&&n<e},_getProjectionToSegment(n,t,e,i,r,s){let a,o,l;const c=(n-e)*(n-e)+(t-i)*(t-i);if(c==0)a=n,o=t,l=(r-e)*(r-e)+(s-i)*(s-i);else{const f=((r-n)*(e-n)+(s-t)*(i-t))/c;f<0?(a=n,o=t,l=(n-r)*(n-r)+(t-s)*(t-s)):f>1?(a=e,o=i,l=(e-r)*(e-r)+(i-s)*(i-s)):(a=n+f*(e-n),o=t+f*(i-t),l=(a-r)*(a-r)+(o-s)*(o-s))}return[a,o,l]},_getProjectionToLine(n,t,e){const i=_.cloneObject(n);let r=Number.MAX_VALUE;return t.forEach(function(s,a){if(!e&&a===t.length-1)return;const o=t[(a+1)%t.length],l=_._getProjectionToSegment(s.x,s.y,o.x,o.y,n.x,n.y),c=l[0],f=l[1],u=l[2];u<r&&(i.x=c,i.y=f,r=u)}),i},_prepareArrayForTween(n,t,e){const i=[],r=[];if(n.length>t.length){const a=t;t=n,n=a}for(let a=0;a<n.length;a+=2)i.push({x:n[a],y:n[a+1]});for(let a=0;a<t.length;a+=2)r.push({x:t[a],y:t[a+1]});const s=[];return r.forEach(function(a){const o=_._getProjectionToLine(a,i,e);s.push(o.x),s.push(o.y)}),s},_prepareToStringify(n){let t;n.visitedByCircularReferenceRemoval=!0;for(const e in n)if(n.hasOwnProperty(e)&&n[e]&&typeof n[e]=="object"){if(t=Object.getOwnPropertyDescriptor(n,e),n[e].visitedByCircularReferenceRemoval||_._isElement(n[e]))if(t.configurable)delete n[e];else return null;else if(_._prepareToStringify(n[e])===null)if(t.configurable)delete n[e];else return null}return delete n.visitedByCircularReferenceRemoval,n},_assign(n,t){for(const e in t)n[e]=t[e];return n},_getFirstPointerId(n){return n.touches?n.changedTouches[0].identifier:n.pointerId||999},releaseCanvas(...n){D.releaseCanvasOnDestroy&&n.forEach(t=>{t.width=0,t.height=0})},drawRoundedRectPath(n,t,e,i){let r=t<0?t:0,s=e<0?e:0;t=Math.abs(t),e=Math.abs(e);let a=0,o=0,l=0,c=0;typeof i=="number"?a=o=l=c=Math.min(i,t/2,e/2):(a=Math.min(i[0]||0,t/2,e/2),o=Math.min(i[1]||0,t/2,e/2),c=Math.min(i[2]||0,t/2,e/2),l=Math.min(i[3]||0,t/2,e/2)),n.moveTo(r+a,s),n.lineTo(r+t-o,s),n.arc(r+t-o,s+o,o,Math.PI*3/2,0,!1),n.lineTo(r+t,s+e-c),n.arc(r+t-c,s+e-c,c,0,Math.PI/2,!1),n.lineTo(r+l,s+e),n.arc(r+l,s+e-l,l,Math.PI/2,Math.PI,!1),n.lineTo(r,s+a),n.arc(r+a,s+a,a,Math.PI,Math.PI*3/2,!1)},drawRoundedPolygonPath(n,t,e,i,r){i=Math.abs(i);for(let s=0;s<e;s++){const a=t[(s-1+e)%e],o=t[s],l=t[(s+1)%e],c={x:o.x-a.x,y:o.y-a.y},f={x:l.x-o.x,y:l.y-o.y},u=Math.hypot(c.x,c.y),h=Math.hypot(f.x,f.y);let p;typeof r=="number"?p=r:p=s<r.length?r[s]:0,p=i*Math.cos(Math.PI/e)*Math.min(1,p/i*2);const w={x:c.x/u,y:c.y/u},g={x:f.x/h,y:f.y/h},y={x:o.x-w.x*p,y:o.y-w.y*p},L={x:o.x+g.x*p,y:o.y+g.y*p};s===0?n.moveTo(y.x,y.y):n.lineTo(y.x,y.y),n.arcTo(o.x,o.y,L.x,L.y,p)}}};function Gn(n){return _._isString(n)?'"'+n+'"':Object.prototype.toString.call(n)==="[object Number]"||_._isBoolean(n)?n:Object.prototype.toString.call(n)}function K(){if(D.isUnminified)return function(n,t){return _._isNumber(n)||_.warn(Gn(n)+' is a not valid value for "'+t+'" attribute. The value should be a number.'),n}}function Fh(n){if(D.isUnminified)return function(t,e){let i=_._isNumber(t),r=_._isArray(t)&&t.length==n;return!i&&!r&&_.warn(Gn(t)+' is a not valid value for "'+e+'" attribute. The value should be a number or Array<number>('+n+")"),t}}function xs(){if(D.isUnminified)return function(n,t){return _._isNumber(n)||n==="auto"||_.warn(Gn(n)+' is a not valid value for "'+t+'" attribute. The value should be a number or "auto".'),n}}function Fn(){if(D.isUnminified)return function(n,t){return _._isString(n)||_.warn(Gn(n)+' is a not valid value for "'+t+'" attribute. The value should be a string.'),n}}function Ho(){if(D.isUnminified)return function(n,t){const e=_._isString(n),i=Object.prototype.toString.call(n)==="[object CanvasGradient]"||n&&n.addColorStop;return e||i||_.warn(Gn(n)+' is a not valid value for "'+t+'" attribute. The value should be a string or a native gradient.'),n}}function Be(){if(D.isUnminified)return function(n,t){return n===!0||n===!1||_.warn(Gn(n)+' is a not valid value for "'+t+'" attribute. The value should be a boolean.'),n}}function Nh(n){if(D.isUnminified)return function(t,e){return t==null||_.isObject(t)||_.warn(Gn(t)+' is a not valid value for "'+e+'" attribute. The value should be an object with properties '+n),t}}const _i="get",mi="set",C={addGetterSetter(n,t,e,i,r){C.addGetter(n,t,e),C.addSetter(n,t,i,r),C.addOverloadedGetterSetter(n,t)},addGetter(n,t,e){const i=_i+_._capitalize(t);n.prototype[i]=n.prototype[i]||function(){const r=this.attrs[t];return r===void 0?e:r}},addSetter(n,t,e,i){const r=mi+_._capitalize(t);n.prototype[r]||C.overWriteSetter(n,t,e,i)},overWriteSetter(n,t,e,i){const r=mi+_._capitalize(t);n.prototype[r]=function(s){return e&&s!==void 0&&s!==null&&(s=e.call(this,s,t)),this._setAttr(t,s),i&&i.call(this),this}},addComponentsGetterSetter(n,t,e,i,r){const s=e.length,a=_._capitalize,o=_i+a(t),l=mi+a(t);n.prototype[o]=function(){const f={};for(let u=0;u<s;u++){const h=e[u];f[h]=this.getAttr(t+a(h))}return f};const c=Nh(e);n.prototype[l]=function(f){const u=this.attrs[t];i&&(f=i.call(this,f,t)),c&&c.call(this,f,t);for(const h in f)f.hasOwnProperty(h)&&this._setAttr(t+a(h),f[h]);return f||e.forEach(h=>{this._setAttr(t+a(h),void 0)}),this._fireChangeEvent(t,u,f),r&&r.call(this),this},C.addOverloadedGetterSetter(n,t)},addOverloadedGetterSetter(n,t){const e=_._capitalize(t),i=mi+e,r=_i+e;n.prototype[t]=function(){return arguments.length?(this[i](arguments[0]),this):this[r]()}},addDeprecatedGetterSetter(n,t,e,i){_.error("Adding deprecated "+t);const r=_i+_._capitalize(t),s=t+" property is deprecated and will be removed soon. Look at Konva change log for more information.";n.prototype[r]=function(){_.error(s);const a=this.attrs[t];return a===void 0?e:a},C.addSetter(n,t,i,function(){_.error(s)}),C.addOverloadedGetterSetter(n,t)},backCompat(n,t){_.each(t,function(e,i){const r=n.prototype[i],s=_i+_._capitalize(e),a=mi+_._capitalize(e);function o(){r.apply(this,arguments),_.error('"'+e+'" method is deprecated and will be removed soon. Use ""'+i+'" instead.')}n.prototype[e]=o,n.prototype[s]=o,n.prototype[a]=o})},afterSetFilter(){this._filterUpToDate=!1}};function Bh(n){const t=[],e=n.length,i=_;for(let r=0;r<e;r++){let s=n[r];i._isNumber(s)?s=Math.round(s*1e3)/1e3:i._isString(s)||(s=s+""),t.push(s)}return t}const fa=",",Hh="(",Yh=")",Xh="([",Wh="])",Vh=";",Uh="()",zh="=",ua=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],jh=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled","filter"],qh=100;let Qi=null;function da(){if(Qi!==null)return Qi;try{const t=_.createCanvasElement().getContext("2d");return t?!!t&&"filter"in t:(Qi=!1,!1)}catch{return Qi=!1,!1}}class Ar{constructor(t){this.canvas=t,D.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(t){t.fillEnabled()&&this._fill(t)}_fill(t){}strokeShape(t){t.hasStroke()&&this._stroke(t)}_stroke(t){}fillStrokeShape(t){t.attrs.fillAfterStrokeEnabled?(this.strokeShape(t),this.fillShape(t)):(this.fillShape(t),this.strokeShape(t))}getTrace(t,e){let i=this.traceArr,r=i.length,s="",a,o,l,c;for(a=0;a<r;a++)o=i[a],l=o.method,l?(c=o.args,s+=l,t?s+=Uh:_._isArray(c[0])?s+=Xh+c.join(fa)+Wh:(e&&(c=c.map(f=>typeof f=="number"?Math.floor(f):f)),s+=Hh+c.join(fa)+Yh)):(s+=o.property,t||(s+=zh+o.val)),s+=Vh;return s}clearTrace(){this.traceArr=[]}_trace(t){let e=this.traceArr,i;e.push(t),i=e.length,i>=qh&&e.shift()}reset(){const t=this.getCanvas().getPixelRatio();this.setTransform(1*t,0,0,1*t,0,0)}getCanvas(){return this.canvas}clear(t){const e=this.getCanvas();t?this.clearRect(t.x||0,t.y||0,t.width||0,t.height||0):this.clearRect(0,0,e.getWidth()/e.pixelRatio,e.getHeight()/e.pixelRatio)}_applyLineCap(t){const e=t.attrs.lineCap;e&&this.setAttr("lineCap",e)}_applyOpacity(t){const e=t.getAbsoluteOpacity();e!==1&&this.setAttr("globalAlpha",e)}_applyLineJoin(t){const e=t.attrs.lineJoin;e&&this.setAttr("lineJoin",e)}_applyMiterLimit(t){const e=t.attrs.miterLimit;e!=null&&this.setAttr("miterLimit",e)}setAttr(t,e){this._context[t]=e}arc(t,e,i,r,s,a){this._context.arc(t,e,i,r,s,a)}arcTo(t,e,i,r,s){this._context.arcTo(t,e,i,r,s)}beginPath(){this._context.beginPath()}bezierCurveTo(t,e,i,r,s,a){this._context.bezierCurveTo(t,e,i,r,s,a)}clearRect(t,e,i,r){this._context.clearRect(t,e,i,r)}clip(...t){this._context.clip.apply(this._context,t)}closePath(){this._context.closePath()}createImageData(t,e){const i=arguments;if(i.length===2)return this._context.createImageData(t,e);if(i.length===1)return this._context.createImageData(t)}createLinearGradient(t,e,i,r){return this._context.createLinearGradient(t,e,i,r)}createPattern(t,e){return this._context.createPattern(t,e)}createRadialGradient(t,e,i,r,s,a){return this._context.createRadialGradient(t,e,i,r,s,a)}drawImage(t,e,i,r,s,a,o,l,c){const f=arguments,u=this._context;f.length===3?u.drawImage(t,e,i):f.length===5?u.drawImage(t,e,i,r,s):f.length===9&&u.drawImage(t,e,i,r,s,a,o,l,c)}ellipse(t,e,i,r,s,a,o,l){this._context.ellipse(t,e,i,r,s,a,o,l)}isPointInPath(t,e,i,r){return i?this._context.isPointInPath(i,t,e,r):this._context.isPointInPath(t,e,r)}fill(...t){this._context.fill.apply(this._context,t)}fillRect(t,e,i,r){this._context.fillRect(t,e,i,r)}strokeRect(t,e,i,r){this._context.strokeRect(t,e,i,r)}fillText(t,e,i,r){r?this._context.fillText(t,e,i,r):this._context.fillText(t,e,i)}measureText(t){return this._context.measureText(t)}getImageData(t,e,i,r){return this._context.getImageData(t,e,i,r)}lineTo(t,e){this._context.lineTo(t,e)}moveTo(t,e){this._context.moveTo(t,e)}rect(t,e,i,r){this._context.rect(t,e,i,r)}roundRect(t,e,i,r,s){this._context.roundRect(t,e,i,r,s)}putImageData(t,e,i){this._context.putImageData(t,e,i)}quadraticCurveTo(t,e,i,r){this._context.quadraticCurveTo(t,e,i,r)}restore(){this._context.restore()}rotate(t){this._context.rotate(t)}save(){this._context.save()}scale(t,e){this._context.scale(t,e)}setLineDash(t){this._context.setLineDash?this._context.setLineDash(t):"mozDash"in this._context?this._context.mozDash=t:"webkitLineDash"in this._context&&(this._context.webkitLineDash=t)}getLineDash(){return this._context.getLineDash()}setTransform(t,e,i,r,s,a){this._context.setTransform(t,e,i,r,s,a)}stroke(t){t?this._context.stroke(t):this._context.stroke()}strokeText(t,e,i,r){this._context.strokeText(t,e,i,r)}transform(t,e,i,r,s,a){this._context.transform(t,e,i,r,s,a)}translate(t,e){this._context.translate(t,e)}_enableTrace(){let t=this,e=ua.length,i=this.setAttr,r,s;const a=function(o){let l=t[o],c;t[o]=function(){return s=Bh(Array.prototype.slice.call(arguments,0)),c=l.apply(t,arguments),t._trace({method:o,args:s}),c}};for(r=0;r<e;r++)a(ua[r]);t.setAttr=function(){i.apply(t,arguments);const o=arguments[0];let l=arguments[1];(o==="shadowOffsetX"||o==="shadowOffsetY"||o==="shadowBlur")&&(l=l/this.canvas.getPixelRatio()),t._trace({property:o,val:l})}}_applyGlobalCompositeOperation(t){const e=t.attrs.globalCompositeOperation;!e||e==="source-over"||this.setAttr("globalCompositeOperation",e)}}jh.forEach(function(n){Object.defineProperty(Ar.prototype,n,{get(){return this._context[n]},set(t){this._context[n]=t}})});class Kh extends Ar{constructor(t,{willReadFrequently:e=!1}={}){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:e})}_fillColor(t){const e=t.fill();this.setAttr("fillStyle",e),t._fillFunc(this)}_fillPattern(t){this.setAttr("fillStyle",t._getFillPattern()),t._fillFunc(this)}_fillLinearGradient(t){const e=t._getLinearGradient();e&&(this.setAttr("fillStyle",e),t._fillFunc(this))}_fillRadialGradient(t){const e=t._getRadialGradient();e&&(this.setAttr("fillStyle",e),t._fillFunc(this))}_fill(t){const e=t.fill(),i=t.getFillPriority();if(e&&i==="color"){this._fillColor(t);return}const r=t.getFillPatternImage();if(r&&i==="pattern"){this._fillPattern(t);return}const s=t.getFillLinearGradientColorStops();if(s&&i==="linear-gradient"){this._fillLinearGradient(t);return}const a=t.getFillRadialGradientColorStops();if(a&&i==="radial-gradient"){this._fillRadialGradient(t);return}e?this._fillColor(t):r?this._fillPattern(t):s?this._fillLinearGradient(t):a&&this._fillRadialGradient(t)}_strokeLinearGradient(t){const e=t.getStrokeLinearGradientStartPoint(),i=t.getStrokeLinearGradientEndPoint(),r=t.getStrokeLinearGradientColorStops(),s=this.createLinearGradient(e.x,e.y,i.x,i.y);if(r){for(let a=0;a<r.length;a+=2)s.addColorStop(r[a],r[a+1]);this.setAttr("strokeStyle",s)}}_stroke(t){const e=t.dash(),i=t.getStrokeScaleEnabled();if(t.hasStroke()){if(!i){this.save();const s=this.getCanvas().getPixelRatio();this.setTransform(s,0,0,s,0,0)}this._applyLineCap(t),e&&t.dashEnabled()&&(this.setLineDash(e),this.setAttr("lineDashOffset",t.dashOffset())),this.setAttr("lineWidth",t.strokeWidth()),t.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),t.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(t):this.setAttr("strokeStyle",t.stroke()),t._strokeFunc(this),i||this.restore()}}_applyShadow(t){var e,i,r;const s=(e=t.getShadowRGBA())!==null&&e!==void 0?e:"black",a=(i=t.getShadowBlur())!==null&&i!==void 0?i:5,o=(r=t.getShadowOffset())!==null&&r!==void 0?r:{x:0,y:0},l=t.getAbsoluteScale(),c=this.canvas.getPixelRatio(),f=l.x*c,u=l.y*c;this.setAttr("shadowColor",s),this.setAttr("shadowBlur",a*Math.min(Math.abs(f),Math.abs(u))),this.setAttr("shadowOffsetX",o.x*f),this.setAttr("shadowOffsetY",o.y*u)}}class Jh extends Ar{constructor(t){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:!0})}_fill(t){this.save(),this.setAttr("fillStyle",t.colorKey),t._fillFuncHit(this),this.restore()}strokeShape(t){t.hasHitStroke()&&this._stroke(t)}_stroke(t){if(t.hasHitStroke()){const e=t.getStrokeScaleEnabled();if(!e){this.save();const s=this.getCanvas().getPixelRatio();this.setTransform(s,0,0,s,0,0)}this._applyLineCap(t);const i=t.hitStrokeWidth(),r=i==="auto"?t.strokeWidth():i;this.setAttr("lineWidth",r),this.setAttr("strokeStyle",t.colorKey),t._strokeFuncHit(this),e||this.restore()}}}let $i;function Zh(){if($i)return $i;const n=_.createCanvasElement(),t=n.getContext("2d");return $i=(function(){const e=D._global.devicePixelRatio||1,i=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return e/i})(),_.releaseCanvas(n),$i}class ks{constructor(t){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const i=(t||{}).pixelRatio||D.pixelRatio||Zh();this.pixelRatio=i,this._canvas=_.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(t){const e=this.pixelRatio;this.pixelRatio=t,this.setSize(this.getWidth()/e,this.getHeight()/e)}setWidth(t){this.width=this._canvas.width=t*this.pixelRatio,this._canvas.style.width=t+"px";const e=this.pixelRatio;this.getContext()._context.scale(e,e)}setHeight(t){this.height=this._canvas.height=t*this.pixelRatio,this._canvas.style.height=t+"px";const e=this.pixelRatio;this.getContext()._context.scale(e,e)}getWidth(){return this.width}getHeight(){return this.height}setSize(t,e){this.setWidth(t||0),this.setHeight(e||0)}toDataURL(t,e){try{return this._canvas.toDataURL(t,e)}catch{try{return this._canvas.toDataURL()}catch(r){return _.error("Unable to get data URL. "+r.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}class on extends ks{constructor(t={width:0,height:0,willReadFrequently:!1}){super(t),this.context=new Kh(this,{willReadFrequently:t.willReadFrequently}),this.setSize(t.width,t.height)}}class Es extends ks{constructor(t={width:0,height:0}){super(t),this.hitCanvas=!0,this.context=new Jh(this),this.setSize(t.width,t.height)}}const et={get isDragging(){let n=!1;return et._dragElements.forEach(t=>{t.dragStatus==="dragging"&&(n=!0)}),n},justDragged:!1,get node(){let n;return et._dragElements.forEach(t=>{n=t.node}),n},_dragElements:new Map,_drag(n){const t=[];et._dragElements.forEach((e,i)=>{const{node:r}=e,s=r.getStage();s.setPointersPositions(n),e.pointerId===void 0&&(e.pointerId=_._getFirstPointerId(n));const a=s._changedPointerPositions.find(o=>o.id===e.pointerId);if(a){if(e.dragStatus!=="dragging"){const o=r.dragDistance();if(Math.max(Math.abs(a.x-e.startPointerPos.x),Math.abs(a.y-e.startPointerPos.y))<o||(r.startDrag({evt:n}),!r.isDragging()))return}r._setDragPosition(n,e),t.push(r)}}),t.forEach(e=>{e.fire("dragmove",{type:"dragmove",target:e,evt:n},!0)})},_endDragBefore(n){const t=[];et._dragElements.forEach(e=>{const{node:i}=e,r=i.getStage();if(n&&r.setPointersPositions(n),!r._changedPointerPositions.find(o=>o.id===e.pointerId))return;(e.dragStatus==="dragging"||e.dragStatus==="stopped")&&(et.justDragged=!0,D._mouseListenClick=!1,D._touchListenClick=!1,D._pointerListenClick=!1,e.dragStatus="stopped");const a=e.node.getLayer()||e.node instanceof D.Stage&&e.node;a&&t.indexOf(a)===-1&&t.push(a)}),t.forEach(e=>{e.draw()})},_endDragAfter(n){et._dragElements.forEach((t,e)=>{t.dragStatus==="stopped"&&t.node.fire("dragend",{type:"dragend",target:t.node,evt:n},!0),t.dragStatus!=="dragging"&&et._dragElements.delete(e)})}};D.isBrowser&&(window.addEventListener("mouseup",et._endDragBefore,!0),window.addEventListener("touchend",et._endDragBefore,!0),window.addEventListener("touchcancel",et._endDragBefore,!0),window.addEventListener("mousemove",et._drag),window.addEventListener("touchmove",et._drag),window.addEventListener("mouseup",et._endDragAfter,!1),window.addEventListener("touchend",et._endDragAfter,!1),window.addEventListener("touchcancel",et._endDragAfter,!1));function Qh(n){const t=/(\w+)\(([^)]+)\)/g;let e;for(;(e=t.exec(n))!==null;){const[,i,r]=e;switch(i){case"blur":{const s=parseFloat(r.replace("px",""));return function(a){this.blurRadius(s*.5);const o=D.Filters;o&&o.Blur&&o.Blur.call(this,a)}}case"brightness":{const s=r.includes("%")?parseFloat(r)/100:parseFloat(r);return function(a){this.brightness(s);const o=D.Filters;o&&o.Brightness&&o.Brightness.call(this,a)}}case"contrast":{const s=parseFloat(r);return function(a){const o=100*(Math.sqrt(s)-1);this.contrast(o);const l=D.Filters;l&&l.Contrast&&l.Contrast.call(this,a)}}case"grayscale":return function(s){const a=D.Filters;a&&a.Grayscale&&a.Grayscale.call(this,s)};case"sepia":return function(s){const a=D.Filters;a&&a.Sepia&&a.Sepia.call(this,s)};case"invert":return function(s){const a=D.Filters;a&&a.Invert&&a.Invert.call(this,s)};default:_.warn(`CSS filter "${i}" is not supported in fallback mode. Consider using function filters for better compatibility.`);break}}return()=>{}}const fr="absoluteOpacity",tr="allEventListeners",Ue="absoluteTransform",ga="absoluteScale",yn="canvas",$h="Change",tf="children",ef="konva",as="listening",nf="mouseenter",rf="mouseleave",sf="pointerenter",af="pointerleave",of="touchenter",lf="touchleave",pa="set",va="Shape",ur=" ",_a="stage",an="transform",cf="Stage",os="visible",hf=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(ur);let ff=1,B=class ls{constructor(t){this._id=ff++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(t),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(t){(t===an||t===Ue)&&this._cache.get(t)?this._cache.get(t).dirty=!0:t?this._cache.delete(t):this._cache.clear()}_getCache(t,e){let i=this._cache.get(t);return(i===void 0||(t===an||t===Ue)&&i.dirty===!0)&&(i=e.call(this),this._cache.set(t,i)),i}_calculate(t,e,i){if(!this._attachedDepsListeners.get(t)){const r=e.map(s=>s+"Change.konva").join(ur);this.on(r,()=>{this._clearCache(t)}),this._attachedDepsListeners.set(t,!0)}return this._getCache(t,i)}_getCanvasCache(){return this._cache.get(yn)}_clearSelfAndDescendantCache(t){this._clearCache(t),t===Ue&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(yn)){const{scene:t,filter:e,hit:i,buffer:r}=this._cache.get(yn);_.releaseCanvas(t,e,i,r),this._cache.delete(yn)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(t){const e=t||{};let i={};(e.x===void 0||e.y===void 0||e.width===void 0||e.height===void 0)&&(i=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let r=Math.ceil(e.width||i.width),s=Math.ceil(e.height||i.height),a=e.pixelRatio,o=e.x===void 0?Math.floor(i.x):e.x,l=e.y===void 0?Math.floor(i.y):e.y,c=e.offset||0,f=e.drawBorder||!1,u=e.hitCanvasPixelRatio||1;if(!r||!s){_.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const h=Math.abs(Math.round(i.x)-o)>.5?1:0,p=Math.abs(Math.round(i.y)-l)>.5?1:0;r+=c*2+h,s+=c*2+p,o-=c,l-=c;const d=new on({pixelRatio:a,width:r,height:s}),w=new on({pixelRatio:a,width:0,height:0,willReadFrequently:!0}),g=new Es({pixelRatio:u,width:r,height:s}),y=d.getContext(),L=g.getContext(),I=new on({width:d.width/d.pixelRatio+Math.abs(o),height:d.height/d.pixelRatio+Math.abs(l),pixelRatio:d.pixelRatio}),E=I.getContext();return g.isCache=!0,d.isCache=!0,this._cache.delete(yn),this._filterUpToDate=!1,e.imageSmoothingEnabled===!1&&(d.getContext()._context.imageSmoothingEnabled=!1,w.getContext()._context.imageSmoothingEnabled=!1),y.save(),L.save(),E.save(),y.translate(-o,-l),L.translate(-o,-l),E.translate(-o,-l),I.x=o,I.y=l,this._isUnderCache=!0,this._clearSelfAndDescendantCache(fr),this._clearSelfAndDescendantCache(ga),this.drawScene(d,this,I),this.drawHit(g,this),this._isUnderCache=!1,y.restore(),L.restore(),f&&(y.save(),y.beginPath(),y.rect(0,0,r,s),y.closePath(),y.setAttr("strokeStyle","red"),y.setAttr("lineWidth",5),y.stroke(),y.restore()),this._cache.set(yn,{scene:d,filter:w,hit:g,buffer:I,x:o,y:l}),this._requestDraw(),this}isCached(){return this._cache.has(yn)}getClientRect(t){throw new Error('abstract "getClientRect" method call')}_transformedRect(t,e){const i=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}];let r=1/0,s=1/0,a=-1/0,o=-1/0;const l=this.getAbsoluteTransform(e);return i.forEach(function(c){const f=l.point(c);r===void 0&&(r=a=f.x,s=o=f.y),r=Math.min(r,f.x),s=Math.min(s,f.y),a=Math.max(a,f.x),o=Math.max(o,f.y)}),{x:r,y:s,width:a-r,height:o-s}}_drawCachedSceneCanvas(t){t.save(),t._applyOpacity(this),t._applyGlobalCompositeOperation(this);const e=this._getCanvasCache();t.translate(e.x,e.y);const i=this._getCachedSceneCanvas(),r=i.pixelRatio;t.drawImage(i._canvas,0,0,i.width/r,i.height/r),t.restore()}_drawCachedHitCanvas(t){const e=this._getCanvasCache(),i=e.hit;t.save(),t.translate(e.x,e.y),t.drawImage(i._canvas,0,0,i.width/i.pixelRatio,i.height/i.pixelRatio),t.restore()}_getCachedSceneCanvas(){let t=this.filters(),e=this._getCanvasCache(),i=e.scene,r=e.filter,s=r.getContext(),a,o,l,c;if(!t||t.length===0)return i;if(this._filterUpToDate)return r;let f=!0;for(let h=0;h<t.length;h++)if(typeof t[h]=="string"&&da(),typeof t[h]!="string"||!da()){f=!1;break}const u=i.pixelRatio;if(r.setSize(i.width/i.pixelRatio,i.height/i.pixelRatio),f){const h=t.join(" ");return s.save(),s.setAttr("filter",h),s.drawImage(i._canvas,0,0,i.getWidth()/u,i.getHeight()/u),s.restore(),this._filterUpToDate=!0,r}try{for(a=t.length,s.clear(),s.drawImage(i._canvas,0,0,i.getWidth()/u,i.getHeight()/u),o=s.getImageData(0,0,r.getWidth(),r.getHeight()),l=0;l<a;l++)c=t[l],typeof c=="string"&&(c=Qh(c)),c.call(this,o),s.putImageData(o,0,0)}catch(h){_.error("Unable to apply filter. "+h.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}return this._filterUpToDate=!0,r}on(t,e){if(this._cache&&this._cache.delete(tr),arguments.length===3)return this._delegate.apply(this,arguments);const i=t.split(ur);for(let r=0;r<i.length;r++){const a=i[r].split("."),o=a[0],l=a[1]||"";this.eventListeners[o]||(this.eventListeners[o]=[]),this.eventListeners[o].push({name:l,handler:e})}return this}off(t,e){let i=(t||"").split(ur),r=i.length,s,a,o,l,c,f;if(this._cache&&this._cache.delete(tr),!t)for(a in this.eventListeners)this._off(a);for(s=0;s<r;s++)if(o=i[s],l=o.split("."),c=l[0],f=l[1],c)this.eventListeners[c]&&this._off(c,f,e);else for(a in this.eventListeners)this._off(a,f,e);return this}dispatchEvent(t){const e={target:this,type:t.type,evt:t};return this.fire(t.type,e),this}addEventListener(t,e){return this.on(t,function(i){e.call(this,i.evt)}),this}removeEventListener(t){return this.off(t),this}_delegate(t,e,i){const r=this;this.on(t,function(s){const a=s.target.findAncestors(e,!0,r);for(let o=0;o<a.length;o++)s=_.cloneObject(s),s.currentTarget=a[o],i.call(a[o],s)})}remove(){return this.isDragging()&&this.stopDrag(),et._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(Ue),this._clearSelfAndDescendantCache(fr),this._clearSelfAndDescendantCache(ga),this._clearSelfAndDescendantCache(_a),this._clearSelfAndDescendantCache(os),this._clearSelfAndDescendantCache(as)}_remove(){this._clearCaches();const t=this.getParent();t&&t.children&&(t.children.splice(this.index,1),t._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(t){const e="get"+_._capitalize(t);return _._isFunction(this[e])?this[e]():this.attrs[t]}getAncestors(){let t=this.getParent(),e=[];for(;t;)e.push(t),t=t.getParent();return e}getAttrs(){return this.attrs||{}}setAttrs(t){return this._batchTransformChanges(()=>{let e,i;if(!t)return this;for(e in t)e!==tf&&(i=pa+_._capitalize(e),_._isFunction(this[i])?this[i](t[e]):this._setAttr(e,t[e]))}),this}isListening(){return this._getCache(as,this._isListening)}_isListening(t){if(!this.listening())return!1;const i=this.getParent();return i&&i!==t&&this!==t?i._isListening(t):!0}isVisible(){return this._getCache(os,this._isVisible)}_isVisible(t){if(!this.visible())return!1;const i=this.getParent();return i&&i!==t&&this!==t?i._isVisible(t):!0}shouldDrawHit(t,e=!1){if(t)return this._isVisible(t)&&this._isListening(t);const i=this.getLayer();let r=!1;et._dragElements.forEach(a=>{a.dragStatus==="dragging"&&(a.node.nodeType==="Stage"||a.node.getLayer()===i)&&(r=!0)});const s=!e&&!D.hitOnDragEnabled&&(r||D.isTransforming());return this.isListening()&&this.isVisible()&&!s}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let t=this.getDepth(),e=this,i=0,r,s,a,o;function l(f){for(r=[],s=f.length,a=0;a<s;a++)o=f[a],i++,o.nodeType!==va&&(r=r.concat(o.getChildren().slice())),o._id===e._id&&(a=s);r.length>0&&r[0].getDepth()<=t&&l(r)}const c=this.getStage();return e.nodeType!==cf&&c&&l(c.getChildren()),i}getDepth(){let t=0,e=this.parent;for(;e;)t++,e=e.parent;return t}_batchTransformChanges(t){this._batchingTransformChange=!0,t(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(an),this._clearSelfAndDescendantCache(Ue)),this._needClearTransformCache=!1}setPosition(t){return this._batchTransformChanges(()=>{this.x(t.x),this.y(t.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const t=this.getStage();if(!t)return null;const e=t.getPointerPosition();if(!e)return null;const i=this.getAbsoluteTransform().copy();return i.invert(),i.point(e)}getAbsolutePosition(t){let e=!1,i=this.parent;for(;i;){if(i.isCached()){e=!0;break}i=i.parent}e&&!t&&(t=!0);const r=this.getAbsoluteTransform(t).getMatrix(),s=new cn,a=this.offset();return s.m=r.slice(),s.translate(a.x,a.y),s.getTranslation()}setAbsolutePosition(t){const{x:e,y:i,...r}=this._clearTransform();this.attrs.x=e,this.attrs.y=i,this._clearCache(an);const s=this._getAbsoluteTransform().copy();return s.invert(),s.translate(t.x,t.y),t={x:this.attrs.x+s.getTranslation().x,y:this.attrs.y+s.getTranslation().y},this._setTransform(r),this.setPosition({x:t.x,y:t.y}),this._clearCache(an),this._clearSelfAndDescendantCache(Ue),this}_setTransform(t){let e;for(e in t)this.attrs[e]=t[e]}_clearTransform(){const t={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,t}move(t){let e=t.x,i=t.y,r=this.x(),s=this.y();return e!==void 0&&(r+=e),i!==void 0&&(s+=i),this.setPosition({x:r,y:s}),this}_eachAncestorReverse(t,e){let i=[],r=this.getParent(),s,a;if(!(e&&e._id===this._id)){for(i.unshift(this);r&&(!e||r._id!==e._id);)i.unshift(r),r=r.parent;for(s=i.length,a=0;a<s;a++)t(i[a])}}rotate(t){return this.rotation(this.rotation()+t),this}moveToTop(){if(!this.parent)return _.warn("Node has no parent. moveToTop function is ignored."),!1;const t=this.index,e=this.parent.getChildren().length;return t<e-1?(this.parent.children.splice(t,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return _.warn("Node has no parent. moveUp function is ignored."),!1;const t=this.index,e=this.parent.getChildren().length;return t<e-1?(this.parent.children.splice(t,1),this.parent.children.splice(t+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return _.warn("Node has no parent. moveDown function is ignored."),!1;const t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.splice(t-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return _.warn("Node has no parent. moveToBottom function is ignored."),!1;const t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(t){if(!this.parent)return _.warn("Node has no parent. zIndex parameter is ignored."),this;(t<0||t>=this.parent.children.length)&&_.warn("Unexpected value "+t+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const e=this.index;return this.parent.children.splice(e,1),this.parent.children.splice(t,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(fr,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let t=this.opacity();const e=this.getParent();return e&&!e._isUnderCache&&(t*=e.getAbsoluteOpacity()),t}moveTo(t){return this.getParent()!==t&&(this._remove(),t.add(this)),this}toObject(){let t=this.getAttrs(),e,i,r,s,a;const o={attrs:{},className:this.getClassName()};for(e in t)i=t[e],a=_.isObject(i)&&!_._isPlainObject(i)&&!_._isArray(i),!a&&(r=typeof this[e]=="function"&&this[e],delete t[e],s=r?r.call(this):null,t[e]=i,s!==i&&(o.attrs[e]=i));return _._prepareToStringify(o)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(t,e,i){const r=[];e&&this._isMatch(t)&&r.push(this);let s=this.parent;for(;s;){if(s===i)return r;s._isMatch(t)&&r.push(s),s=s.parent}return r}isAncestorOf(t){return!1}findAncestor(t,e,i){return this.findAncestors(t,e,i)[0]}_isMatch(t){if(!t)return!1;if(typeof t=="function")return t(this);let e=t.replace(/ /g,"").split(","),i=e.length,r,s;for(r=0;r<i;r++)if(s=e[r],_.isValidSelector(s)||(_.warn('Selector "'+s+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),_.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),_.warn("Konva is awesome, right?")),s.charAt(0)==="#"){if(this.id()===s.slice(1))return!0}else if(s.charAt(0)==="."){if(this.hasName(s.slice(1)))return!0}else if(this.className===s||this.nodeType===s)return!0;return!1}getLayer(){const t=this.getParent();return t?t.getLayer():null}getStage(){return this._getCache(_a,this._getStage)}_getStage(){const t=this.getParent();return t?t.getStage():null}fire(t,e={},i){return e.target=e.target||this,i?this._fireAndBubble(t,e):this._fire(t,e),this}getAbsoluteTransform(t){return t?this._getAbsoluteTransform(t):this._getCache(Ue,this._getAbsoluteTransform)}_getAbsoluteTransform(t){let e;if(t)return e=new cn,this._eachAncestorReverse(function(i){const r=i.transformsEnabled();r==="all"?e.multiply(i.getTransform()):r==="position"&&e.translate(i.x()-i.offsetX(),i.y()-i.offsetY())},t),e;{e=this._cache.get(Ue)||new cn,this.parent?this.parent.getAbsoluteTransform().copyInto(e):e.reset();const i=this.transformsEnabled();if(i==="all")e.multiply(this.getTransform());else if(i==="position"){const r=this.attrs.x||0,s=this.attrs.y||0,a=this.attrs.offsetX||0,o=this.attrs.offsetY||0;e.translate(r-a,s-o)}return e.dirty=!1,e}}getAbsoluteScale(t){let e=this;for(;e;)e._isUnderCache&&(t=e),e=e.getParent();const r=this.getAbsoluteTransform(t).decompose();return{x:r.scaleX,y:r.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(an,this._getTransform)}_getTransform(){var t,e;const i=this._cache.get(an)||new cn;i.reset();const r=this.x(),s=this.y(),a=D.getAngle(this.rotation()),o=(t=this.attrs.scaleX)!==null&&t!==void 0?t:1,l=(e=this.attrs.scaleY)!==null&&e!==void 0?e:1,c=this.attrs.skewX||0,f=this.attrs.skewY||0,u=this.attrs.offsetX||0,h=this.attrs.offsetY||0;return(r!==0||s!==0)&&i.translate(r,s),a!==0&&i.rotate(a),(c!==0||f!==0)&&i.skew(c,f),(o!==1||l!==1)&&i.scale(o,l),(u!==0||h!==0)&&i.translate(-1*u,-1*h),i.dirty=!1,i}clone(t){let e=_.cloneObject(this.attrs),i,r,s,a,o;for(i in t)e[i]=t[i];const l=new this.constructor(e);for(i in this.eventListeners)for(r=this.eventListeners[i],s=r.length,a=0;a<s;a++)o=r[a],o.name.indexOf(ef)<0&&(l.eventListeners[i]||(l.eventListeners[i]=[]),l.eventListeners[i].push(o));return l}_toKonvaCanvas(t){t=t||{};const e=this.getClientRect(),i=this.getStage(),r=t.x!==void 0?t.x:Math.floor(e.x),s=t.y!==void 0?t.y:Math.floor(e.y),a=t.pixelRatio||1,o=new on({width:t.width||Math.ceil(e.width)||(i?i.width():0),height:t.height||Math.ceil(e.height)||(i?i.height():0),pixelRatio:a}),l=o.getContext(),c=new on({width:o.width/o.pixelRatio+Math.abs(r),height:o.height/o.pixelRatio+Math.abs(s),pixelRatio:o.pixelRatio});return t.imageSmoothingEnabled===!1&&(l._context.imageSmoothingEnabled=!1),l.save(),(r||s)&&l.translate(-1*r,-1*s),this.drawScene(o,void 0,c),l.restore(),o}toCanvas(t){return this._toKonvaCanvas(t)._canvas}toDataURL(t){t=t||{};const e=t.mimeType||null,i=t.quality||null,r=this._toKonvaCanvas(t).toDataURL(e,i);return t.callback&&t.callback(r),r}toImage(t){return new Promise((e,i)=>{try{const r=t?.callback;r&&delete t.callback,_._urlToImage(this.toDataURL(t),function(s){e(s),r?.(s)})}catch(r){i(r)}})}toBlob(t){return new Promise((e,i)=>{try{const r=t?.callback;r&&delete t.callback,this.toCanvas(t).toBlob(s=>{e(s),r?.(s)},t?.mimeType,t?.quality)}catch(r){i(r)}})}setSize(t){return this.width(t.width),this.height(t.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():D.dragDistance}_off(t,e,i){let r=this.eventListeners[t],s,a,o;for(s=0;s<r.length;s++)if(a=r[s].name,o=r[s].handler,(a!=="konva"||e==="konva")&&(!e||a===e)&&(!i||i===o)){if(r.splice(s,1),r.length===0){delete this.eventListeners[t];break}s--}}_fireChangeEvent(t,e,i){this._fire(t+$h,{oldVal:e,newVal:i})}addName(t){if(!this.hasName(t)){const e=this.name(),i=e?e+" "+t:t;this.name(i)}return this}hasName(t){if(!t)return!1;const e=this.name();return e?(e||"").split(/\s/g).indexOf(t)!==-1:!1}removeName(t){const e=(this.name()||"").split(/\s/g),i=e.indexOf(t);return i!==-1&&(e.splice(i,1),this.name(e.join(" "))),this}setAttr(t,e){const i=this[pa+_._capitalize(t)];return _._isFunction(i)?i.call(this,e):this._setAttr(t,e),this}_requestDraw(){if(D.autoDrawEnabled){const t=this.getLayer()||this.getStage();t?.batchDraw()}}_setAttr(t,e){const i=this.attrs[t];i===e&&!_.isObject(e)||(e==null?delete this.attrs[t]:this.attrs[t]=e,this._shouldFireChangeEvents&&this._fireChangeEvent(t,i,e),this._requestDraw())}_setComponentAttr(t,e,i){let r;i!==void 0&&(r=this.attrs[t],r||(this.attrs[t]=this.getAttr(t)),this.attrs[t][e]=i,this._fireChangeEvent(t,r,i))}_fireAndBubble(t,e,i){e&&this.nodeType===va&&(e.target=this);const r=[nf,rf,sf,af,of,lf];if(!(r.indexOf(t)!==-1&&(i&&(this===i||this.isAncestorOf&&this.isAncestorOf(i))||this.nodeType==="Stage"&&!i))){this._fire(t,e);const a=r.indexOf(t)!==-1&&i&&i.isAncestorOf&&i.isAncestorOf(this)&&!i.isAncestorOf(this.parent);(e&&!e.cancelBubble||!e)&&this.parent&&this.parent.isListening()&&!a&&(i&&i.parent?this._fireAndBubble.call(this.parent,t,e,i):this._fireAndBubble.call(this.parent,t,e))}}_getProtoListeners(t){var e,i,r;const s=(e=this._cache.get(tr))!==null&&e!==void 0?e:{};let a=s?.[t];if(a===void 0){a=[];let o=Object.getPrototypeOf(this);for(;o;){const l=(r=(i=o.eventListeners)===null||i===void 0?void 0:i[t])!==null&&r!==void 0?r:[];a.push(...l),o=Object.getPrototypeOf(o)}s[t]=a,this._cache.set(tr,s)}return a}_fire(t,e){e=e||{},e.currentTarget=this,e.type=t;const i=this._getProtoListeners(t);if(i)for(let s=0;s<i.length;s++)i[s].handler.call(this,e);const r=this.eventListeners[t];if(r)for(let s=0;s<r.length;s++)r[s].handler.call(this,e)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(t){const e=t?t.pointerId:void 0,i=this.getStage(),r=this.getAbsolutePosition();if(!i)return;const s=i._getPointerById(e)||i._changedPointerPositions[0]||r;et._dragElements.set(this._id,{node:this,startPointerPos:s,offset:{x:s.x-r.x,y:s.y-r.y},dragStatus:"ready",pointerId:e})}startDrag(t,e=!0){et._dragElements.has(this._id)||this._createDragElement(t);const i=et._dragElements.get(this._id);i.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:t&&t.evt},e)}_setDragPosition(t,e){const i=this.getStage()._getPointerById(e.pointerId);if(!i)return;let r={x:i.x-e.offset.x,y:i.y-e.offset.y};const s=this.dragBoundFunc();if(s!==void 0){const a=s.call(this,r,t);a?r=a:_.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==r.x||this._lastPos.y!==r.y)&&(this.setAbsolutePosition(r),this._requestDraw()),this._lastPos=r}stopDrag(t){const e=et._dragElements.get(this._id);e&&(e.dragStatus="stopped"),et._endDragBefore(t),et._endDragAfter(t)}setDraggable(t){this._setAttr("draggable",t),this._dragChange()}isDragging(){const t=et._dragElements.get(this._id);return t?t.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(t){if(!(!(t.evt.button!==void 0)||D.dragButtons.indexOf(t.evt.button)>=0)||this.isDragging())return;let r=!1;et._dragElements.forEach(s=>{this.isAncestorOf(s.node)&&(r=!0)}),r||this._createDragElement(t)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const e=et._dragElements.get(this._id),i=e&&e.dragStatus==="dragging",r=e&&e.dragStatus==="ready";i?this.stopDrag():r&&et._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(t={x:0,y:0}){const e=this.getStage();if(!e)return!1;const i={x:-t.x,y:-t.y,width:e.width()+2*t.x,height:e.height()+2*t.y};return _.haveIntersection(i,this.getClientRect())}static create(t,e){return _._isString(t)&&(t=JSON.parse(t)),this._createNode(t,e)}static _createNode(t,e){let i=ls.prototype.getClassName.call(t),r=t.children,s,a,o;e&&(t.attrs.container=e),D[i]||(_.warn('Can not find a node with class name "'+i+'". Fallback to "Shape".'),i="Shape");const l=D[i];if(s=new l(t.attrs),r)for(a=r.length,o=0;o<a;o++)s.add(ls._createNode(r[o]));return s}};B.prototype.nodeType="Node";B.prototype._attrsAffectingSize=[];B.prototype.eventListeners={};B.prototype.on.call(B.prototype,hf,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(an),this._clearSelfAndDescendantCache(Ue)});B.prototype.on.call(B.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(os)});B.prototype.on.call(B.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(as)});B.prototype.on.call(B.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(fr)});const ht=C.addGetterSetter;ht(B,"zIndex");ht(B,"absolutePosition");ht(B,"position");ht(B,"x",0,K());ht(B,"y",0,K());ht(B,"globalCompositeOperation","source-over",Fn());ht(B,"opacity",1,K());ht(B,"name","",Fn());ht(B,"id","",Fn());ht(B,"rotation",0,K());C.addComponentsGetterSetter(B,"scale",["x","y"]);ht(B,"scaleX",1,K());ht(B,"scaleY",1,K());C.addComponentsGetterSetter(B,"skew",["x","y"]);ht(B,"skewX",0,K());ht(B,"skewY",0,K());C.addComponentsGetterSetter(B,"offset",["x","y"]);ht(B,"offsetX",0,K());ht(B,"offsetY",0,K());ht(B,"dragDistance",void 0,K());ht(B,"width",0,K());ht(B,"height",0,K());ht(B,"listening",!0,Be());ht(B,"preventDefault",!0,Be());ht(B,"filters",void 0,function(n){return this._filterUpToDate=!1,n});ht(B,"visible",!0,Be());ht(B,"transformsEnabled","all",Fn());ht(B,"size");ht(B,"dragBoundFunc");ht(B,"draggable",!1,Be());C.backCompat(B,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});const Fi=new Map,Yo=D._global.PointerEvent!==void 0;function Yr(n){return Fi.get(n)}function Ps(n){return{evt:n,pointerId:n.pointerId}}function Xo(n,t){return Fi.get(n)===t}function Wo(n,t){Ri(n),t.getStage()&&(Fi.set(n,t),Yo&&t._fire("gotpointercapture",Ps(new PointerEvent("gotpointercapture"))))}function Ri(n,t){const e=Fi.get(n);if(!e)return;const i=e.getStage();i&&i.content,Fi.delete(n),Yo&&e._fire("lostpointercapture",Ps(new PointerEvent("lostpointercapture")))}const Vo="hasShadow",Uo="shadowRGBA",zo="patternImage",jo="linearGradient",qo="radialGradient";let er;function Xr(){return er||(er=_.createCanvasElement().getContext("2d"),er)}const Li={};function uf(n){const t=this.attrs.fillRule;t?n.fill(t):n.fill()}function df(n){n.stroke()}function gf(n){const t=this.attrs.fillRule;t?n.fill(t):n.fill()}function pf(n){n.stroke()}function vf(){this._clearCache(Vo)}function _f(){this._clearCache(Uo)}function mf(){this._clearCache(zo)}function yf(){this._clearCache(jo)}function bf(){this._clearCache(qo)}class P extends B{constructor(t){super(t);let e,i=0;for(;e=_.getHitColor(),!(e&&!(e in Li));)if(i++,i>=1e4){_.warn("Failed to find a unique color key for a shape. Konva may work incorrectly. Most likely your browser is using canvas farbling. Consider disabling it."),e=_.getRandomColor();break}this.colorKey=e,Li[e]=this}getContext(){return _.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return _.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(Vo,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(zo,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const e=Xr().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(e&&e.setTransform){const i=new cn;i.translate(this.fillPatternX(),this.fillPatternY()),i.rotate(D.getAngle(this.fillPatternRotation())),i.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),i.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const r=i.getMatrix(),s=typeof DOMMatrix>"u"?{a:r[0],b:r[1],c:r[2],d:r[3],e:r[4],f:r[5]}:new DOMMatrix(r);e.setTransform(s)}return e}}_getLinearGradient(){return this._getCache(jo,this.__getLinearGradient)}__getLinearGradient(){const t=this.fillLinearGradientColorStops();if(t){const e=Xr(),i=this.fillLinearGradientStartPoint(),r=this.fillLinearGradientEndPoint(),s=e.createLinearGradient(i.x,i.y,r.x,r.y);for(let a=0;a<t.length;a+=2)s.addColorStop(t[a],t[a+1]);return s}}_getRadialGradient(){return this._getCache(qo,this.__getRadialGradient)}__getRadialGradient(){const t=this.fillRadialGradientColorStops();if(t){const e=Xr(),i=this.fillRadialGradientStartPoint(),r=this.fillRadialGradientEndPoint(),s=e.createRadialGradient(i.x,i.y,this.fillRadialGradientStartRadius(),r.x,r.y,this.fillRadialGradientEndRadius());for(let a=0;a<t.length;a+=2)s.addColorStop(t[a],t[a+1]);return s}}getShadowRGBA(){return this._getCache(Uo,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const t=_.colorToRGBA(this.shadowColor());if(t)return"rgba("+t.r+","+t.g+","+t.b+","+t.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const t=this.hitStrokeWidth();return t==="auto"?this.hasStroke():this.strokeEnabled()&&!!t}intersects(t){const e=this.getStage();if(!e)return!1;const i=e.bufferHitCanvas;return i.getContext().clear(),this.drawHit(i,void 0,!0),i.context.getImageData(Math.round(t.x),Math.round(t.y),1,1).data[3]>0}destroy(){return B.prototype.destroy.call(this),delete Li[this.colorKey],delete this.colorKey,this}_useBufferCanvas(t){var e;if(!((e=this.attrs.perfectDrawEnabled)!==null&&e!==void 0?e:!0))return!1;const r=t||this.hasFill(),s=this.hasStroke(),a=this.getAbsoluteOpacity()!==1;if(r&&s&&a)return!0;const o=this.hasShadow(),l=this.shadowForStrokeEnabled();return!!(r&&s&&o&&l)}setStrokeHitEnabled(t){_.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),t?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const t=this.size();return{x:this._centroid?-t.width/2:0,y:this._centroid?-t.height/2:0,width:t.width,height:t.height}}getClientRect(t={}){let e=!1,i=this.getParent();for(;i;){if(i.isCached()){e=!0;break}i=i.getParent()}const r=t.skipTransform,s=t.relativeTo||e&&this.getStage()||void 0,a=this.getSelfRect(),l=!t.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,c=a.width+l,f=a.height+l,u=!t.skipShadow&&this.hasShadow(),h=u?this.shadowOffsetX():0,p=u?this.shadowOffsetY():0,d=c+Math.abs(h),w=f+Math.abs(p),g=u&&this.shadowBlur()||0,y=d+g*2,L=w+g*2,I={width:y,height:L,x:-(l/2+g)+Math.min(h,0)+a.x,y:-(l/2+g)+Math.min(p,0)+a.y};return r?I:this._transformedRect(I,s)}drawScene(t,e,i){const r=this.getLayer(),s=t||r.getCanvas(),a=s.getContext(),o=this._getCanvasCache(),l=this.getSceneFunc(),c=this.hasShadow();let f;const u=e===this;if(!this.isVisible()&&!u)return this;if(o){a.save();const h=this.getAbsoluteTransform(e).getMatrix();return a.transform(h[0],h[1],h[2],h[3],h[4],h[5]),this._drawCachedSceneCanvas(a),a.restore(),this}if(!l)return this;if(a.save(),this._useBufferCanvas()){f=this.getStage();const h=i||f.bufferCanvas,p=h.getContext();p.clear(),p.save(),p._applyLineJoin(this),p._applyMiterLimit(this);const d=this.getAbsoluteTransform(e).getMatrix();p.transform(d[0],d[1],d[2],d[3],d[4],d[5]),l.call(this,p,this),p.restore();const w=h.pixelRatio;c&&a._applyShadow(this),u||(a._applyOpacity(this),a._applyGlobalCompositeOperation(this)),a.drawImage(h._canvas,h.x||0,h.y||0,h.width/w,h.height/w)}else{if(a._applyLineJoin(this),a._applyMiterLimit(this),!u){const h=this.getAbsoluteTransform(e).getMatrix();a.transform(h[0],h[1],h[2],h[3],h[4],h[5]),a._applyOpacity(this),a._applyGlobalCompositeOperation(this)}c&&a._applyShadow(this),l.call(this,a,this)}return a.restore(),this}drawHit(t,e,i=!1){if(!this.shouldDrawHit(e,i))return this;const r=this.getLayer(),s=t||r.hitCanvas,a=s&&s.getContext(),o=this.hitFunc()||this.sceneFunc(),l=this._getCanvasCache(),c=l&&l.hit;if(this.colorKey||_.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),c){a.save();const u=this.getAbsoluteTransform(e).getMatrix();return a.transform(u[0],u[1],u[2],u[3],u[4],u[5]),this._drawCachedHitCanvas(a),a.restore(),this}if(!o)return this;if(a.save(),a._applyLineJoin(this),a._applyMiterLimit(this),!(this===e)){const u=this.getAbsoluteTransform(e).getMatrix();a.transform(u[0],u[1],u[2],u[3],u[4],u[5])}return o.call(this,a,this),a.restore(),this}drawHitFromCache(t=0){const e=this._getCanvasCache(),i=this._getCachedSceneCanvas(),r=e.hit,s=r.getContext(),a=r.getWidth(),o=r.getHeight();s.clear(),s.drawImage(i._canvas,0,0,a,o);try{const l=s.getImageData(0,0,a,o),c=l.data,f=c.length,u=_._hexToRgb(this.colorKey);for(let h=0;h<f;h+=4)c[h+3]>t?(c[h]=u.r,c[h+1]=u.g,c[h+2]=u.b,c[h+3]=255):c[h+3]=0;s.putImageData(l,0,0)}catch(l){_.error("Unable to draw hit graph from cached scene canvas. "+l.message)}return this}hasPointerCapture(t){return Xo(t,this)}setPointerCapture(t){Wo(t,this)}releaseCapture(t){Ri(t)}}P.prototype._fillFunc=uf;P.prototype._strokeFunc=df;P.prototype._fillFuncHit=gf;P.prototype._strokeFuncHit=pf;P.prototype._centroid=!1;P.prototype.nodeType="Shape";tn(P);P.prototype.eventListeners={};P.prototype.on.call(P.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",vf);P.prototype.on.call(P.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",_f);P.prototype.on.call(P.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",mf);P.prototype.on.call(P.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",yf);P.prototype.on.call(P.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",bf);C.addGetterSetter(P,"stroke",void 0,Ho());C.addGetterSetter(P,"strokeWidth",2,K());C.addGetterSetter(P,"fillAfterStrokeEnabled",!1);C.addGetterSetter(P,"hitStrokeWidth","auto",xs());C.addGetterSetter(P,"strokeHitEnabled",!0,Be());C.addGetterSetter(P,"perfectDrawEnabled",!0,Be());C.addGetterSetter(P,"shadowForStrokeEnabled",!0,Be());C.addGetterSetter(P,"lineJoin");C.addGetterSetter(P,"lineCap");C.addGetterSetter(P,"miterLimit");C.addGetterSetter(P,"sceneFunc");C.addGetterSetter(P,"hitFunc");C.addGetterSetter(P,"dash");C.addGetterSetter(P,"dashOffset",0,K());C.addGetterSetter(P,"shadowColor",void 0,Fn());C.addGetterSetter(P,"shadowBlur",0,K());C.addGetterSetter(P,"shadowOpacity",1,K());C.addComponentsGetterSetter(P,"shadowOffset",["x","y"]);C.addGetterSetter(P,"shadowOffsetX",0,K());C.addGetterSetter(P,"shadowOffsetY",0,K());C.addGetterSetter(P,"fillPatternImage");C.addGetterSetter(P,"fill",void 0,Ho());C.addGetterSetter(P,"fillPatternX",0,K());C.addGetterSetter(P,"fillPatternY",0,K());C.addGetterSetter(P,"fillLinearGradientColorStops");C.addGetterSetter(P,"strokeLinearGradientColorStops");C.addGetterSetter(P,"fillRadialGradientStartRadius",0);C.addGetterSetter(P,"fillRadialGradientEndRadius",0);C.addGetterSetter(P,"fillRadialGradientColorStops");C.addGetterSetter(P,"fillPatternRepeat","repeat");C.addGetterSetter(P,"fillEnabled",!0);C.addGetterSetter(P,"strokeEnabled",!0);C.addGetterSetter(P,"shadowEnabled",!0);C.addGetterSetter(P,"dashEnabled",!0);C.addGetterSetter(P,"strokeScaleEnabled",!0);C.addGetterSetter(P,"fillPriority","color");C.addComponentsGetterSetter(P,"fillPatternOffset",["x","y"]);C.addGetterSetter(P,"fillPatternOffsetX",0,K());C.addGetterSetter(P,"fillPatternOffsetY",0,K());C.addComponentsGetterSetter(P,"fillPatternScale",["x","y"]);C.addGetterSetter(P,"fillPatternScaleX",1,K());C.addGetterSetter(P,"fillPatternScaleY",1,K());C.addComponentsGetterSetter(P,"fillLinearGradientStartPoint",["x","y"]);C.addComponentsGetterSetter(P,"strokeLinearGradientStartPoint",["x","y"]);C.addGetterSetter(P,"fillLinearGradientStartPointX",0);C.addGetterSetter(P,"strokeLinearGradientStartPointX",0);C.addGetterSetter(P,"fillLinearGradientStartPointY",0);C.addGetterSetter(P,"strokeLinearGradientStartPointY",0);C.addComponentsGetterSetter(P,"fillLinearGradientEndPoint",["x","y"]);C.addComponentsGetterSetter(P,"strokeLinearGradientEndPoint",["x","y"]);C.addGetterSetter(P,"fillLinearGradientEndPointX",0);C.addGetterSetter(P,"strokeLinearGradientEndPointX",0);C.addGetterSetter(P,"fillLinearGradientEndPointY",0);C.addGetterSetter(P,"strokeLinearGradientEndPointY",0);C.addComponentsGetterSetter(P,"fillRadialGradientStartPoint",["x","y"]);C.addGetterSetter(P,"fillRadialGradientStartPointX",0);C.addGetterSetter(P,"fillRadialGradientStartPointY",0);C.addComponentsGetterSetter(P,"fillRadialGradientEndPoint",["x","y"]);C.addGetterSetter(P,"fillRadialGradientEndPointX",0);C.addGetterSetter(P,"fillRadialGradientEndPointY",0);C.addGetterSetter(P,"fillPatternRotation",0);C.addGetterSetter(P,"fillRule",void 0,Fn());C.backCompat(P,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"});let en=class extends P{_sceneFunc(t){const e=D.getAngle(this.angle()),i=this.clockwise();t.beginPath(),t.arc(0,0,this.outerRadius(),0,e,i),t.arc(0,0,this.innerRadius(),e,0,!i),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}getSelfRect(){const t=this.innerRadius(),e=this.outerRadius(),i=this.clockwise(),r=D.getAngle(i?360-this.angle():this.angle()),s=Math.cos(Math.min(r,Math.PI)),a=1,o=Math.sin(Math.min(Math.max(Math.PI,r),3*Math.PI/2)),l=Math.sin(Math.min(r,Math.PI/2)),c=s*(s>0?t:e),f=a*e,u=o*(o>0?t:e),h=l*(l>0?e:t);return{x:c,y:i?-1*h:u,width:f-c,height:h-u}}};en.prototype._centroid=!0;en.prototype.className="Arc";en.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"];tn(en);C.addGetterSetter(en,"innerRadius",0,K());C.addGetterSetter(en,"outerRadius",0,K());C.addGetterSetter(en,"angle",0,K());C.addGetterSetter(en,"clockwise",!1,Be());const wf=["mouseover","mouseout","mouseenter","mouseleave","mousemove","mousedown","mouseup","wheel","click","dblclick","touchstart","touchmove","touchend","tap","dbltap","pointerdown","pointermove","pointerup","pointercancel","pointerover","pointerenter","pointerout","pointerleave","pointerclick","pointerdblclick","contextmenu","dragstart","dragmove","dragend","transformstart","transform","transformend"];function Nn(n,t){wf.forEach(e=>{const i=n[`on${e}`];typeof i=="function"&&t.on(e,r=>{i(r)})})}const mr=["svelte-konva-stage","svelte-konva-layer","svelte-konva-group","svelte-konva-label"];var ni;(function(n){n[n.Stage=0]="Stage",n[n.Layer=1]="Layer",n[n.Group=2]="Group",n[n.Label=3]="Label"})(ni||(ni={}));const Cf="svelte-konva: Component does not have any parent container. Please make sure that the component is wrapped inside a Layer or Group.",Sf="svelte-konva: A Layer needs to have a Stage as parent.";function As(n,t){mr.forEach(e=>{js(e,null)}),js(mr[n],t)}function Wi(){for(let n=1;n<4;n++){const t=za(mr[n]);if(t)return t}throw new Error(Cf)}function xf(){const n=za(mr[ni.Stage]);if(n)return n;throw new Error(Sf)}function kf(n,t){ne(t,!0);let e=b(t,"staticConfig",3,!1),i=b(t,"x",15),r=b(t,"y",15),s=b(t,"scale",15),a=b(t,"scaleX",15),o=b(t,"scaleY",15),l=b(t,"rotation",15),c=b(t,"skewX",15),f=b(t,"skewY",15),u=Wt(t,["$$slots","$$events","$$legacy","staticConfig","x","y","scale","scaleX","scaleY","rotation","skewX","skewY"]);const h=new en({x:i(),y:r(),scale:s(),scaleX:a(),scaleY:o(),rotation:l(),skewX:c(),skewY:f(),...u});if(Wi().add(h),!e()){const d=h.getAttrs();h.on("transformend",()=>{i()!==void 0&&i(d.x),r()!==void 0&&r(d.y),s()!==void 0&&s(d.scale),a()!==void 0&&a(d.scaleX),o()!==void 0&&o(d.scaleY),l()!==void 0&&l(d.rotation),c()!==void 0&&c(d.skewX),f()!==void 0&&f(d.skewY)}),h.on("dragend",()=>{i()!==void 0&&i(d.x),r()!==void 0&&r(d.y)})}Object.keys(u).filter(d=>!d.startsWith("on")).forEach(d=>{M(()=>{h.setAttr(d,u[d])})}),M(()=>{h.setAttr("x",i())}),M(()=>{h.setAttr("y",r())}),M(()=>{h.setAttr("scale",s())}),M(()=>{h.setAttr("scaleX",a())}),M(()=>{h.setAttr("scaleY",o())}),M(()=>{h.setAttr("rotation",l())}),M(()=>{h.setAttr("skewX",c())}),M(()=>{h.setAttr("skewY",f())}),Nn(u,h),In(()=>{h.destroy()});var p={node:h};return ie(p)}let ai=class extends P{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius()!==t/2&&this.radius(t/2)}setHeight(t){this.radius()!==t/2&&this.radius(t/2)}};ai.prototype._centroid=!0;ai.prototype.className="Circle";ai.prototype._attrsAffectingSize=["radius"];tn(ai);C.addGetterSetter(ai,"radius",0,K());function nr(n,t){ne(t,!0);let e=b(t,"staticConfig",3,!1),i=b(t,"x",15),r=b(t,"y",15),s=b(t,"scale",15),a=b(t,"scaleX",15),o=b(t,"scaleY",15),l=b(t,"rotation",15),c=b(t,"skewX",15),f=b(t,"skewY",15),u=Wt(t,["$$slots","$$events","$$legacy","staticConfig","x","y","scale","scaleX","scaleY","rotation","skewX","skewY"]);const h=new ai({x:i(),y:r(),scale:s(),scaleX:a(),scaleY:o(),rotation:l(),skewX:c(),skewY:f(),...u});if(Wi().add(h),!e()){const d=h.getAttrs();h.on("transformend",()=>{i()!==void 0&&i(d.x),r()!==void 0&&r(d.y),s()!==void 0&&s(d.scale),a()!==void 0&&a(d.scaleX),o()!==void 0&&o(d.scaleY),l()!==void 0&&l(d.rotation),c()!==void 0&&c(d.skewX),f()!==void 0&&f(d.skewY)}),h.on("dragend",()=>{i()!==void 0&&i(d.x),r()!==void 0&&r(d.y)})}Object.keys(u).filter(d=>!d.startsWith("on")).forEach(d=>{M(()=>{h.setAttr(d,u[d])})}),M(()=>{h.setAttr("x",i())}),M(()=>{h.setAttr("y",r())}),M(()=>{h.setAttr("scale",s())}),M(()=>{h.setAttr("scaleX",a())}),M(()=>{h.setAttr("scaleY",o())}),M(()=>{h.setAttr("rotation",l())}),M(()=>{h.setAttr("skewX",c())}),M(()=>{h.setAttr("skewY",f())}),Nn(u,h),In(()=>{h.destroy()});var p={node:h};return ie(p)}class le extends B{constructor(){super(...arguments),this.children=[]}getChildren(t){const e=this.children||[];return t?e.filter(t):e}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.destroy()}),this.children=[],this._requestDraw(),this}add(...t){if(t.length===0)return this;if(t.length>1){for(let i=0;i<t.length;i++)this.add(t[i]);return this}const e=t[0];return e.getParent()?(e.moveTo(this),this):(this._validateAdd(e),e.index=this.getChildren().length,e.parent=this,e._clearCaches(),this.getChildren().push(e),this._fire("add",{child:e}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(t){return this._generalFind(t,!1)}findOne(t){const e=this._generalFind(t,!0);return e.length>0?e[0]:void 0}_generalFind(t,e){const i=[];return this._descendants(r=>{const s=r._isMatch(t);return s&&i.push(r),!!(s&&e)}),i}_descendants(t){let e=!1;const i=this.getChildren();for(const r of i){if(e=t(r),e)return!0;if(r.hasChildren()&&(e=r._descendants(t),e))return!0}return!1}toObject(){const t=B.prototype.toObject.call(this);return t.children=[],this.getChildren().forEach(e=>{t.children.push(e.toObject())}),t}isAncestorOf(t){let e=t.getParent();for(;e;){if(e._id===this._id)return!0;e=e.getParent()}return!1}clone(t){const e=B.prototype.clone.call(this,t);return this.getChildren().forEach(function(i){e.add(i.clone())}),e}getAllIntersections(t){const e=[];return this.find("Shape").forEach(i=>{i.isVisible()&&i.intersects(t)&&e.push(i)}),e}_clearSelfAndDescendantCache(t){var e;super._clearSelfAndDescendantCache(t),!this.isCached()&&((e=this.children)===null||e===void 0||e.forEach(function(i){i._clearSelfAndDescendantCache(t)}))}_setChildrenIndices(){var t;(t=this.children)===null||t===void 0||t.forEach(function(e,i){e.index=i}),this._requestDraw()}drawScene(t,e,i){const r=this.getLayer(),s=t||r&&r.getCanvas(),a=s&&s.getContext(),o=this._getCanvasCache(),l=o&&o.scene,c=s&&s.isCache;if(!this.isVisible()&&!c)return this;if(l){a.save();const f=this.getAbsoluteTransform(e).getMatrix();a.transform(f[0],f[1],f[2],f[3],f[4],f[5]),this._drawCachedSceneCanvas(a),a.restore()}else this._drawChildren("drawScene",s,e,i);return this}drawHit(t,e){if(!this.shouldDrawHit(e))return this;const i=this.getLayer(),r=t||i&&i.hitCanvas,s=r&&r.getContext(),a=this._getCanvasCache();if(a&&a.hit){s.save();const l=this.getAbsoluteTransform(e).getMatrix();s.transform(l[0],l[1],l[2],l[3],l[4],l[5]),this._drawCachedHitCanvas(s),s.restore()}else this._drawChildren("drawHit",r,e);return this}_drawChildren(t,e,i,r){var s;const a=e&&e.getContext(),o=this.clipWidth(),l=this.clipHeight(),c=this.clipFunc(),f=typeof o=="number"&&typeof l=="number"||c,u=i===this;if(f){a.save();const p=this.getAbsoluteTransform(i);let d=p.getMatrix();a.transform(d[0],d[1],d[2],d[3],d[4],d[5]),a.beginPath();let w;if(c)w=c.call(this,a,this);else{const g=this.clipX(),y=this.clipY();a.rect(g||0,y||0,o,l)}a.clip.apply(a,w),d=p.copy().invert().getMatrix(),a.transform(d[0],d[1],d[2],d[3],d[4],d[5])}const h=!u&&this.globalCompositeOperation()!=="source-over"&&t==="drawScene";h&&(a.save(),a._applyGlobalCompositeOperation(this)),(s=this.children)===null||s===void 0||s.forEach(function(p){p[t](e,i,r)}),h&&a.restore(),f&&a.restore()}getClientRect(t={}){var e;const i=t.skipTransform,r=t.relativeTo;let s,a,o,l,c={x:1/0,y:1/0,width:0,height:0};const f=this;(e=this.children)===null||e===void 0||e.forEach(function(p){if(!p.visible())return;const d=p.getClientRect({relativeTo:f,skipShadow:t.skipShadow,skipStroke:t.skipStroke});d.width===0&&d.height===0||(s===void 0?(s=d.x,a=d.y,o=d.x+d.width,l=d.y+d.height):(s=Math.min(s,d.x),a=Math.min(a,d.y),o=Math.max(o,d.x+d.width),l=Math.max(l,d.y+d.height)))});const u=this.find("Shape");let h=!1;for(let p=0;p<u.length;p++)if(u[p]._isVisible(this)){h=!0;break}return h&&s!==void 0?c={x:s,y:a,width:o-s,height:l-a}:c={x:0,y:0,width:0,height:0},i?c:this._transformedRect(c,r)}}C.addComponentsGetterSetter(le,"clip",["x","y","width","height"]);C.addGetterSetter(le,"clipX",void 0,K());C.addGetterSetter(le,"clipY",void 0,K());C.addGetterSetter(le,"clipWidth",void 0,K());C.addGetterSetter(le,"clipHeight",void 0,K());C.addGetterSetter(le,"clipFunc");const Ef="Stage",Pf="string",ma="px",Af="mouseout",Ko="mouseleave",Jo="mouseover",Zo="mouseenter",Qo="mousemove",$o="mousedown",tl="mouseup",Ci="pointermove",Si="pointerdown",Kn="pointerup",xi="pointercancel",Tf="lostpointercapture",ir="pointerout",ki="pointerleave",rr="pointerover",sr="pointerenter",cs="contextmenu",el="touchstart",nl="touchend",il="touchmove",rl="touchcancel",hs="wheel",Rf=5,Lf=[[Zo,"_pointerenter"],[$o,"_pointerdown"],[Qo,"_pointermove"],[tl,"_pointerup"],[Ko,"_pointerleave"],[el,"_pointerdown"],[il,"_pointermove"],[nl,"_pointerup"],[rl,"_pointercancel"],[Jo,"_pointerover"],[hs,"_wheel"],[cs,"_contextmenu"],[Si,"_pointerdown"],[Ci,"_pointermove"],[Kn,"_pointerup"],[xi,"_pointercancel"],[ki,"_pointerleave"],[Tf,"_lostpointercapture"]],Wr={mouse:{[ir]:Af,[ki]:Ko,[rr]:Jo,[sr]:Zo,[Ci]:Qo,[Si]:$o,[Kn]:tl,[xi]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[ir]:"touchout",[ki]:"touchleave",[rr]:"touchover",[sr]:"touchenter",[Ci]:il,[Si]:el,[Kn]:nl,[xi]:rl,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[ir]:ir,[ki]:ki,[rr]:rr,[sr]:sr,[Ci]:Ci,[Si]:Si,[Kn]:Kn,[xi]:xi,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},Ei=n=>n.indexOf("pointer")>=0?"pointer":n.indexOf("touch")>=0?"touch":"mouse",zn=n=>{const t=Ei(n);if(t==="pointer")return D.pointerEventsEnabled&&Wr.pointer;if(t==="touch")return Wr.touch;if(t==="mouse")return Wr.mouse};function ya(n={}){return(n.clipFunc||n.clipWidth||n.clipHeight)&&_.warn("Stage does not support clipping. Please use clip for Layers or Groups."),n}const Df="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);",Di=[];let Vi=class extends le{constructor(t){super(ya(t)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),Di.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{ya(this.attrs)}),this._checkVisibility()}_validateAdd(t){const e=t.getType()==="Layer",i=t.getType()==="FastLayer";e||i||_.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const t=this.visible()?"":"none";this.content.style.display=t}setContainer(t){if(typeof t===Pf){let e;if(t.charAt(0)==="."){const i=t.slice(1);t=document.getElementsByClassName(i)[0]}else t.charAt(0)!=="#"?e=t:e=t.slice(1),t=document.getElementById(e);if(!t)throw"Can not find container in document with id "+e}return this._setAttr("container",t),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),t.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const t=this.children,e=t.length;for(let i=0;i<e;i++)t[i].clear();return this}clone(t){return t||(t={}),t.container=typeof document<"u"&&document.createElement("div"),le.prototype.clone.call(this,t)}destroy(){super.destroy();const t=this.content;t&&_._isInDocument(t)&&this.container().removeChild(t);const e=Di.indexOf(this);return e>-1&&Di.splice(e,1),_.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const t=this._pointerPositions[0]||this._changedPointerPositions[0];return t?{x:t.x,y:t.y}:(_.warn(Df),null)}_getPointerById(t){return this._pointerPositions.find(e=>e.id===t)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(t){t={...t},t.x=t.x||0,t.y=t.y||0,t.width=t.width||this.width(),t.height=t.height||this.height();const e=new on({width:t.width,height:t.height,pixelRatio:t.pixelRatio||1}),i=e.getContext()._context,r=this.children;return(t.x||t.y)&&i.translate(-1*t.x,-1*t.y),r.forEach(function(s){if(!s.isVisible())return;const a=s._toKonvaCanvas(t);i.drawImage(a._canvas,t.x,t.y,a.getWidth()/a.getPixelRatio(),a.getHeight()/a.getPixelRatio())}),e}getIntersection(t){if(!t)return null;const e=this.children,i=e.length,r=i-1;for(let s=r;s>=0;s--){const a=e[s].getIntersection(t);if(a)return a}return null}_resizeDOM(){const t=this.width(),e=this.height();this.content&&(this.content.style.width=t+ma,this.content.style.height=e+ma),this.bufferCanvas.setSize(t,e),this.bufferHitCanvas.setSize(t,e),this.children.forEach(i=>{i.setSize({width:t,height:e}),i.draw()})}add(t,...e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.add(arguments[r]);return this}super.add(t);const i=this.children.length;return i>Rf&&_.warn("The stage has "+i+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),t.setSize({width:this.width(),height:this.height()}),t.draw(),D.isBrowser&&this.content.appendChild(t.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(t){return Xo(t,this)}setPointerCapture(t){Wo(t,this)}releaseCapture(t){Ri(t)}getLayers(){return this.children}_bindContentEvents(){D.isBrowser&&Lf.forEach(([t,e])=>{this.content.addEventListener(t,i=>{this[e](i)},{passive:!1})})}_pointerenter(t){this.setPointersPositions(t);const e=zn(t.type);e&&this._fire(e.pointerenter,{evt:t,target:this,currentTarget:this})}_pointerover(t){this.setPointersPositions(t);const e=zn(t.type);e&&this._fire(e.pointerover,{evt:t,target:this,currentTarget:this})}_getTargetShape(t){let e=this[t+"targetShape"];return e&&!e.getStage()&&(e=null),e}_pointerleave(t){const e=zn(t.type),i=Ei(t.type);if(!e)return;this.setPointersPositions(t);const r=this._getTargetShape(i),s=!(D.isDragging()||D.isTransforming())||D.hitOnDragEnabled;r&&s?(r._fireAndBubble(e.pointerout,{evt:t}),r._fireAndBubble(e.pointerleave,{evt:t}),this._fire(e.pointerleave,{evt:t,target:this,currentTarget:this}),this[i+"targetShape"]=null):s&&(this._fire(e.pointerleave,{evt:t,target:this,currentTarget:this}),this._fire(e.pointerout,{evt:t,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(t){const e=zn(t.type),i=Ei(t.type);if(!e)return;this.setPointersPositions(t);let r=!1;this._changedPointerPositions.forEach(s=>{const a=this.getIntersection(s);if(et.justDragged=!1,D["_"+i+"ListenClick"]=!0,!a||!a.isListening()){this[i+"ClickStartShape"]=void 0;return}D.capturePointerEventsEnabled&&a.setPointerCapture(s.id),this[i+"ClickStartShape"]=a,a._fireAndBubble(e.pointerdown,{evt:t,pointerId:s.id}),r=!0;const o=t.type.indexOf("touch")>=0;a.preventDefault()&&t.cancelable&&o&&t.preventDefault()}),r||this._fire(e.pointerdown,{evt:t,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(t){const e=zn(t.type),i=Ei(t.type);if(!e)return;const r=t.type.indexOf("touch")>=0||t.pointerType==="touch";if(D.isDragging()&&et.node.preventDefault()&&t.cancelable&&r&&t.preventDefault(),this.setPointersPositions(t),!(!(D.isDragging()||D.isTransforming())||D.hitOnDragEnabled))return;const a={};let o=!1;const l=this._getTargetShape(i);this._changedPointerPositions.forEach(c=>{const f=Yr(c.id)||this.getIntersection(c),u=c.id,h={evt:t,pointerId:u},p=l!==f;if(p&&l&&(l._fireAndBubble(e.pointerout,{...h},f),l._fireAndBubble(e.pointerleave,{...h},f)),f){if(a[f._id])return;a[f._id]=!0}f&&f.isListening()?(o=!0,p&&(f._fireAndBubble(e.pointerover,{...h},l),f._fireAndBubble(e.pointerenter,{...h},l),this[i+"targetShape"]=f),f._fireAndBubble(e.pointermove,{...h})):l&&(this._fire(e.pointerover,{evt:t,target:this,currentTarget:this,pointerId:u}),this[i+"targetShape"]=null)}),o||this._fire(e.pointermove,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(t){const e=zn(t.type),i=Ei(t.type);if(!e)return;this.setPointersPositions(t);const r=this[i+"ClickStartShape"],s=this[i+"ClickEndShape"],a={};let o=!1;this._changedPointerPositions.forEach(l=>{const c=Yr(l.id)||this.getIntersection(l);if(c){if(c.releaseCapture(l.id),a[c._id])return;a[c._id]=!0}const f=l.id,u={evt:t,pointerId:f};let h=!1;D["_"+i+"InDblClickWindow"]?(h=!0,clearTimeout(this[i+"DblTimeout"])):et.justDragged||(D["_"+i+"InDblClickWindow"]=!0,clearTimeout(this[i+"DblTimeout"])),this[i+"DblTimeout"]=setTimeout(function(){D["_"+i+"InDblClickWindow"]=!1},D.dblClickWindow),c&&c.isListening()?(o=!0,this[i+"ClickEndShape"]=c,c._fireAndBubble(e.pointerup,{...u}),D["_"+i+"ListenClick"]&&r&&r===c&&(c._fireAndBubble(e.pointerclick,{...u}),h&&s&&s===c&&c._fireAndBubble(e.pointerdblclick,{...u}))):(this[i+"ClickEndShape"]=null,o||(this._fire(e.pointerup,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),o=!0),D["_"+i+"ListenClick"]&&this._fire(e.pointerclick,{evt:t,target:this,currentTarget:this,pointerId:f}),h&&this._fire(e.pointerdblclick,{evt:t,target:this,currentTarget:this,pointerId:f}))}),o||this._fire(e.pointerup,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),D["_"+i+"ListenClick"]=!1,t.cancelable&&i!=="touch"&&i!=="pointer"&&t.preventDefault()}_contextmenu(t){this.setPointersPositions(t);const e=this.getIntersection(this.getPointerPosition());e&&e.isListening()?e._fireAndBubble(cs,{evt:t}):this._fire(cs,{evt:t,target:this,currentTarget:this})}_wheel(t){this.setPointersPositions(t);const e=this.getIntersection(this.getPointerPosition());e&&e.isListening()?e._fireAndBubble(hs,{evt:t}):this._fire(hs,{evt:t,target:this,currentTarget:this})}_pointercancel(t){this.setPointersPositions(t);const e=Yr(t.pointerId)||this.getIntersection(this.getPointerPosition());e&&e._fireAndBubble(Kn,Ps(t)),Ri(t.pointerId)}_lostpointercapture(t){Ri(t.pointerId)}setPointersPositions(t){const e=this._getContentPosition();let i=null,r=null;t=t||window.event,t.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(t.touches,s=>{this._pointerPositions.push({id:s.identifier,x:(s.clientX-e.left)/e.scaleX,y:(s.clientY-e.top)/e.scaleY})}),Array.prototype.forEach.call(t.changedTouches||t.touches,s=>{this._changedPointerPositions.push({id:s.identifier,x:(s.clientX-e.left)/e.scaleX,y:(s.clientY-e.top)/e.scaleY})})):(i=(t.clientX-e.left)/e.scaleX,r=(t.clientY-e.top)/e.scaleY,this.pointerPos={x:i,y:r},this._pointerPositions=[{x:i,y:r,id:_._getFirstPointerId(t)}],this._changedPointerPositions=[{x:i,y:r,id:_._getFirstPointerId(t)}])}_setPointerPosition(t){_.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(t)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const t=this.content.getBoundingClientRect();return{top:t.top,left:t.left,scaleX:t.width/this.content.clientWidth||1,scaleY:t.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new on({width:this.width(),height:this.height()}),this.bufferHitCanvas=new Es({pixelRatio:1,width:this.width(),height:this.height()}),!D.isBrowser)return;const t=this.container();if(!t)throw"Stage has no container. A container is required.";t.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),t.appendChild(this.content),this._resizeDOM()}cache(){return _.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(t){t.batchDraw()}),this}};Vi.prototype.nodeType=Ef;tn(Vi);C.addGetterSetter(Vi,"container");D.isBrowser&&document.addEventListener("visibilitychange",()=>{Di.forEach(n=>{n.batchDraw()})});const Of="beforeDraw",Mf="draw",sl=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],If=sl.length;let Bn=class extends le{constructor(t){super(t),this.canvas=new on,this.hitCanvas=new Es({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(t){return this.getContext().clear(t),this.getHitCanvas().getContext().clear(t),this}setZIndex(t){super.setZIndex(t);const e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),t<e.children.length-1?e.content.insertBefore(this.getNativeCanvasElement(),e.children[t+1].getCanvas()._canvas):e.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){B.prototype.moveToTop.call(this);const t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!B.prototype.moveUp.call(this))return!1;const e=this.getStage();return!e||!e.content?!1:(e.content.removeChild(this.getNativeCanvasElement()),this.index<e.children.length-1?e.content.insertBefore(this.getNativeCanvasElement(),e.children[this.index+1].getCanvas()._canvas):e.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(B.prototype.moveDown.call(this)){const t=this.getStage();if(t){const e=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),e[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(B.prototype.moveToBottom.call(this)){const t=this.getStage();if(t){const e=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),e[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const t=this.getNativeCanvasElement();return B.prototype.remove.call(this),t&&t.parentNode&&_._isInDocument(t)&&t.parentNode.removeChild(t),this}getStage(){return this.parent}setSize({width:t,height:e}){return this.canvas.setSize(t,e),this.hitCanvas.setSize(t,e),this._setSmoothEnabled(),this}_validateAdd(t){const e=t.getType();e!=="Group"&&e!=="Shape"&&_.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(t){return t={...t},t.width=t.width||this.getWidth(),t.height=t.height||this.getHeight(),t.x=t.x!==void 0?t.x:this.x(),t.y=t.y!==void 0?t.y:this.y(),B.prototype._toKonvaCanvas.call(this,t)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){_.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){_.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,_.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(t){if(!this.isListening()||!this.isVisible())return null;let e=1,i=!1;for(;;){for(let r=0;r<If;r++){const s=sl[r],a=this._getIntersection({x:t.x+s.x*e,y:t.y+s.y*e}),o=a.shape;if(o)return o;if(i=!!a.antialiased,!a.antialiased)break}if(i)e+=1;else return null}}_getIntersection(t){const e=this.hitCanvas.pixelRatio,i=this.hitCanvas.context.getImageData(Math.round(t.x*e),Math.round(t.y*e),1,1).data,r=i[3];if(r===255){const s=_.getHitColorKey(i[0],i[1],i[2]),a=Li[s];return a?{shape:a}:{antialiased:!0}}else if(r>0)return{antialiased:!0};return{}}drawScene(t,e,i){const r=this.getLayer(),s=t||r&&r.getCanvas();return this._fire(Of,{node:this}),this.clearBeforeDraw()&&s.getContext().clear(),le.prototype.drawScene.call(this,s,e,i),this._fire(Mf,{node:this}),this}drawHit(t,e){const i=this.getLayer(),r=t||i&&i.hitCanvas;return i&&i.clearBeforeDraw()&&i.getHitCanvas().getContext().clear(),le.prototype.drawHit.call(this,r,e),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(t){_.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(t)}getHitGraphEnabled(t){return _.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const t=this.parent;!!this.hitCanvas._canvas.parentNode?t.content.removeChild(this.hitCanvas._canvas):t.content.appendChild(this.hitCanvas._canvas)}destroy(){return _.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};Bn.prototype.nodeType="Layer";tn(Bn);C.addGetterSetter(Bn,"imageSmoothingEnabled",!0);C.addGetterSetter(Bn,"clearBeforeDraw",!0);C.addGetterSetter(Bn,"hitGraphEnabled",!0,Be());class Ts extends Bn{constructor(t){super(t),this.listening(!1),_.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}Ts.prototype.nodeType="FastLayer";tn(Ts);let Rs=class extends le{_validateAdd(t){const e=t.getType();e!=="Group"&&e!=="Shape"&&_.throw("You may only add groups and shapes to groups.")}};Rs.prototype.nodeType="Group";tn(Rs);const Vr=(function(){return xn.performance&&xn.performance.now?function(){return xn.performance.now()}:function(){return new Date().getTime()}})();class Ce{constructor(t,e){this.id=Ce.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:Vr(),frameRate:0},this.func=t,this.setLayers(e)}setLayers(t){let e=[];return t&&(e=Array.isArray(t)?t:[t]),this.layers=e,this}getLayers(){return this.layers}addLayer(t){const e=this.layers,i=e.length;for(let r=0;r<i;r++)if(e[r]._id===t._id)return!1;return this.layers.push(t),!0}isRunning(){const e=Ce.animations,i=e.length;for(let r=0;r<i;r++)if(e[r].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=Vr(),Ce._addAnimation(this),this}stop(){return Ce._removeAnimation(this),this}_updateFrameObject(t){this.frame.timeDiff=t-this.frame.lastTime,this.frame.lastTime=t,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(t){this.animations.push(t),this._handleAnimation()}static _removeAnimation(t){const e=t.id,i=this.animations,r=i.length;for(let s=0;s<r;s++)if(i[s].id===e){this.animations.splice(s,1);break}}static _runFrames(){const t={},e=this.animations;for(let i=0;i<e.length;i++){const r=e[i],s=r.layers,a=r.func;r._updateFrameObject(Vr());const o=s.length;let l;if(a?l=a.call(r,r.frame)!==!1:l=!0,!!l)for(let c=0;c<o;c++){const f=s[c];f._id!==void 0&&(t[f._id]=f)}}for(const i in t)t.hasOwnProperty(i)&&t[i].batchDraw()}static _animationLoop(){const t=Ce;t.animations.length?(t._runFrames(),_.requestAnimFrame(t._animationLoop)):t.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,_.requestAnimFrame(this._animationLoop))}}Ce.animations=[];Ce.animIdCounter=0;Ce.animRunning=!1;const Gf={node:1,duration:1,easing:1,onFinish:1,yoyo:1},Ff=1,ba=2,wa=3,Ca=["fill","stroke","shadowColor"];let Nf=0;class Bf{constructor(t,e,i,r,s,a,o){this.prop=t,this.propFunc=e,this.begin=r,this._pos=r,this.duration=a,this._change=0,this.prevPos=0,this.yoyo=o,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=i,this._change=s-this.begin,this.pause()}fire(t){const e=this[t];e&&e()}setTime(t){t>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():t<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=t,this.update())}getTime(){return this._time}setPosition(t){this.prevPos=this._pos,this.propFunc(t),this._pos=t}getPosition(t){return t===void 0&&(t=this._time),this.func(t,this.begin,this._change,this.duration)}play(){this.state=ba,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=wa,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(t){this.pause(),this._time=t,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const t=this.getTimer()-this._startTime;this.state===ba?this.setTime(t):this.state===wa&&this.setTime(this.duration-t)}pause(){this.state=Ff,this.fire("onPause")}getTimer(){return new Date().getTime()}}class dt{constructor(t){const e=this,i=t.node,r=i._id,s=t.easing||Oi.Linear,a=!!t.yoyo;let o,l;typeof t.duration>"u"?o=.3:t.duration===0?o=.001:o=t.duration,this.node=i,this._id=Nf++;const c=i.getLayer()||(i instanceof D.Stage?i.getLayers():null);c||_.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new Ce(function(){e.tween.onEnterFrame()},c),this.tween=new Bf(l,function(f){e._tweenFunc(f)},s,0,1,o*1e3,a),this._addListeners(),dt.attrs[r]||(dt.attrs[r]={}),dt.attrs[r][this._id]||(dt.attrs[r][this._id]={}),dt.tweens[r]||(dt.tweens[r]={});for(l in t)Gf[l]===void 0&&this._addAttr(l,t[l]);this.reset(),this.onFinish=t.onFinish,this.onReset=t.onReset,this.onUpdate=t.onUpdate}_addAttr(t,e){const i=this.node,r=i._id;let s,a,o,l,c;const f=dt.tweens[r][t];f&&delete dt.attrs[r][f][t];let u=i.getAttr(t);if(_._isArray(e))if(s=[],a=Math.max(e.length,u.length),t==="points"&&e.length!==u.length&&(e.length>u.length?(l=u,u=_._prepareArrayForTween(u,e,i.closed())):(o=e,e=_._prepareArrayForTween(e,u,i.closed()))),t.indexOf("fill")===0)for(let h=0;h<a;h++)if(h%2===0)s.push(e[h]-u[h]);else{const p=_.colorToRGBA(u[h]);c=_.colorToRGBA(e[h]),u[h]=p,s.push({r:c.r-p.r,g:c.g-p.g,b:c.b-p.b,a:c.a-p.a})}else for(let h=0;h<a;h++)s.push(e[h]-u[h]);else Ca.indexOf(t)!==-1?(u=_.colorToRGBA(u),c=_.colorToRGBA(e),s={r:c.r-u.r,g:c.g-u.g,b:c.b-u.b,a:c.a-u.a}):s=e-u;dt.attrs[r][this._id][t]={start:u,diff:s,end:e,trueEnd:o,trueStart:l},dt.tweens[r][t]=this._id}_tweenFunc(t){const e=this.node,i=dt.attrs[e._id][this._id];let r,s,a,o,l,c,f,u;for(r in i){if(s=i[r],a=s.start,o=s.diff,u=s.end,_._isArray(a))if(l=[],f=Math.max(a.length,u.length),r.indexOf("fill")===0)for(c=0;c<f;c++)c%2===0?l.push((a[c]||0)+o[c]*t):l.push("rgba("+Math.round(a[c].r+o[c].r*t)+","+Math.round(a[c].g+o[c].g*t)+","+Math.round(a[c].b+o[c].b*t)+","+(a[c].a+o[c].a*t)+")");else for(c=0;c<f;c++)l.push((a[c]||0)+o[c]*t);else Ca.indexOf(r)!==-1?l="rgba("+Math.round(a.r+o.r*t)+","+Math.round(a.g+o.g*t)+","+Math.round(a.b+o.b*t)+","+(a.a+o.a*t)+")":l=a+o*t;e.setAttr(r,l)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const t=this.node,e=dt.attrs[t._id][this._id];e.points&&e.points.trueEnd&&t.setAttr("points",e.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const t=this.node,e=dt.attrs[t._id][this._id];e.points&&e.points.trueStart&&t.points(e.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(t){return this.tween.seek(t*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const t=this.node._id,e=this._id,i=dt.tweens[t];this.pause(),this.anim&&this.anim.stop();for(const r in i)delete dt.tweens[t][r];delete dt.attrs[t][e],dt.tweens[t]&&(Object.keys(dt.tweens[t]).length===0&&delete dt.tweens[t],Object.keys(dt.attrs[t]).length===0&&delete dt.attrs[t])}}dt.attrs={};dt.tweens={};B.prototype.to=function(n){const t=n.onFinish;n.node=this,n.onFinish=function(){this.destroy(),t&&t()},new dt(n).play()};const Oi={BackEaseIn(n,t,e,i){return e*(n/=i)*n*((1.70158+1)*n-1.70158)+t},BackEaseOut(n,t,e,i){return e*((n=n/i-1)*n*((1.70158+1)*n+1.70158)+1)+t},BackEaseInOut(n,t,e,i){let r=1.70158;return(n/=i/2)<1?e/2*(n*n*(((r*=1.525)+1)*n-r))+t:e/2*((n-=2)*n*(((r*=1.525)+1)*n+r)+2)+t},ElasticEaseIn(n,t,e,i,r,s){let a=0;return n===0?t:(n/=i)===1?t+e:(s||(s=i*.3),!r||r<Math.abs(e)?(r=e,a=s/4):a=s/(2*Math.PI)*Math.asin(e/r),-(r*Math.pow(2,10*(n-=1))*Math.sin((n*i-a)*(2*Math.PI)/s))+t)},ElasticEaseOut(n,t,e,i,r,s){let a=0;return n===0?t:(n/=i)===1?t+e:(s||(s=i*.3),!r||r<Math.abs(e)?(r=e,a=s/4):a=s/(2*Math.PI)*Math.asin(e/r),r*Math.pow(2,-10*n)*Math.sin((n*i-a)*(2*Math.PI)/s)+e+t)},ElasticEaseInOut(n,t,e,i,r,s){let a=0;return n===0?t:(n/=i/2)===2?t+e:(s||(s=i*(.3*1.5)),!r||r<Math.abs(e)?(r=e,a=s/4):a=s/(2*Math.PI)*Math.asin(e/r),n<1?-.5*(r*Math.pow(2,10*(n-=1))*Math.sin((n*i-a)*(2*Math.PI)/s))+t:r*Math.pow(2,-10*(n-=1))*Math.sin((n*i-a)*(2*Math.PI)/s)*.5+e+t)},BounceEaseOut(n,t,e,i){return(n/=i)<1/2.75?e*(7.5625*n*n)+t:n<2/2.75?e*(7.5625*(n-=1.5/2.75)*n+.75)+t:n<2.5/2.75?e*(7.5625*(n-=2.25/2.75)*n+.9375)+t:e*(7.5625*(n-=2.625/2.75)*n+.984375)+t},BounceEaseIn(n,t,e,i){return e-Oi.BounceEaseOut(i-n,0,e,i)+t},BounceEaseInOut(n,t,e,i){return n<i/2?Oi.BounceEaseIn(n*2,0,e,i)*.5+t:Oi.BounceEaseOut(n*2-i,0,e,i)*.5+e*.5+t},EaseIn(n,t,e,i){return e*(n/=i)*n+t},EaseOut(n,t,e,i){return-e*(n/=i)*(n-2)+t},EaseInOut(n,t,e,i){return(n/=i/2)<1?e/2*n*n+t:-e/2*(--n*(n-2)-1)+t},StrongEaseIn(n,t,e,i){return e*(n/=i)*n*n*n*n+t},StrongEaseOut(n,t,e,i){return e*((n=n/i-1)*n*n*n*n+1)+t},StrongEaseInOut(n,t,e,i){return(n/=i/2)<1?e/2*n*n*n*n*n+t:e/2*((n-=2)*n*n*n*n+2)+t},Linear(n,t,e,i){return e*n/i+t}},al=_._assign(D,{Util:_,Transform:cn,Node:B,Container:le,Stage:Vi,stages:Di,Layer:Bn,FastLayer:Ts,Group:Rs,DD:et,Shape:P,shapes:Li,Animation:Ce,Tween:dt,Easings:Oi,Context:Ar,Canvas:ks});function Sa(n,t){ne(t,!0);let e=b(t,"staticConfig",3,!1),i=b(t,"x",15),r=b(t,"y",15),s=b(t,"scale",15),a=b(t,"scaleX",15),o=b(t,"scaleY",15),l=b(t,"rotation",15),c=b(t,"skewX",15),f=b(t,"skewY",15),u=Wt(t,["$$slots","$$events","$$legacy","children","staticConfig","x","y","scale","scaleX","scaleY","rotation","skewX","skewY"]);const h=new al.Group({x:i(),y:r(),scale:s(),scaleX:a(),scaleY:o(),rotation:l(),skewX:c(),skewY:f(),...u});if(Wi().add(h),!e()){const g=h.getAttrs();h.on("transformend",()=>{i()!==void 0&&i(g.x),r()!==void 0&&r(g.y),s()!==void 0&&s(g.scale),a()!==void 0&&a(g.scaleX),o()!==void 0&&o(g.scaleY),l()!==void 0&&l(g.rotation),c()!==void 0&&c(g.skewX),f()!==void 0&&f(g.skewY)}),h.on("dragend",()=>{i()!==void 0&&i(g.x),r()!==void 0&&r(g.y)})}Object.keys(u).filter(g=>!g.startsWith("on")).forEach(g=>{M(()=>{h.setAttr(g,u[g])})}),M(()=>{h.setAttr("x",i())}),M(()=>{h.setAttr("y",r())}),M(()=>{h.setAttr("scale",s())}),M(()=>{h.setAttr("scaleX",a())}),M(()=>{h.setAttr("scaleY",o())}),M(()=>{h.setAttr("rotation",l())}),M(()=>{h.setAttr("skewX",c())}),M(()=>{h.setAttr("skewY",f())}),Nn(u,h),As(ni.Group,h),In(()=>{h.destroy()});var p={node:h},d=dn(),w=_e(d);return ws(w,()=>t.children??Ie),H(n,d),ie(p)}function Hf(n,t){ne(t,!0);let e=b(t,"staticConfig",3,!1),i=b(t,"x",15),r=b(t,"y",15),s=b(t,"scale",15),a=b(t,"scaleX",15),o=b(t,"scaleY",15),l=b(t,"rotation",15),c=b(t,"skewX",15),f=b(t,"skewY",15),u=Wt(t,["$$slots","$$events","$$legacy","children","staticConfig","x","y","scale","scaleX","scaleY","rotation","skewX","skewY"]);const h=new al.Layer({x:i(),y:r(),scale:s(),scaleX:a(),scaleY:o(),rotation:l(),skewX:c(),skewY:f(),...u});if(xf().add(h),!e()){const g=h.getAttrs();h.on("transformend",()=>{i()!==void 0&&i(g.x),r()!==void 0&&r(g.y),s()!==void 0&&s(g.scale),a()!==void 0&&a(g.scaleX),o()!==void 0&&o(g.scaleY),l()!==void 0&&l(g.rotation),c()!==void 0&&c(g.skewX),f()!==void 0&&f(g.skewY)}),h.on("dragend",()=>{i()!==void 0&&i(g.x),r()!==void 0&&r(g.y)})}Object.keys(u).filter(g=>!g.startsWith("on")).forEach(g=>{M(()=>{h.setAttr(g,u[g])})}),M(()=>{h.setAttr("x",i())}),M(()=>{h.setAttr("y",r())}),M(()=>{h.setAttr("scale",s())}),M(()=>{h.setAttr("scaleX",a())}),M(()=>{h.setAttr("scaleY",o())}),M(()=>{h.setAttr("rotation",l())}),M(()=>{h.setAttr("skewX",c())}),M(()=>{h.setAttr("skewY",f())}),Nn(u,h),As(ni.Layer,h),In(()=>{h.destroy()});var p={node:h},d=dn(),w=_e(d);return ws(w,()=>t.children??Ie),H(n,d),ie(p)}let Tr=class extends P{_sceneFunc(t){const e=this.cornerRadius(),i=this.width(),r=this.height();t.beginPath(),e?_.drawRoundedRectPath(t,i,r,e):t.rect(0,0,i,r),t.closePath(),t.fillStrokeShape(this)}};Tr.prototype.className="Rect";tn(Tr);C.addGetterSetter(Tr,"cornerRadius",0,Fh(4));function Yf(n,t){ne(t,!0);let e=b(t,"staticConfig",3,!1),i=b(t,"x",15),r=b(t,"y",15),s=b(t,"scale",15),a=b(t,"scaleX",15),o=b(t,"scaleY",15),l=b(t,"rotation",15),c=b(t,"skewX",15),f=b(t,"skewY",15),u=Wt(t,["$$slots","$$events","$$legacy","staticConfig","x","y","scale","scaleX","scaleY","rotation","skewX","skewY"]);const h=new Tr({x:i(),y:r(),scale:s(),scaleX:a(),scaleY:o(),rotation:l(),skewX:c(),skewY:f(),...u});if(Wi().add(h),!e()){const d=h.getAttrs();h.on("transformend",()=>{i()!==void 0&&i(d.x),r()!==void 0&&r(d.y),s()!==void 0&&s(d.scale),a()!==void 0&&a(d.scaleX),o()!==void 0&&o(d.scaleY),l()!==void 0&&l(d.rotation),c()!==void 0&&c(d.skewX),f()!==void 0&&f(d.skewY)}),h.on("dragend",()=>{i()!==void 0&&i(d.x),r()!==void 0&&r(d.y)})}Object.keys(u).filter(d=>!d.startsWith("on")).forEach(d=>{M(()=>{h.setAttr(d,u[d])})}),M(()=>{h.setAttr("x",i())}),M(()=>{h.setAttr("y",r())}),M(()=>{h.setAttr("scale",s())}),M(()=>{h.setAttr("scaleX",a())}),M(()=>{h.setAttr("scaleY",o())}),M(()=>{h.setAttr("rotation",l())}),M(()=>{h.setAttr("skewX",c())}),M(()=>{h.setAttr("skewY",f())}),Nn(u,h),In(()=>{h.destroy()});var p={node:h};return ie(p)}var Xf=J("<div><!></div>");function Wf(n,t){ne(t,!0);let e=b(t,"staticConfig",3,!1),i=b(t,"x",15),r=b(t,"y",15),s=Wt(t,["$$slots","$$events","$$legacy","children","staticConfig","x","y","divWrapperProps"]),a,o;try{o=document.createElement("div")}catch(h){throw new Error("svelte-konva: Library can only be used in a browser context but is currently used in a server environment. If you are using SvelteKit, please refer to the following docs: https://konvajs.org/docs/svelte/SvelteKit.html",{cause:h})}const l=new Vi({container:o,y:r(),x:i(),...s});if(!e()){const h=l.getAttrs();l.on("dragend",()=>{i()!==void 0&&i(h.x),r()!==void 0&&r(h.y)})}Object.keys(s).filter(h=>!h.startsWith("on")).forEach(h=>{M(()=>{l.setAttr(h,s[h])})}),M(()=>{l.setAttr("x",i())}),M(()=>{l.setAttr("y",r())}),Nn(s,l),As(ni.Stage,l),Ss(()=>{l.setContainer(a)}),In(()=>{l.destroy()});var c={node:l},f=Xf();Ee(f,()=>({...t.divWrapperProps}));var u=F(f);return ws(u,()=>t.children??Ie),Cs(f,h=>a=h,()=>a),H(n,f),ie(c)}function bn(n){return[...n].reduce((t,e,i,r)=>{if(new RegExp("\\p{Emoji}","u").test(e)){const s=r[i+1];s&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(s)?(t.push(e+s),r[i+1]=""):t.push(e)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(e+(r[i+1]||""))?t.push(e+r[i+1]):i>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(e)?t[t.length-1]+=e:e&&t.push(e);return t},[])}const jn="auto",Vf="center",ol="inherit",yi="justify",Uf="Change.konva",zf="2d",xa="-",ll="left",jf="text",qf="Text",Kf="top",Jf="bottom",ka="middle",cl="normal",Zf="px ",ar=" ",Qf="right",Ea="rtl",$f="word",tu="char",Pa="none",Ur="â¦",hl=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],eu=hl.length;function nu(n){return n.split(",").map(t=>{t=t.trim();const e=t.indexOf(" ")>=0,i=t.indexOf('"')>=0||t.indexOf("'")>=0;return e&&!i&&(t=`"${t}"`),t}).join(", ")}let or;function zr(){return or||(or=_.createCanvasElement().getContext(zf),or)}function iu(n){n.fillText(this._partialText,this._partialTextX,this._partialTextY)}function ru(n){n.setAttr("miterLimit",2),n.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function su(n){return n=n||{},!n.fillLinearGradientColorStops&&!n.fillRadialGradientColorStops&&!n.fillPatternImage&&(n.fill=n.fill||"black"),n}let bt=class extends P{constructor(t){super(su(t)),this._partialTextX=0,this._partialTextY=0;for(let e=0;e<eu;e++)this.on(hl[e]+Uf,this._setTextData);this._setTextData()}_sceneFunc(t){var e,i;const r=this.textArr,s=r.length;if(!this.text())return;let a=this.padding(),o=this.fontSize(),l=this.lineHeight()*o,c=this.verticalAlign(),f=this.direction(),u=0,h=this.align(),p=this.getWidth(),d=this.letterSpacing(),w=this.charRenderFunc(),g=this.fill(),y=this.textDecoration(),L=y.indexOf("underline")!==-1,I=y.indexOf("line-through")!==-1,E;f=f===ol?t.direction:f;let A=l/2,Y=ka;if(!D.legacyTextRendering){const T=this.measureSize("M");Y="alphabetic";const R=(e=T.fontBoundingBoxAscent)!==null&&e!==void 0?e:T.actualBoundingBoxAscent,W=(i=T.fontBoundingBoxDescent)!==null&&i!==void 0?i:T.actualBoundingBoxDescent;A=(R-W)/2+l/2}for(f===Ea&&t.setAttr("direction",f),t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",Y),t.setAttr("textAlign",ll),c===ka?u=(this.getHeight()-s*l-a*2)/2:c===Jf&&(u=this.getHeight()-s*l-a*2),t.translate(a,u+a),E=0;E<s;E++){let T=0,R=0;const W=r[E],z=W.text,q=W.width,ft=W.lastInParagraph;if(t.save(),h===Qf?T+=p-q-a*2:h===Vf&&(T+=(p-q-a*2)/2),L){t.save(),t.beginPath();const gt=D.legacyTextRendering?Math.round(o/2):Math.round(o/4),vt=T,_t=A+R+gt;t.moveTo(vt,_t);const at=h===yi&&!ft?p-a*2:q;t.lineTo(vt+Math.round(at),_t),t.lineWidth=o/15;const Mt=this._getLinearGradient();t.strokeStyle=Mt||g,t.stroke(),t.restore()}const wt=T;if(f!==Ea&&(d!==0||h===yi||w)){const gt=z.split(" ").length-1,vt=bn(z);for(let _t=0;_t<vt.length;_t++){const at=vt[_t];if(at===" "&&!ft&&h===yi&&(T+=(p-a*2-q)/gt),this._partialTextX=T,this._partialTextY=A+R,this._partialText=at,w){t.save();const Vt=r.slice(0,E).reduce((Zt,ce)=>Zt+bn(ce.text).length,0),Jt=_t+Vt;w({char:at,index:Jt,x:T,y:A+R,lineIndex:E,column:_t,isLastInLine:ft,width:this.measureSize(at).width,context:t})}t.fillStrokeShape(this),w&&t.restore(),T+=this.measureSize(at).width+d}}else d!==0&&t.setAttr("letterSpacing",`${d}px`),this._partialTextX=T,this._partialTextY=A+R,this._partialText=z,t.fillStrokeShape(this);if(I){t.save(),t.beginPath();const gt=D.legacyTextRendering?0:-Math.round(o/4),vt=wt;t.moveTo(vt,A+R+gt);const _t=h===yi&&!ft?p-a*2:q;t.lineTo(vt+Math.round(_t),A+R+gt),t.lineWidth=o/15;const at=this._getLinearGradient();t.strokeStyle=at||g,t.stroke(),t.restore()}t.restore(),s>1&&(A+=l)}}_hitFunc(t){const e=this.getWidth(),i=this.getHeight();t.beginPath(),t.rect(0,0,e,i),t.closePath(),t.fillStrokeShape(this)}setText(t){const e=_._isString(t)?t:t==null?"":t+"";return this._setAttr(jf,e),this}getWidth(){return this.attrs.width===jn||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===jn||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return _.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(t){var e,i,r,s,a,o,l,c,f,u,h;let p=zr(),d=this.fontSize(),w;p.save(),p.font=this._getContextFont(),w=p.measureText(t),p.restore();const g=d/100;return{actualBoundingBoxAscent:(e=w.actualBoundingBoxAscent)!==null&&e!==void 0?e:71.58203125*g,actualBoundingBoxDescent:(i=w.actualBoundingBoxDescent)!==null&&i!==void 0?i:0,actualBoundingBoxLeft:(r=w.actualBoundingBoxLeft)!==null&&r!==void 0?r:-7.421875*g,actualBoundingBoxRight:(s=w.actualBoundingBoxRight)!==null&&s!==void 0?s:75.732421875*g,alphabeticBaseline:(a=w.alphabeticBaseline)!==null&&a!==void 0?a:0,emHeightAscent:(o=w.emHeightAscent)!==null&&o!==void 0?o:100*g,emHeightDescent:(l=w.emHeightDescent)!==null&&l!==void 0?l:-20*g,fontBoundingBoxAscent:(c=w.fontBoundingBoxAscent)!==null&&c!==void 0?c:91*g,fontBoundingBoxDescent:(f=w.fontBoundingBoxDescent)!==null&&f!==void 0?f:21*g,hangingBaseline:(u=w.hangingBaseline)!==null&&u!==void 0?u:72.80000305175781*g,ideographicBaseline:(h=w.ideographicBaseline)!==null&&h!==void 0?h:-21*g,width:w.width,height:d}}_getContextFont(){return this.fontStyle()+ar+this.fontVariant()+ar+(this.fontSize()+Zf)+nu(this.fontFamily())}_addTextLine(t){this.align()===yi&&(t=t.trim());const i=this._getTextWidth(t);return this.textArr.push({text:t,width:i,lastInParagraph:!1})}_getTextWidth(t){const e=this.letterSpacing(),i=t.length;return zr().measureText(t).width+e*i}_setTextData(){let t=this.text().split(`
`),e=+this.fontSize(),i=0,r=this.lineHeight()*e,s=this.attrs.width,a=this.attrs.height,o=s!==jn&&s!==void 0,l=a!==jn&&a!==void 0,c=this.padding(),f=s-c*2,u=a-c*2,h=0,p=this.wrap(),d=p!==Pa,w=p!==tu&&d,g=this.ellipsis();this.textArr=[],zr().font=this._getContextFont();const y=g?this._getTextWidth(Ur):0;for(let L=0,I=t.length;L<I;++L){let E=t[L],A=this._getTextWidth(E);if(o&&A>f)for(;E.length>0;){let Y=0,T=bn(E).length,R="",W=0;for(;Y<T;){const z=Y+T>>>1,q=bn(E),ft=q.slice(0,z+1).join(""),wt=this._getTextWidth(ft);(g&&l&&h+r>u?wt+y:wt)<=f?(Y=z+1,R=ft,W=wt):T=z}if(R){if(w){const ft=bn(E),wt=bn(R),gt=ft[wt.length],vt=gt===ar||gt===xa;let _t;if(vt&&W<=f)_t=wt.length;else{const at=wt.lastIndexOf(ar),Mt=wt.lastIndexOf(xa);_t=Math.max(at,Mt)+1}_t>0&&(Y=_t,R=ft.slice(0,Y).join(""),W=this._getTextWidth(R))}if(R=R.trimRight(),this._addTextLine(R),i=Math.max(i,W),h+=r,this._shouldHandleEllipsis(h)){this._tryToAddEllipsisToLastLine();break}if(E=bn(E).slice(Y).join("").trimLeft(),E.length>0&&(A=this._getTextWidth(E),A<=f)){this._addTextLine(E),h+=r,i=Math.max(i,A);break}}else break}else this._addTextLine(E),h+=r,i=Math.max(i,A),this._shouldHandleEllipsis(h)&&L<I-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),l&&h+r>u)break}this.textHeight=e,this.textWidth=i}_shouldHandleEllipsis(t){const e=+this.fontSize(),i=this.lineHeight()*e,r=this.attrs.height,s=r!==jn&&r!==void 0,a=this.padding(),o=r-a*2;return!(this.wrap()!==Pa)||s&&t+i>o}_tryToAddEllipsisToLastLine(){const t=this.attrs.width,e=t!==jn&&t!==void 0,i=this.padding(),r=t-i*2,s=this.ellipsis(),a=this.textArr[this.textArr.length-1];!a||!s||(e&&(this._getTextWidth(a.text+Ur)<r||(a.text=a.text.slice(0,a.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(a.text+Ur))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const t=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,e=this.hasShadow();return t&&e?!0:super._useBufferCanvas()}};bt.prototype._fillFunc=iu;bt.prototype._strokeFunc=ru;bt.prototype.className=qf;bt.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];tn(bt);C.overWriteSetter(bt,"width",xs());C.overWriteSetter(bt,"height",xs());C.addGetterSetter(bt,"direction",ol);C.addGetterSetter(bt,"fontFamily","Arial");C.addGetterSetter(bt,"fontSize",12,K());C.addGetterSetter(bt,"fontStyle",cl);C.addGetterSetter(bt,"fontVariant",cl);C.addGetterSetter(bt,"padding",0,K());C.addGetterSetter(bt,"align",ll);C.addGetterSetter(bt,"verticalAlign",Kf);C.addGetterSetter(bt,"lineHeight",1,K());C.addGetterSetter(bt,"wrap",$f);C.addGetterSetter(bt,"ellipsis",!1,Be());C.addGetterSetter(bt,"letterSpacing",0,K());C.addGetterSetter(bt,"text","",Fn());C.addGetterSetter(bt,"textDecoration","");C.addGetterSetter(bt,"charRenderFunc",void 0);function au(n,t){ne(t,!0);let e=b(t,"staticConfig",3,!1),i=b(t,"x",15),r=b(t,"y",15),s=b(t,"scale",15),a=b(t,"scaleX",15),o=b(t,"scaleY",15),l=b(t,"rotation",15),c=b(t,"skewX",15),f=b(t,"skewY",15),u=Wt(t,["$$slots","$$events","$$legacy","staticConfig","x","y","scale","scaleX","scaleY","rotation","skewX","skewY"]);const h=new bt({x:i(),y:r(),scale:s(),scaleX:a(),scaleY:o(),rotation:l(),skewX:c(),skewY:f(),...u});if(Wi().add(h),!e()){const d=h.getAttrs();h.on("transformend",()=>{i()!==void 0&&i(d.x),r()!==void 0&&r(d.y),s()!==void 0&&s(d.scale),a()!==void 0&&a(d.scaleX),o()!==void 0&&o(d.scaleY),l()!==void 0&&l(d.rotation),c()!==void 0&&c(d.skewX),f()!==void 0&&f(d.skewY)}),h.on("dragend",()=>{i()!==void 0&&i(d.x),r()!==void 0&&r(d.y)})}Object.keys(u).filter(d=>!d.startsWith("on")).forEach(d=>{M(()=>{h.setAttr(d,u[d])})}),M(()=>{h.setAttr("x",i())}),M(()=>{h.setAttr("y",r())}),M(()=>{h.setAttr("scale",s())}),M(()=>{h.setAttr("scaleX",a())}),M(()=>{h.setAttr("scaleY",o())}),M(()=>{h.setAttr("rotation",l())}),M(()=>{h.setAttr("skewX",c())}),M(()=>{h.setAttr("skewY",f())}),Nn(u,h),In(()=>{h.destroy()});var p={node:h};return ie(p)}class fl{#t;#e;constructor(t,e){this.#t=t,this.#e=$a(e)}get current(){return this.#e(),this.#t()}}const ou=new fl(()=>window.innerWidth,n=>Ro(window,"resize",n)),lu=new fl(()=>window.innerHeight,n=>Ro(window,"resize",n));var ve=(n=>(n[n.PlaceDrop=0]="PlaceDrop",n[n.PlaceLine=1]="PlaceLine",n[n.DeleteDrop=2]="DeleteDrop",n))(ve||{}),de=(n=>(n[n.NotChecked=0]="NotChecked",n[n.Failed=1]="Failed",n[n.Passed=2]="Passed",n))(de||{});const Ls=parseFloat(getComputedStyle(document.documentElement).fontSize);class cu{pos;constructor(t=[0,0]){this.pos=t}#t=Ot(0);get feasibilityPassed(){return v(this.#t)}set feasibilityPassed(t){O(this.#t,t,!0)}}function ul(){const n=ou.current??0,t=lu.current??0,e=Math.min(n,t),i=Math.max(Math.min(n/t,1),0),r=e-6*Ls,s=Math.min(n,t)*.5;return Math.max(0,r*(1-i)+s*i)}const hu=lt(ul);let fu=lt(()=>v(hu)-6*Ls),uu=lt(()=>v(fu)/2);class du{#t=Ot(De([0,0]));get pos(){return v(this.#t)}set pos(t){O(this.#t,t,!0)}#e=Ot(0);get rot(){return v(this.#e)}set rot(t){O(this.#e,t,!0)}#i=Ot(200);get diameter(){return v(this.#i)}set diameter(t){O(this.#i,t,!0)}#n=lt(()=>this.diameter/2);get radius(){return v(this.#n)}set radius(t){O(this.#n,t)}#l=lt(()=>v(uu)/this.radius);get scale(){return v(this.#l)}set scale(t){O(this.#l,t)}#r=Ot(De([]));get drops(){return v(this.#r)}set drops(t){O(this.#r,t,!0)}}class Aa{constructor(t,e){if(this.maxLength=t,this.data=[],e)if(e.length>t){const i=e.length-t;this.data.push(...e.slice(i))}else this.data.push(...e)}data;push(...t){for(;this.data.length+t.length>this.maxLength;)this.data.shift();return this.data.push(...t)}get length(){return this.data.length}}class gu{#t;get index(){return v(this.#t)}set index(t){O(this.#t,t,!0)}queue;maxLength;constructor(t){this.maxLength=t,this.queue=new Aa(t),this.queue.push([]),this.#t=Ot(0)}undo(){return this.index>0&&this.index--,this.queue.data[this.index]}redo(){return this.index<this.queue.length-1&&this.index++,this.queue.data[this.index]}add(t){if(this.index<this.queue.length-1){const e=this.queue.data.slice(0,this.index+1);this.queue=new Aa(this.maxLength,e)}return this.queue.push([...t]),this.index<this.maxLength-1&&this.index++,this.index}}const x=De({interactionMode:0,checkStatus:0,dropHistory:new gu(64),wafer:new du,historyUpdateCallback:void 0,tools:{numLinePts:10},settings:{DropDeleteDistanceThreshold:5,WaferUnusedEdgeThickness:10,centreTolerance:1,cameraViewWidth:20,waferDiameter:200,stage:{xRange:{min:-100,max:100},yRange:{min:-100,max:100}}},colors:{background:"#111",stroke:"#444",text:"#ccc"},keyPresses:{shift:!1}});let Ta=localStorage?.getItem("userSettings");Ta&&(x.settings=JSON.parse(Ta));function Pi(n,t){t=t*(Math.PI/180);let e=n[0]*Math.cos(t)-n[1]*Math.sin(t),i=n[0]*Math.sin(t)+n[1]*Math.cos(t);return[e,i]}const Ra=(n,t,e)=>n*(1-e)+t*e;function pu(n,t,e){let i=Ra(n[0],t[0],e),r=Ra(n[1],t[1],e);return[i,r]}const vu=5;function _u(n,t,e,i,r,s,a){const o=n[t][0]*s+n[t][1]*a+r;if(o>e||o<-e)return!1;let l=0;for(let c=0;c<n.length;c++){const[f,u]=n[c],h=f*s+u*a+r;if(h<i/2&&h>-(i/2)&&l++,l>1)return!1}if(l===1){const[c,f]=n[t],u=c*a-f*s,h=c*s+f*a;if(x.settings.stage.xRange.min<u&&u<x.settings.stage.xRange.max&&x.settings.stage.yRange.min<h&&h<x.settings.stage.yRange.max)return!0}return!1}function mu(n,t,e,i,r){const s=x.wafer.radius;for(let a=0;a<360;a+=vu){const o=a*(Math.PI/180),l=Math.sin(o),c=Math.cos(o);for(let f=-s;f<=s;f+=r)if(_u(n,t,e,i,f,l,c))return!0}return!1}function dl(n,t=2,e=10,i=5){let r=n.map(f=>Math.hypot(f[0],f[1])),s=Array.from(r.keys());s.sort((f,u)=>r[f]-r[u]);let a=[];for(let f=0;f<n.length;f++)a.push(n[s[f]]);const o=[];for(let f=0;f<a.length;f++){let u=a.slice(0,f+1);o.push(mu(u,f,t,e,i))}if(i>1&&!o.every(f=>f))return dl(n,t,e,1);let l=Array.from(o.keys());l.sort((f,u)=>s[f]-s[u]);let c=[];for(let f=0;f<a.length;f++)c.push(o[l[f]]);return c}vc();function La(n){return Object.prototype.toString.call(n)==="[object Date]"}function fs(n,t,e,i){if(typeof e=="number"||La(e)){const r=i-e,s=(e-t)/(n.dt||1/60),a=n.opts.stiffness*r,o=n.opts.damping*s,l=(a-o)*n.inv_mass,c=(s+l)*n.dt;return Math.abs(c)<n.opts.precision&&Math.abs(r)<n.opts.precision?i:(n.settled=!1,La(e)?new Date(e.getTime()+c):e+c)}else{if(Array.isArray(e))return e.map((r,s)=>fs(n,t[s],e[s],i[s]));if(typeof e=="object"){const r={};for(const s in e)r[s]=fs(n,t[s],e[s],i[s]);return r}else throw new Error(`Cannot spring ${typeof e} values`)}}function yu(n,t={}){const e=fh(n),{stiffness:i=.15,damping:r=.8,precision:s=.01}=t;let a,o,l,c=n,f=n,u=1,h=0,p=!1;function d(g,y={}){f=g;const L=l={};return n==null||y.hard||w.stiffness>=1&&w.damping>=1?(p=!0,a=we.now(),c=g,e.set(n=f),Promise.resolve()):(y.soft&&(h=1/((y.soft===!0?.5:+y.soft)*60),u=0),o||(a=we.now(),p=!1,o=ih(I=>{if(p)return p=!1,o=null,!1;u=Math.min(u+h,1);const E=Math.min(I-a,1e3/30),A={inv_mass:u,opts:w,settled:!0,dt:E*60/1e3},Y=fs(A,c,n,f);return a=I,c=n,e.set(n=Y),A.settled&&(o=null),!A.settled})),new Promise(I=>{o.promise.then(()=>{L===l&&I()})}))}const w={set:d,update:(g,y)=>d(g(f,n),y),subscribe:e.subscribe,stiffness:i,damping:r,precision:s};return w}function wn(n){return typeof n=="number"&&!isNaN(n)&&isFinite(n)}const Nt=(n,t=2)=>parseFloat((+n).toFixed(t)),Da=function(n,t,e){return n<=t?t:n>=e?e:n},Ut=function(n,t,e,i=2){let r=(n-t)/(e-t)*100;return isNaN(r)||r<=0?0:r>=100?100:Nt(r,i)},bu=function(n,t,e){return(e-t)/100*n+t},We=function(n,t,e,i,r=2,s=null){if(n=wn(n)?n:s?.[0]??t,n<=(s?.[0]??t)||n>=(s?.[1]??e))return n=Da(n,s?.[0]??t,s?.[1]??e);let a=(n-t)%i,o=n-a;return Math.abs(a)*2>=i?o+=a>0?i:-i:n>=e-a&&(o=e),o=Da(o,s?.[0]??t,s?.[1]??e),Nt(o,r)},wu=(n="")=>`${n}`.replace(/<[^>]*>/g,""),Jn=n=>{const{clientX:t,clientY:e}="touches"in n?n.touches[0]||n.changedTouches[0]:n;return{x:t,y:e}},Oa=n=>{if(!n)return-1;for(var t=0;n=n.previousElementSibling;)t++;return t},jr=(n,t,e)=>{if(e==="min")return t[0]>n;if(e==="max")return t[0]<n;if(e)return t[0]<n&&t[1]>n},qr=(n,t)=>t?n<t[0]||n>t[1]:!1,Kr=(n,t,e=2)=>t.some(i=>Nt(i,e)===Nt(n,e)),Ma=(n,t,e,i,r,s=2)=>Nt(t+n*r*i,s),lr=(n,t,e,i,r,s)=>{const a=n.getBoundingClientRect();let o=0,l=0,c=0;return e?(o=t.y-a.top,l=o/a.height*100,l=i?l:100-l):(o=t.x-a.left,l=o/a.width*100,l=i?100-l:l),c=bu(l,r,s),{pointerVal:c,pointerPercent:l}};var Cu=J('<span class="rsPipValPrefix"> </span>'),Su=J('<span class="rsPipValSuffix"> </span>'),xu=J('<span class="rsPipVal"><!> <!> <!></span>'),ku=J("<span><!></span>"),Eu=J('<span class="rsPipValPrefix"> </span>'),Pu=J('<span class="rsPipValSuffix"> </span>'),Au=J('<span class="rsPipVal"><!> <!> <!></span>'),Tu=J("<span><!></span>"),Ru=J('<span class="rsPipValPrefix"> </span>'),Lu=J('<span class="rsPipValSuffix"> </span>'),Du=J('<span class="rsPipVal"><!> <!> <!></span>'),Ou=J("<span><!></span>"),Mu=J("<div><!> <!> <!></div>");function Iu(n,t){ne(t,!1);const e=Ft(),i=Ft();let r=b(t,"range",8,!1),s=b(t,"min",8,0),a=b(t,"max",8,100),o=b(t,"step",8,1),l=b(t,"value",24,()=>(a()+s())/2),c=b(t,"values",24,()=>[l()]),f=b(t,"vertical",8,!1),u=b(t,"reversed",8,!1),h=b(t,"hoverable",8,!0),p=b(t,"disabled",8,!1),d=b(t,"limits",8,null),w=b(t,"pipstep",24,()=>{}),g=b(t,"all",8,!0),y=b(t,"first",24,()=>{}),L=b(t,"last",24,()=>{}),I=b(t,"rest",24,()=>{}),E=b(t,"prefix",8,""),A=b(t,"suffix",8,""),Y=b(t,"formatter",8,(N,X,j)=>N),T=b(t,"precision",8,2),R=b(t,"focus",8),W=b(t,"orientationStart",8),z=b(t,"moveHandle",8),q=null,ft=Ft(0);const wt=500;let gt=Ft(1);function vt(N){q=Jn(N)}function _t(N,X){const j=Jn(X);!p()&&q&&(Math.sqrt(Math.pow(q.x-j.x,2)+Math.pow(q.y-j.y,2))<=5&&z()(null,N),q=null)}Dt(()=>S(f()),()=>{O(e,f()?50:100)}),Dt(()=>(S(a()),S(s()),S(o()),v(e)),()=>{O(i,(a()-s())/o()>=v(e))}),Dt(()=>(v(gt),S(w()),v(i),S(a()),S(s()),v(e),v(ft),S(o())),()=>{if(O(gt,w()??(v(i)?(a()-s())/(v(e)/5):1)),O(ft,Math.ceil((a()-s())/(o()*v(gt)))),v(ft)>wt)for(console.warn('RangePips: You are trying to render too many pips. This will cause performance issues. Try increasing the "pipstep" prop to reduce the number of pips shown.');v(ft)>=wt;)O(gt,v(gt)+v(gt)),O(ft,Math.ceil((a()-s())/(o()*v(gt))))}),uo(),No();var at=Mu();let Mt;var Vt=F(at);{var Jt=N=>{var X=ku();let j;ct(X,"data-index",0);var Tt=F(X);{var Pt=Z=>{var it=xu(),ut=F(it);{var Ct=mt=>{var At=Cu(),tt=F(At);yt(()=>ae(tt,E())),H(mt,At)};st(ut,mt=>{E()&&mt(Ct)})}var Rt=G(ut,2);Sn(Rt,()=>(S(Y()),S(Nt),S(s()),S(T()),$(()=>Y()(Nt(s(),T()),0,0))));var St=G(Rt,2);{var xt=mt=>{var At=Su(),tt=F(At);yt(()=>ae(tt,A())),H(mt,At)};st(St,mt=>{A()&&mt(xt)})}H(Z,it)};st(Tt,Z=>{(g()==="label"||y()==="label")&&Z(Pt)})}yt((Z,it)=>{j=Se(X,1,"rsPip rsPip--first",null,j,Z),ln(X,`${W()??""}: 0%;`),ct(X,"data-val",it)},[()=>({rsSelected:Kr(s(),c(),T()),rsInRange:jr(s(),c(),r()),rsOutOfLimit:qr(s(),d())}),()=>(S(Nt),S(s()),S(T()),$(()=>Nt(s(),T())))]),pt("pointerdown",X,Z=>{vt(Z)}),pt("pointerup",X,Z=>{_t(s(),Z)}),H(N,X)};st(Vt,N=>{(g()&&y()!==!1||y())&&N(Jt)})}var Zt=G(Vt,2);{var ce=N=>{var X=dn(),j=_e(X);_r(j,1,()=>(v(ft),$(()=>Array(v(ft)))),vr,(Tt,Pt,Z)=>{const it=qt(()=>(S(Ma),S(s()),S(a()),v(gt),S(o()),S(T()),$(()=>Ma(Z,s(),a(),v(gt),o(),T()))));var ut=dn(),Ct=_e(ut);{var Rt=St=>{var xt=Tu();let mt;ct(xt,"data-index",Z);var At=F(xt);{var tt=kt=>{var zt=Au(),gn=F(zt);{var he=Qt=>{var fe=Eu(),re=F(fe);yt(()=>ae(re,E())),H(Qt,fe)};st(gn,Qt=>{E()&&Qt(he)})}var Pe=G(gn,2);Sn(Pe,()=>(S(Y()),S(v(it)),S(Ut),S(s()),S(a()),S(T()),$(()=>Y()(v(it),Z,Ut(v(it),s(),a(),T())))));var ye=G(Pe,2);{var He=Qt=>{var fe=Pu(),re=F(fe);yt(()=>ae(re,A())),H(Qt,fe)};st(ye,Qt=>{A()&&Qt(He)})}H(kt,zt)};st(At,kt=>{(g()==="label"||I()==="label")&&kt(tt)})}yt((kt,zt)=>{mt=Se(xt,1,"rsPip",null,mt,kt),ln(xt,`${W()??""}: ${zt??""}%;`),ct(xt,"data-val",v(it))},[()=>({rsSelected:Kr(v(it),c(),T()),rsInRange:jr(v(it),c(),r()),rsOutOfLimit:qr(v(it),d())}),()=>(S(Ut),S(v(it)),S(s()),S(a()),S(T()),$(()=>Ut(v(it),s(),a(),T())))]),pt("pointerdown",xt,kt=>{vt(kt)}),pt("pointerup",xt,kt=>{_t(v(it),kt)}),H(St,xt)};st(Ct,St=>{v(it)>s()&&v(it)<a()&&St(Rt)})}H(Tt,ut)}),H(N,X)};st(Zt,N=>{(g()&&I()!==!1||I())&&N(ce)})}var oi=G(Zt,2);{var U=N=>{var X=Ou();let j;var Tt=F(X);{var Pt=Z=>{var it=Du(),ut=F(it);{var Ct=mt=>{var At=Ru(),tt=F(At);yt(()=>ae(tt,E())),H(mt,At)};st(ut,mt=>{E()&&mt(Ct)})}var Rt=G(ut,2);Sn(Rt,()=>(S(Y()),S(Nt),S(a()),S(T()),v(ft),$(()=>Y()(Nt(a(),T()),v(ft),100))));var St=G(Rt,2);{var xt=mt=>{var At=Lu(),tt=F(At);yt(()=>ae(tt,A())),H(mt,At)};st(St,mt=>{A()&&mt(xt)})}H(Z,it)};st(Tt,Z=>{(g()==="label"||L()==="label")&&Z(Pt)})}yt((Z,it)=>{j=Se(X,1,"rsPip rsPip--last",null,j,Z),ln(X,`${W()??""}: 100%;`),ct(X,"data-val",it),ct(X,"data-index",v(ft))},[()=>({rsSelected:Kr(a(),c(),T()),rsInRange:jr(a(),c(),r()),rsOutOfLimit:qr(a(),d())}),()=>(S(Nt),S(a()),S(T()),$(()=>Nt(a(),T())))]),pt("pointerdown",X,Z=>{vt(Z)}),pt("pointerup",X,Z=>{_t(a(),Z)}),H(N,X)};st(oi,N=>{(g()&&L()!==!1||L())&&N(U)})}yt(()=>Mt=Se(at,1,"rangePips",null,Mt,{rsDisabled:p(),rsHoverable:h(),rsVertical:f(),rsReversed:u(),rsFocus:R()})),H(n,at),ie()}var Gu=J('<span class="rangeFloatPrefix"> </span>'),Fu=J('<span class="rangeFloatSuffix"> </span>'),Nu=J('<span class="rangeFloat"><!><!><!></span>'),Bu=J('<span role="slider"><span class="rangeNub"></span> <!></span>'),Hu=J('<span class="rangeLimit"></span>'),Yu=J('<span class="rangeFloatPrefix"> </span>'),Xu=J('<span class="rangeFloatSuffix"> </span>'),Wu=J('<span class="rangeFloatPrefix"> </span>'),Vu=J('<span class="rangeFloatSuffix"> </span>'),Uu=J("<!><!><!> <!><!><!>",1),zu=J('<span class="rangeFloat"><!></span>'),ju=J("<span><!></span>"),qu=J('<div role="none"><!> <!> <!> <!></div>');function Ia(n,t){ne(t,!1);const e=()=>dh(v(he),"$springPositions",i),[i,r]=ph(),s=Ft(),a=Ft(),o=Ft();let l=b(t,"slider",28,()=>{}),c=b(t,"precision",8,2),f=b(t,"range",8,!1),u=b(t,"pushy",8,!1),h=b(t,"draggy",8,!1),p=b(t,"min",12,0),d=b(t,"max",12,100),w=b(t,"step",12,1),g=b(t,"values",28,()=>[Nt((d()+p())/2,c())]),y=b(t,"value",28,()=>g()[0]),L=b(t,"vertical",8,!1),I=b(t,"float",8,!1),E=b(t,"rangeFloat",8,!1),A=b(t,"reversed",8,!1),Y=b(t,"hoverable",8,!0),T=b(t,"disabled",8,!1),R=b(t,"limits",8,null),W=b(t,"rangeGapMin",12,0),z=b(t,"rangeGapMax",12,1/0),q=b(t,"pips",8,!1),ft=b(t,"pipstep",24,()=>{}),wt=b(t,"all",8,!0),gt=b(t,"first",24,()=>{}),vt=b(t,"last",24,()=>{}),_t=b(t,"rest",24,()=>{}),at=b(t,"prefix",8,""),Mt=b(t,"suffix",8,""),Vt=b(t,"formatter",12,(m,k,V)=>m),Jt=b(t,"handleFormatter",28,Vt),Zt=b(t,"rangeFormatter",12,null),ce=b(t,"ariaLabels",28,()=>[]),oi=b(t,"id",24,()=>{}),U=b(t,"class",8,""),N=b(t,"style",24,()=>{}),X=b(t,"darkmode",8,!1),j=b(t,"springValues",24,()=>({stiffness:.15,damping:.4})),Tt=b(t,"spring",8,!0);const Pt=yh();let Z=Ft(!1),it=Ft(0),ut=Ft(!1),Ct=!1,Rt=Ft(!1),St=!1,xt=Ft(!1),mt=[1,1],At=!1,tt=Ft(-1),kt=[],zt=[],gn=Ft(0),he=Ft();const Pe=()=>{fe(),g()[0]!==y()&&g(g()[0]=y(),!0)},ye=()=>{Qt(),y()!==g()[0]&&y(g()[0])},He=()=>{wn(p())||(p(0),console.error("'min' prop must be a valid finite Number")),wn(d())||(d(100),console.error("'max' prop must be a valid finite Number")),p()>=d()&&(p(0),d(100),console.error("'min' prop should be less than 'max'")),p(Nt(p(),c())),d(Nt(d(),c()))},Qt=()=>{wn(y())||(y((d()+p())/2),console.error("'value' prop should be a Number"))},fe=()=>{Array.isArray(g())?g().some(m=>!wn(m))&&(g(g().map(m=>wn(m)?m:(d()+p())/2)),console.error("'values' prop should be an Array of Numbers")):(g([y()]),console.error("'values' prop should be an Array"))},re=()=>{(!wn(w())||w()<=0)&&(w(1),console.error("'step' prop must be a positive Number"))},Hn=()=>{g().length>1&&!Array.isArray(ce())&&(ce([]),console.warn("'ariaLabels' prop should be an Array"))},pn=()=>{if(g(g().map(m=>We(m,p(),d(),w(),c(),R()))),W()<0&&W(0),z()<0&&z(1/0),W()>z()&&W(z()),z()<1/0){const m=We(g()[0]+z(),p(),d(),w(),c(),R());g()[1]>m&&g(g()[1]=m,!0)}if(W()>0){const m=We(g()[0]+W(),p(),d(),w(),c(),R());g()[1]<m&&g(g()[1]=m,!0)}},Yn=()=>{(Vt()===null||Vt()===void 0)&&(console.error("formatter must be a function"),Vt((m,k,V)=>m)),(Jt()===null||Jt()===void 0)&&(console.error("handleFormatter must be a function"),Jt(Vt())),Zt()===void 0&&(console.error("rangeFormatter must be a function, or null"),Zt(null))};He(),Qt(),fe(),re(),pn(),Yn();const li=m=>{gh(O(he,yu(m.map(k=>Ut(k,p(),d())),j())),"$springPositions",i)},Ui=m=>{requestAnimationFrame(()=>{v(he).set(m.map(k=>Ut(k,p(),d())),{hard:!Tt()})})},Rr=()=>{v(he)&&(Ks(he,v(he).stiffness=j().stiffness??.15),Ks(he,v(he).damping=j().damping??.4))};function Lr(m){return requestAnimationFrame(()=>{if(m){const k=m.getBoundingClientRect();O(gn,L()?k.height:k.width)}})}let Xn,vn;Ss(()=>(l()&&(Xn=new ResizeObserver(m=>{vn&&cancelAnimationFrame(vn),vn=Lr(m[0].target)}),Xn.observe(l()),setTimeout(()=>{O(Z,!0)},16)),()=>{vn&&cancelAnimationFrame(vn),Xn?.disconnect?.(),O(Z,!1)}));function Dr(m){if(!l())return!1;const k=l().querySelectorAll(".handle"),V=Array.prototype.includes.call(k,m),Et=Array.prototype.some.call(k,It=>It.contains(m));return V||Et}function gl(m,k){return k==="min"||k==="max"?m.slice(0,1):k?m.slice(0,2):m}function pl(m){if(!l())return 0;const{pointerVal:k}=lr(l(),m,L(),A(),p(),d());let V=0;return f()===!0&&g()[0]===g()[1]?k>g()[1]?V=1:V=0:V=g().indexOf([...g()].sort((Et,It)=>Math.abs(k-Et)-Math.abs(k-It))[0]),V}function Or(m){if(!l()||!Ct)return;const{pointerVal:k}=lr(l(),m,L(),A(),p(),d());nn(v(tt),k)}function vl(m){if(!l()||!h()||!St||f()==="min"||f()==="max")return;const{pointerVal:k}=lr(l(),m,L(),A(),p(),d());mt=[g()[0]-k,g()[1]-k]}function _l(m){if(!l()||!h()||!St||f()==="min"||f()==="max")return;const{pointerVal:k}=lr(l(),m,L(),A(),p(),d());O(tt,-1),nn(0,k+mt[0],!1),nn(1,k+mt[1],!0)}function nn(m,k,V=!0){return k=We(k,p(),d(),w(),c(),R()),m===null&&(m=v(tt)),f()===!0&&(m===0?k>g()[1]-W()?u()&&k<=(R()?.[1]??d())-W()?g(g()[1]=k+W(),!0):k=g()[1]-W():k<g()[1]-z()&&(u()?g(g()[1]=k+z(),!0):k=g()[1]-z()):m===1&&(k<g()[0]+W()?u()&&k>=(R()?.[0]??p())+W()?g(g()[0]=k-W(),!0):k=g()[0]+W():k>g()[0]+z()&&(u()?g(g()[0]=k-z(),!0):k=g()[0]+z()))),g()[m]!==k&&g(g()[m]=We(k,p(),d(),w(),c(),R()),!0),V&&ml(g()),k}function ml(m){(zt.some((V,Et)=>V!==m[Et])||zt.length!==m.length)&&(Al(),zt=[...m])}function yl(m){return f()==="min"?0:m[0]}function bl(m){return f()==="max"?100:f()==="min"?m[0]:m[1]}function wl(m){m.target,At&&(O(ut,!1),Ct=!1,O(Rt,!1),St=!1,O(xt,!1))}function Cl(m){const k=m.target;T()||(O(tt,Oa(k)),O(ut,!0))}function Sl(m){if(!T()){let k=!1;const V=Oa(m.target);let Et=w();if(m.ctrlKey||m.metaKey){const It=(d()-p())/100;Et=Math.max(w(),Math.round(It/w())*w())}else if(m.shiftKey||m.key==="PageUp"||m.key==="PageDown"){const It=(d()-p())/10;Et=Math.max(w(),Math.round(It/w())*w())}switch(m.key){case"PageUp":case"ArrowRight":case"ArrowUp":ci(),nn(V,g()[V]+Et),k=!0;break;case"PageDown":case"ArrowLeft":case"ArrowDown":ci(),nn(V,g()[V]-Et),k=!0;break;case"Home":ci(),nn(V,p()),k=!0;break;case"End":ci(),nn(V,d()),k=!0;break}k&&(m.preventDefault(),m.stopPropagation())}}function ci(){kt=g().map(m=>We(m,p(),d(),w(),c(),R())),zt=[...kt]}function Ds(m){if(!T()){const k=m.target,V=Jn(m);O(ut,!0),k.matches(".rangeBar")&&f()===!0&&h()?(Ct=!1,O(Rt,!1),O(tt,-1),St=!0,O(xt,!0),vl(V)):(Ct=!0,O(Rt,!0),O(tt,pl(V)),m.type==="touchstart"&&!k.closest(".rsPipVal")&&Or(V)),ci(),Pl()}}function Os(m){m.type==="touchend"&&Gs(),O(Rt,!1),O(xt,!1)}function Ms(m){const k=m.target;At=!1,l()&&v(ut)&&k!==l()&&!l().contains(k)&&O(ut,!1)}function Is(m){T()||(Ct?Or(Jn(m)):St&&_l(Jn(m)))}function xl(m){if(!T()){const k=m.target;Ct&&l()&&(k===l()||l().contains(k))&&(O(ut,!0),!Dr(k)&&!k.closest(".rsPipVal")&&Or(Jn(m))),(Ct||St)&&Gs()}Ct=!1,O(Rt,!1),St=!1,O(xt,!1)}function kl(m){Ct=!1,O(Rt,!1),St=!1,O(xt,!1)}function El(m){const k=m.target;!T()&&l()&&(k===l()||l().contains(k))&&(At=!0)}function Pl(){T()||Pt("start",{activeHandle:v(tt),value:kt[v(tt)],values:kt})}function Gs(){if(T())return;const m=St?kt:kt[v(tt)];Pt("stop",{activeHandle:v(tt),startValue:m,value:g()[v(tt)],values:g().map(k=>We(k,p(),d(),w(),c(),R()))})}function Al(){if(T())return;const m=St?kt:kt[v(tt)],k=zt.length===0?m:St?zt:zt[v(tt)];Pt("change",{activeHandle:v(tt),startValue:m,previousValue:k,value:g()[v(tt)],values:g().map(V=>We(V,p(),d(),w(),c(),R()))})}function Tl(m,k){const V=Ut(m,p(),d(),c()),Et=Jt()(m,k,V),It=wu(String(Et));return`${at()}${It}${Mt()}`}Dt(()=>S(y()),()=>{y(),Pe()}),Dt(()=>(S(f()),S(p()),S(d()),S(w()),S(c()),S(R()),v(it),S(l()),S(g()),S(y())),()=>{((m,k)=>{const Et=gl(m,f()).map(It=>We(It,p(),d(),w(),c(),R()));(m.length!==Et.length||!m.every((It,Ye)=>Nt(It,c())===Et[Ye]))&&(m=Et),v(it)!==m.length?li(m):l()&&Ui(m),g(m),O(it,m.length)})(g(),y())}),Dt(()=>S(g()),()=>{g(),ye()}),Dt(()=>S(ce()),()=>{ce(),Hn()}),Dt(()=>S(p()),()=>{p(),He()}),Dt(()=>S(d()),()=>{d(),He()}),Dt(()=>S(w()),()=>{w(),re()}),Dt(()=>S(W()),()=>{W(),pn()}),Dt(()=>S(z()),()=>{z(),pn()}),Dt(()=>S(Vt()),()=>{Vt(),Yn()}),Dt(()=>S(Jt()),()=>{Jt(),Yn()}),Dt(()=>S(Zt()),()=>{Zt(),Yn()}),Dt(()=>S(j()),()=>{j(),Rr()}),Dt(()=>(S(f()),S(g())),()=>{O(s,f()===!0&&g().length===2||(f()==="min"||f()==="max")&&g().length===1)}),Dt(()=>(S(L()),S(A())),()=>{O(a,L()?A()?"top":"bottom":A()?"right":"left")}),Dt(()=>(S(L()),S(A())),()=>{O(o,L()?A()?"bottom":"top":A()?"left":"right")}),uo(),No();var Ae=qu();pt("mousedown",je,Ms),pt("touchstart",je,Ms),pt("mousemove",je,Is),pt("touchmove",je,Is),pt("mouseup",je,xl),pt("touchend",je,kl),pt("keydown",je,El);let Fs;var Ns=F(Ae);_r(Ns,1,g,vr,(m,k,V,Et)=>{const It=qt(()=>v(ut)&&v(tt)===V?"z-index: 3; ":""),Ye=qt(()=>v(Z)?"":"opacity: 0; ");var Lt=Bu();let zi;ct(Lt,"data-handle",V);var Mr=G(F(Lt),2);{var hi=rn=>{const fi=qt(()=>(S(Ut),v(k),S(p()),S(d()),S(c()),$(()=>Ut(v(k),p(),d(),c())))),Te=qt(()=>(S(Jt()),v(k),S(v(fi)),$(()=>Jt()(v(k),V,v(fi)))));var ui=Nu(),ji=F(ui);{var Ir=ue=>{var _n=Gu(),Wn=F(_n);yt(()=>ae(Wn,at())),H(ue,_n)};st(ji,ue=>{at()&&ue(Ir)})}var qi=G(ji);Sn(qi,()=>v(Te));var Re=G(qi);{var Xe=ue=>{var _n=Fu(),Wn=F(_n);yt(()=>ae(Wn,Mt())),H(ue,_n)};st(Re,ue=>{Mt()&&ue(Xe)})}H(rn,ui)};st(Mr,rn=>{I()&&rn(hi)})}yt(rn=>{zi=Se(Lt,1,"rangeHandle",null,zi,{rsActive:v(ut)&&v(tt)===V,rsPress:v(Rt)&&v(tt)===V}),ln(Lt,(e(),S(v(It)),S(v(Ye)),$(()=>`--handle-pos: ${e()[V]};${v(It)}${v(Ye)}`))),ct(Lt,"aria-label",(S(ce()),$(()=>ce()[V]))),ct(Lt,"aria-valuemin",(S(f()),S(g()),S(p()),$(()=>f()===!0&&V===1?g()[0]:p()))),ct(Lt,"aria-valuemax",(S(f()),S(g()),S(d()),$(()=>f()===!0&&V===0?g()[1]:d()))),ct(Lt,"aria-valuenow",v(k)),ct(Lt,"aria-valuetext",rn),ct(Lt,"aria-orientation",L()?"vertical":"horizontal"),ct(Lt,"aria-disabled",T()),ct(Lt,"tabindex",T()?-1:0)},[()=>(v(k),$(()=>Tl(v(k),V)))]),pt("blur",Lt,wl),pt("focus",Lt,Cl),pt("keydown",Lt,Sl),H(m,Lt)});var Bs=G(Ns,2);{var Rl=m=>{var k=Hu();yt((V,Et)=>ln(k,`${v(a)??""}: ${V??""}%;
             ${v(o)??""}: ${Et??""}%;`),[()=>(S(Ut),S(R()),S(p()),S(d()),S(c()),$(()=>Ut(R()[0],p(),d(),c()))),()=>(S(Ut),S(R()),S(p()),S(d()),S(c()),$(()=>100-Ut(R()[1],p(),d(),c())))]),H(m,k)};st(Bs,m=>{R()&&m(Rl)})}var Hs=G(Bs,2);{var Ll=m=>{const k=qt(()=>(e(),$(()=>yl(e())))),V=qt(()=>(e(),$(()=>bl(e())))),Et=qt(()=>v(V)-v(k)),It=qt(()=>v(Z)?"":"opacity: 0; ");var Ye=ju();let Lt;var zi=F(Ye);{var Mr=hi=>{const rn=qt(()=>(S(f()),S(p()),S(g()),$(()=>f()==="min"?p():g()[0]))),fi=qt(()=>(S(f()),S(d()),S(g()),$(()=>f()==="max"?d():f()==="min"?g()[0]:g()[1]))),Te=qt(()=>{const[Re,Xe]=A()?[v(fi),v(rn)]:[v(rn),v(fi)];return{first:Re,second:Xe}});var ui=zu(),ji=F(ui);{var Ir=Re=>{var Xe=dn(),ue=_e(Xe);Sn(ue,()=>(S(Zt()),S(v(Te).first),S(v(Te).second),S(Ut),S(p()),S(d()),S(c()),$(()=>Zt()(v(Te).first,v(Te).second,Ut(v(Te).first,p(),d(),c()),Ut(v(Te).second,p(),d(),c()))))),H(Re,Xe)},qi=Re=>{var Xe=Uu(),ue=_e(Xe);{var _n=jt=>{var be=Yu(),mn=F(be);yt(()=>ae(mn,at())),H(jt,be)};st(ue,jt=>{at()&&jt(_n)})}var Wn=G(ue);Sn(Wn,()=>v(Te).first);var Ys=G(Wn);{var Ml=jt=>{var be=Xu(),mn=F(be);yt(()=>ae(mn,Mt())),H(jt,be)};st(Ys,jt=>{Mt()&&jt(Ml)})}var Xs=G(Ys);Xs.nodeValue="  -  ";var Ws=G(Xs);{var Il=jt=>{var be=Wu(),mn=F(be);yt(()=>ae(mn,at())),H(jt,be)};st(Ws,jt=>{at()&&jt(Il)})}var Vs=G(Ws);Sn(Vs,()=>v(Te).second);var Gl=G(Vs);{var Fl=jt=>{var be=Vu(),mn=F(be);yt(()=>ae(mn,Mt())),H(jt,be)};st(Gl,jt=>{Mt()&&jt(Fl)})}H(Re,Xe)};st(ji,Re=>{Zt()?Re(Ir):Re(qi,!1)})}H(hi,ui)};st(zi,hi=>{E()&&hi(Mr)})}yt(()=>{Lt=Se(Ye,1,"rangeBar",null,Lt,{rsPress:v(xt)}),ln(Ye,`--range-start:${v(k)};--range-end:${v(V)};--range-size:${v(Et)};${v(It)};`)}),H(m,Ye)};st(Hs,m=>{v(s)&&m(Ll)})}var Dl=G(Hs,2);{var Ol=m=>{Iu(m,{get values(){return g()},get min(){return p()},get max(){return d()},get step(){return w()},get range(){return f()},get vertical(){return L()},get reversed(){return A()},get orientationStart(){return v(a)},get hoverable(){return Y()},get disabled(){return T()},get limits(){return R()},get all(){return wt()},get first(){return gt()},get last(){return vt()},get rest(){return _t()},get pipstep(){return ft()},get prefix(){return at()},get suffix(){return Mt()},get formatter(){return Vt()},get precision(){return c()},get focus(){return v(ut)},moveHandle:nn})};st(Dl,m=>{q()&&m(Ol)})}Cs(Ae,m=>l(m),()=>l()),yt(()=>{ct(Ae,"id",oi()),Fs=Se(Ae,1,`rangeSlider ${U()??""}`,null,Fs,{rsDark:X()==="force",rsAutoDark:X()==="auto",rsRange:v(s),rsDrag:v(s)&&h(),rsMin:v(s)&&f()==="min",rsMax:v(s)&&f()==="max",rsDisabled:T(),rsHoverable:Y(),rsVertical:L(),rsReversed:A(),rsFocus:v(ut),rsPips:q(),rsPipLabels:wt()==="label"||gt()==="label"||vt()==="label"||_t()==="label"}),ln(Ae,`--slider-length: ${v(gn)};${N()??""}`)}),pt("mousedown",Ae,Ds),pt("mouseup",Ae,Os),pt("touchstart",Ae,oa(Ds)),pt("touchend",Ae,oa(Os)),H(n,Ae),ie(),r()}var Ku=Ne('<svg><path fill="currentColor" d="M6.56 7.98C6.1 7.52 5.31 7.6 5 8.17c-.28.51-.5 1.03-.67 1.58c-.19.63.31 1.25.96 1.25h.01c.43 0 .82-.28.94-.7q.18-.6.48-1.17c.22-.37.15-.84-.16-1.15M5.31 13h-.02c-.65 0-1.15.62-.96 1.25c.16.54.38 1.07.66 1.58c.31.57 1.11.66 1.57.2c.3-.31.38-.77.17-1.15c-.2-.37-.36-.76-.48-1.16a.97.97 0 0 0-.94-.72m2.85 6.02q.765.42 1.59.66c.62.18 1.24-.32 1.24-.96v-.03c0-.43-.28-.82-.7-.94c-.4-.12-.78-.28-1.15-.48a.97.97 0 0 0-1.16.17l-.03.03c-.45.45-.36 1.24.21 1.55M13 4.07v-.66c0-.89-1.08-1.34-1.71-.71L9.17 4.83c-.4.4-.4 1.04 0 1.43l2.13 2.08c.63.62 1.7.17 1.7-.72V6.09c2.84.48 5 2.94 5 5.91c0 2.73-1.82 5.02-4.32 5.75a.97.97 0 0 0-.68.94v.02c0 .65.61 1.14 1.23.96A7.976 7.976 0 0 0 20 12c0-4.08-3.05-7.44-7-7.93"></path></svg>');function Ju(n,t){const e=Wt(t,["$$slots","$$events","$$legacy"]);var i=Ku();Ee(i,()=>({viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...e})),H(n,i)}var Zu=Ne('<svg><path fill="currentColor" d="M14.83 4.83L12.7 2.7c-.62-.62-1.7-.18-1.7.71v.66C7.06 4.56 4 7.92 4 12c0 3.64 2.43 6.71 5.77 7.68c.62.18 1.23-.32 1.23-.96v-.03a.97.97 0 0 0-.68-.94A5.98 5.98 0 0 1 6 12c0-2.97 2.16-5.43 5-5.91v1.53c0 .89 1.07 1.33 1.7.71l2.13-2.08a.99.99 0 0 0 0-1.42m4.84 4.93q-.24-.825-.66-1.59c-.31-.57-1.1-.66-1.56-.2l-.01.01c-.31.31-.38.78-.17 1.16c.2.37.36.76.48 1.16c.12.42.51.7.94.7h.02c.65 0 1.15-.62.96-1.24M13 18.68v.02c0 .65.62 1.14 1.24.96q.825-.24 1.59-.66c.57-.31.66-1.1.2-1.56l-.02-.02a.97.97 0 0 0-1.16-.17c-.37.21-.76.37-1.16.49c-.41.12-.69.51-.69.94m4.44-2.65c.46.46 1.25.37 1.56-.2c.28-.51.5-1.04.67-1.59c.18-.62-.31-1.24-.96-1.24h-.02c-.44 0-.82.28-.94.7q-.18.6-.48 1.17c-.21.38-.13.86.17 1.16"></path></svg>');function Qu(n,t){const e=Wt(t,["$$slots","$$events","$$legacy"]);var i=Zu();Ee(i,()=>({viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...e})),H(n,i)}var $u=Ne('<svg><path fill="currentColor" d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V9c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2zM18 4h-2.5l-.71-.71c-.18-.18-.44-.29-.7-.29H9.91c-.26 0-.52.11-.7.29L8.5 4H6c-.55 0-1 .45-1 1s.45 1 1 1h12c.55 0 1-.45 1-1s-.45-1-1-1"></path></svg>');function td(n,t){const e=Wt(t,["$$slots","$$events","$$legacy"]);var i=$u();Ee(i,()=>({viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...e})),H(n,i)}var ed=Ne('<svg><path fill="currentColor" d="M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4s4-1.79 4-4s-1.79-4-4-4m8.94 3A8.994 8.994 0 0 0 13 3.06V2c0-.55-.45-1-1-1s-1 .45-1 1v1.06A8.994 8.994 0 0 0 3.06 11H2c-.55 0-1 .45-1 1s.45 1 1 1h1.06A8.994 8.994 0 0 0 11 20.94V22c0 .55.45 1 1 1s1-.45 1-1v-1.06A8.994 8.994 0 0 0 20.94 13H22c.55 0 1-.45 1-1s-.45-1-1-1zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7s7 3.13 7 7s-3.13 7-7 7"></path></svg>');function nd(n,t){const e=Wt(t,["$$slots","$$events","$$legacy"]);var i=ed();Ee(i,()=>({viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...e})),H(n,i)}var id=J("<!> <!> <!> <!>",1),rd=J("<!> <!> <!>",1),sd=J('<article class="wafer-display"><div class="canvas-container"><!> <!></div> <!></article> <div class="toolbar rotation-toolbar"><button title="Rotate Anticlockwise"><!></button> <button title="Rotate Clockwise"><!></button> <button title="Clear Drops" class="shift-left"><!></button> <button title="Recentre Wafer" class="shift-right"><!></button></div> <div class="toolbar"><h3> </h3></div>',1);function ad(n,t){ne(t,!0);let e=lt(()=>t.canvasSize/2),i=lt(()=>t.canvasSize/2),r=lt(()=>t.canvasSize-6*t.rem),s=lt(()=>v(r)/2);const a=x.wafer;M(()=>{a.diameter=Math.max(2,x.settings.waferDiameter)});let o=lt(()=>x.keyPresses.shift&&a.diameter>40?a.diameter/40:a.diameter%2===0?1:.5);function l(U=[0,0]){Math.hypot(U[0],U[1])>a.radius||a.drops.push(new cu(U))}function c(U=[0,0],N=0){if(x.tools.numLinePts<2)return[];let X=N*Math.PI/180;X+=Math.PI/2,U=[Pi(U,-N)[0],0];let j=a.radius-x.settings.WaferUnusedEdgeThickness;if(a.radius-Math.abs(U[0])<x.settings.WaferUnusedEdgeThickness)return[];let Tt=Math.sqrt(j**2-U[0]**2),Pt=[Tt*Math.cos(X),Tt*Math.sin(X)];U=Pi(U,N);let Z=[U[0]-Pt[0],U[1]-Pt[1]],it=[U[0]+Pt[0],U[1]+Pt[1]],ut=[];for(let Ct=0;Ct<x.tools.numLinePts;Ct++){let Rt=Ct/(x.tools.numLinePts-1);ut.push(pu(Z,it,Rt))}return ut}function f(U=[0,0],N=0){const X=c(U,N);for(let j of X)l(j)}function u(U=[0,0]){const N=a.drops.map(j=>Math.hypot(j.pos[0]-U[0],j.pos[1]-U[1])),X=Array.from(N.keys());return X.sort((j,Tt)=>N[j]-N[Tt]),N[X[0]]<x.settings.DropDeleteDistanceThreshold?(a.drops.splice(X[0],1),!0):!1}function h(U){const N=U.target.getStage()?.findOne("Group");if(!N)return;const X=N.getRelativePointerPosition();if(!X)return;const j=[X.x-a.pos[0]*a.scale,X.y-a.pos[1]*a.scale],Tt=Pi(j,-a.rot);let Pt=[Tt[0]/a.scale,Tt[1]/a.scale];return x.keyPresses.shift?[Math.round(Pt[0]/v(o))*v(o),Math.round(Pt[1]/v(o))*v(o)]:Pt}function p(U){const N=h(U);switch(x.interactionMode){case ve.PlaceDrop:{l(N),x.dropHistory.add(a.drops),x.historyUpdateCallback&&x.historyUpdateCallback();break}case ve.PlaceLine:{f(N,-a.rot),x.dropHistory.add(a.drops),x.historyUpdateCallback&&x.historyUpdateCallback();break}case ve.DeleteDrop:{u(N)&&(x.dropHistory.add(a.drops),x.historyUpdateCallback&&x.historyUpdateCallback());break}}}function d(){x.checkStatus=de.NotChecked;let U=a.drops.map(j=>[j.pos[0],j.pos[1]]);if(U.length>400){x.checkStatus=de.NotChecked;for(let j of a.drops)j.feasibilityPassed=de.NotChecked;return}let N=dl(U,x.settings.centreTolerance,x.settings.cameraViewWidth);for(let j=0;j<U.length;j++)a.drops[j].feasibilityPassed=N[j]?de.Passed:de.Failed;let X=N.every(j=>j);x.checkStatus=X?de.Passed:de.Failed}x.historyUpdateCallback=d;let w=Ot(!1),g=Ot(De([0,0])),y=lt(()=>Pi(v(g),-a.rot));function L(U){let N=h(U);N&&O(g,N,!0),O(w,!0)}function I(U){let N=h(U);N&&O(g,N,!0),O(w,!1)}let E=Ot(!1);function A(U,N){return(U%N+N)%N}var Y=sd(),T=_e(Y),R=F(T),W=F(R);Wf(W,{get width(){return t.canvasSize},get height(){return t.canvasSize},children:(U,N)=>{Hf(U,{children:(X,j)=>{var Tt=rd(),Pt=_e(Tt);Yf(Pt,{x:0,y:0,get width(){return t.canvasSize},get height(){return t.canvasSize},get fill(){return x.colors.background}});var Z=G(Pt,2);Sa(Z,{get x(){return v(e)},get y(){return v(i)},onclick:p,children:(ut,Ct)=>{{let Rt=lt(()=>a.pos[0]*a.scale),St=lt(()=>a.pos[1]*a.scale);Sa(ut,{name:"Wafer",get x(){return v(Rt)},get y(){return v(St)},get rotation(){return a.rot},onmousemove:L,onmouseleave:I,children:(xt,mt)=>{var At=id(),tt=_e(At);nr(tt,{get radius(){return v(s)},get stroke(){return x.colors.stroke},get fill(){return x.colors.background},strokeWidth:5});var kt=G(tt,2);kf(kt,{x:0,get y(){return v(s)},angle:170,innerRadius:0,outerRadius:10,rotation:185,get fill(){return x.colors.background},get stroke(){return x.colors.stroke},strokeWidth:5});var zt=G(kt,2);_r(zt,17,()=>a.drops,vr,(Pe,ye)=>{{let He=lt(()=>v(ye).pos[0]*a.scale),Qt=lt(()=>v(ye).pos[1]*a.scale),fe=lt(()=>v(ye).feasibilityPassed===de.Failed?"#f00":v(ye).feasibilityPassed===de.Passed?"#7cf":x.colors.stroke);nr(Pe,{get x(){return v(He)},get y(){return v(Qt)},radius:2,get fill(){return v(fe)}})}});var gn=G(zt,2);{var he=Pe=>{var ye=dn(),He=_e(ye);{var Qt=re=>{{let Hn=lt(()=>v(g)[0]*a.scale),pn=lt(()=>v(g)[1]*a.scale);nr(re,{get x(){return v(Hn)},get y(){return v(pn)},radius:2,fill:"#7cf8"})}},fe=re=>{var Hn=dn(),pn=_e(Hn);{var Yn=li=>{var Ui=dn(),Rr=_e(Ui);_r(Rr,17,()=>c(v(g),-a.rot),vr,(Lr,Xn)=>{{let vn=lt(()=>v(Xn)[0]*a.scale),Dr=lt(()=>v(Xn)[1]*a.scale);nr(Lr,{get x(){return v(vn)},get y(){return v(Dr)},radius:2,fill:"#7cf8"})}}),H(li,Ui)};st(pn,li=>{x.interactionMode===ve.PlaceLine&&li(Yn)},!0)}H(re,Hn)};st(He,re=>{x.interactionMode===ve.PlaceDrop?re(Qt):re(fe,!1)})}H(Pe,ye)};st(gn,Pe=>{v(w)&&Pe(he)})}H(xt,At)},$$slots:{default:!0}})}},$$slots:{default:!0}});var it=G(Z,2);{let ut=lt(()=>t.canvasSize-t.rem),Ct=lt(()=>v(w)?x.interactionMode===ve.PlaceDrop?`(${v(y)[0].toFixed(2)}, ${v(y)[1].toFixed(2)})`:x.interactionMode===ve.PlaceLine?`${v(y)[0].toFixed(2)}`:"":v(E)?`${A(-a.rot,360)}Â°`:"");au(it,{x:0,get y(){return v(ut)},get text(){return v(Ct)},get fontSize(){return t.rem},align:"right",verticalAlign:"bottom",get offsetX(){return t.rem},get offsetY(){return t.rem},get width(){return t.canvasSize},get height(){return t.rem},get fill(){return x.colors.text}})}H(X,Tt)},$$slots:{default:!0}})},$$slots:{default:!0}});var z=G(W,2);{let U=lt(()=>-a.radius),N=lt(()=>`height: ${v(r)}px`);Ia(z,{class:"slider vertical-slider",get min(){return v(U)},get max(){return a.radius},reversed:!0,float:!0,vertical:!0,get style(){return v(N)},get step(){return v(o)},get pips(){return x.keyPresses.shift},pipstep:2,get value(){return a.pos[1]},set value(X){a.pos[1]=X}})}var q=G(R,2);{let U=lt(()=>-a.radius),N=lt(()=>`width: ${v(r)}px`);Ia(q,{class:"slider horizontal-slider",get min(){return v(U)},get max(){return a.radius},float:!0,get style(){return v(N)},get step(){return v(o)},get pips(){return x.keyPresses.shift},pipstep:2,get value(){return a.pos[0]},set value(X){a.pos[0]=X}})}var ft=G(T,2),wt=F(ft);wt.__click=()=>a.rot-=15;var gt=F(wt);Ju(gt,{});var vt=G(wt,2);vt.__click=()=>a.rot+=15;var _t=F(vt);Qu(_t,{});var at=G(vt,2);at.__click=()=>{a.drops=[],x.dropHistory.add(a.drops),x.historyUpdateCallback&&x.historyUpdateCallback()};var Mt=F(at);td(Mt,{});var Vt=G(at,2);Vt.__click=()=>{a.pos=[0,0],a.rot=0};var Jt=F(Vt);nd(Jt,{});var Zt=G(ft,2),ce=F(Zt),oi=F(ce);yt(()=>ae(oi,`Result: ${x.checkStatus===de.NotChecked?"â":x.checkStatus===de.Passed?"âï¸":"â"}`)),pt("mouseenter",wt,()=>O(E,!0)),pt("mouseleave",wt,()=>O(E,!1)),pt("mouseenter",vt,()=>O(E,!0)),pt("mouseleave",vt,()=>O(E,!1)),H(n,Y),ie()}Xi(["click"]);var od=Ne('<svg><path fill="currentColor" d="M1.5 6.625a.875.875 0 1 1 0 1.75a.875.875 0 0 1 0-1.75m4 0a.875.875 0 1 1 0 1.75a.875.875 0 0 1 0-1.75m4 0a.875.875 0 1 1 0 1.75a.875.875 0 0 1 0-1.75m4 0a.875.875 0 1 1 0 1.75a.875.875 0 0 1 0-1.75"></path></svg>');function ld(n,t){const e=Wt(t,["$$slots","$$events","$$legacy"]);var i=od();Ee(i,()=>({viewBox:"0 0 15 15",width:"1.2em",height:"1.2em",...e})),H(n,i)}var cd=Ne('<svg><path fill="currentColor" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10s10-4.48 10-10S17.52 2 12 2m4 11h-3v3c0 .55-.45 1-1 1s-1-.45-1-1v-3H8c-.55 0-1-.45-1-1s.45-1 1-1h3V8c0-.55.45-1 1-1s1 .45 1 1v3h3c.55 0 1 .45 1 1s-.45 1-1 1"></path></svg>');function hd(n,t){const e=Wt(t,["$$slots","$$events","$$legacy"]);var i=cd();Ee(i,()=>({viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...e})),H(n,i)}var fd=Ne('<svg><path fill="currentColor" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10s10-4.48 10-10S17.52 2 12 2m4 11H8c-.55 0-1-.45-1-1s.45-1 1-1h8c.55 0 1 .45 1 1s-.45 1-1 1"></path></svg>');function ud(n,t){const e=Wt(t,["$$slots","$$events","$$legacy"]);var i=fd();Ee(i,()=>({viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...e})),H(n,i)}var dd=Ne('<svg><path fill="currentColor" d="M12.5 8c-2.65 0-5.05.99-6.9 2.6L3.71 8.71C3.08 8.08 2 8.52 2 9.41V15c0 .55.45 1 1 1h5.59c.89 0 1.34-1.08.71-1.71l-1.91-1.91c1.39-1.16 3.16-1.88 5.12-1.88c3.16 0 5.89 1.84 7.19 4.5c.27.56.91.84 1.5.64c.71-.23 1.07-1.04.75-1.72C20.23 10.42 16.65 8 12.5 8"></path></svg>');function gd(n,t){const e=Wt(t,["$$slots","$$events","$$legacy"]);var i=dd();Ee(i,()=>({viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...e})),H(n,i)}var pd=Ne('<svg><path fill="currentColor" d="M18.4 10.6C16.55 8.99 14.15 8 11.5 8c-4.16 0-7.74 2.42-9.44 5.93c-.32.67.04 1.47.75 1.71c.59.2 1.23-.08 1.5-.64c1.3-2.66 4.03-4.5 7.19-4.5c1.95 0 3.73.72 5.12 1.88l-1.91 1.91c-.63.63-.19 1.71.7 1.71H21c.55 0 1-.45 1-1V9.41c0-.89-1.08-1.34-1.71-.71z"></path></svg>');function vd(n,t){const e=Wt(t,["$$slots","$$events","$$legacy"]);var i=pd();Ee(i,()=>({viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...e})),H(n,i)}var _d=J('<span><input type="number" name="NumLinePts" id="NumLinePtsInput" min="2" step="1"/> Pts</span>'),md=J('<div class="toolbar"><button title="Add Drop"><!></button> <button title="Add Line of Drops"><!></button> <!> <button title="Remove Drop"><!></button> <button title="Undo"><!></button> <button title="Redo"><!></button></div>');function yd(n,t){ne(t,!0);const e=x.dropHistory;function i(){x.wafer.drops=e.undo(),x.historyUpdateCallback&&x.historyUpdateCallback()}function r(){x.wafer.drops=e.redo(),x.historyUpdateCallback&&x.historyUpdateCallback()}document.addEventListener("keydown",L=>{L.shiftKey&&(x.keyPresses.shift=!0),(L.key==="Tab"||L.key==="Enter")&&(x.settings.numLinePts||(x.settings.numLinePts=10),x.settings.numLinePts=Math.round(x.settings.numLinePts),x.settings.numLinePts=Math.max(x.settings.numLinePts,2)),L.key.toLowerCase()==="z"&&(L.ctrlKey||L.metaKey)&&(L.preventDefault(),L.shiftKey?r():i())}),document.addEventListener("keyup",L=>{L.shiftKey||(x.keyPresses.shift=!1)});var s=md(),a=F(s);a.__click=()=>x.interactionMode=0;var o=F(a);hd(o,{});var l=G(a,2);l.__click=()=>x.interactionMode=1;var c=F(l);ld(c,{style:"transform: rotate(90deg)"});var f=G(l,2);{var u=L=>{var I=_d(),E=F(I);E.defaultValue=10,Ve(E,()=>x.settings.numLinePts,A=>x.settings.numLinePts=A),H(L,I)};st(f,L=>{x.interactionMode===ve.PlaceLine&&L(u)})}var h=G(f,2);h.__click=()=>x.interactionMode=2;var p=F(h);ud(p,{});var d=G(h,2);d.__click=i;var w=F(d);gd(w,{});var g=G(d,2);g.__click=r;var y=F(g);vd(y,{}),yt(()=>{Se(a,1,hr(x.interactionMode===ve.PlaceDrop?"selected":"")),Se(l,1,hr(x.interactionMode===ve.PlaceLine?"selected":"")),Se(h,1,hr(x.interactionMode===ve.DeleteDrop?"selected":"")),d.disabled=e.index<=0,g.disabled=e.index>=e.queue.length-1}),H(n,s),ie()}Xi(["click"]);var bd=Ne('<svg><path fill="currentColor" d="M19.5 12c0-.23-.01-.45-.03-.68l1.86-1.41c.4-.3.51-.86.26-1.3l-1.87-3.23a.987.987 0 0 0-1.25-.42l-2.15.91c-.37-.26-.76-.49-1.17-.68l-.29-2.31c-.06-.5-.49-.88-.99-.88h-3.73c-.51 0-.94.38-1 .88l-.29 2.31c-.41.19-.8.42-1.17.68l-2.15-.91c-.46-.2-1-.02-1.25.42L2.41 8.62c-.25.44-.14.99.26 1.3l1.86 1.41a7.3 7.3 0 0 0 0 1.35l-1.86 1.41c-.4.3-.51.86-.26 1.3l1.87 3.23c.25.44.79.62 1.25.42l2.15-.91c.37.26.76.49 1.17.68l.29 2.31c.06.5.49.88.99.88h3.73c.5 0 .93-.38.99-.88l.29-2.31c.41-.19.8-.42 1.17-.68l2.15.91c.46.2 1 .02 1.25-.42l1.87-3.23c.25-.44.14-.99-.26-1.3l-1.86-1.41c.03-.23.04-.45.04-.68m-7.46 3.5c-1.93 0-3.5-1.57-3.5-3.5s1.57-3.5 3.5-3.5s3.5 1.57 3.5 3.5s-1.57 3.5-3.5 3.5"></path></svg>');function wd(n,t){const e=Wt(t,["$$slots","$$events","$$legacy"]);var i=bd();Ee(i,()=>({viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...e})),H(n,i)}var Cd=J('<dialog class="settings"><h2>Settings</h2> <hr/> <ul><li><span class="label">Wafer Diameter</span> <span class="input-range"><input type="number" name="WaferDiameter" id="WaferDiameter"/> <p class="units">mm</p></span></li> <li><span class="label">Wafer Unused Edge Size</span> <span class="input-range"><input type="number" name="WaferUnusedEdgeSize" id="WaferUnusedEdgeSize"/> <p class="units">mm</p></span></li> <li><span class="label">Stage X Range</span> <span class="input-range"><input type="number" name="StageXRangeMin" id="StageXRangeMin"/> - <input type="number" name="StageXRangeMax" id="StageXRangeMax"/> <p class="units">mm</p></span></li> <li><span class="label">Stage Y Range</span> <span class="input-range"><input type="number" name="StageYRangeMin" id="StageYRangeMin"/> - <input type="number" name="StageYRangeMax" id="StageYRangeMax"/> <p class="units">mm</p></span></li> <li><span class="label">Camera Centre Tolerance</span> <span class="input-range"><input type="number" name="CameraCentreTolerance" id="CameraCentreTolerance"/> <p class="units">mm</p></span></li> <li><span class="label">Camera View Width</span> <span class="input-range"><input type="number" name="CameraViewWidth" id="CameraViewWidth"/> <p class="units">mm</p></span></li></ul> <hr/> <button>Close</button></dialog>');function Sd(n,t){ne(t,!0);let e=b(t,"showModal",15),i=Ot(void 0);M(()=>{e()&&v(i)?.showModal()}),M(()=>{localStorage?.setItem("userSettings",JSON.stringify(x.settings))});var r=Cd();r.__click=q=>{q.target===v(i)&&v(i).close()};var s=G(F(r),4),a=F(s),o=G(F(a),2),l=F(o);ct(l,"min",2);var c=G(a,2),f=G(F(c),2),u=F(f);ct(u,"min",0),ct(u,"max",100);var h=G(c,2),p=G(F(h),2),d=F(p);ct(d,"max",0);var w=G(d,2);ct(w,"min",0);var g=G(h,2),y=G(F(g),2),L=F(y);ct(L,"max",0);var I=G(L,2);ct(I,"min",0);var E=G(g,2),A=G(F(E),2),Y=F(A);ct(Y,"min",0);var T=G(E,2),R=G(F(T),2),W=F(R);ct(W,"min",0);var z=G(s,4);co(z,!0),z.__click=()=>v(i)?.close(),Cs(r,q=>O(i,q),()=>v(i)),pt("close",r,()=>e(!1)),Ve(l,()=>x.settings.waferDiameter,q=>x.settings.waferDiameter=q),Ve(u,()=>x.settings.WaferUnusedEdgeThickness,q=>x.settings.WaferUnusedEdgeThickness=q),Ve(d,()=>x.settings.stage.xRange.min,q=>x.settings.stage.xRange.min=q),Ve(w,()=>x.settings.stage.xRange.max,q=>x.settings.stage.xRange.max=q),Ve(L,()=>x.settings.stage.yRange.min,q=>x.settings.stage.yRange.min=q),Ve(I,()=>x.settings.stage.yRange.max,q=>x.settings.stage.yRange.max=q),Ve(Y,()=>x.settings.centreTolerance,q=>x.settings.centreTolerance=q),Ve(W,()=>x.settings.cameraViewWidth,q=>x.settings.cameraViewWidth=q),H(n,r),ie()}Xi(["click"]);var xd=J('<main><h1>Feasibility Checker</h1> <!> <!> <button title="Copy Coords to Clipboard" class="copy-coords">Copy Coords</button> <button class="settings-button"><!></button> <!></main>');function kd(n,t){ne(t,!0);const e=lt(ul);function i(){let h=x.wafer.drops.map(w=>[w.pos[0],w.pos[1]]);h=h.map(w=>Pi(w,x.wafer.rot));let d=h.map(w=>`${w[0].toFixed(3)};${w[1].toFixed(3)};0.000`).join(`
`);navigator.clipboard.writeText(d)}let r=Ot(!1);var s=xd(),a=G(F(s),2);yd(a,{});var o=G(a,2);ad(o,{get canvasSize(){return v(e)},get rem(){return Ls}});var l=G(o,2);l.__click=i;var c=G(l,2);c.__click=()=>O(r,!0);var f=F(c);wd(f,{});var u=G(c,2);Sd(u,{get showModal(){return v(r)},set showModal(h){O(r,h,!0)}}),H(n,s),ie()}Xi(["click"]);Jc(kd,{target:document.getElementById("app")});
